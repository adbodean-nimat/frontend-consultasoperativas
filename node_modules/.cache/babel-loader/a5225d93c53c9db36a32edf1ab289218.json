{"ast":null,"code":"import '@progress/kendo-ui';\nimport '@progress/kendo-ui/js/messages/kendo.messages.es-AR';\nimport '@progress/kendo-ui/js/cultures/kendo.culture.es-AR';\nimport '@progress/kendo-theme-bootstrap/dist/all.css';\nimport { DataSource } from '@progress/kendo-datasource-vue-wrapper';\nimport { Grid, GridColumn } from '@progress/kendo-grid-vue-wrapper';\nimport CustomCell from './CustomCell.vue';\nimport DragClue from './DragClue.vue';\nimport { reorderData, getTargetTopOffSet } from './common';\nexport default {\n  name: 'ControlAltaClientes',\n  components: {\n    \"grid\": Grid,\n    \"grid-column\": GridColumn,\n    \"datasource\": DataSource,\n    'custom': CustomCell,\n    'dragclue': DragClue\n  },\n  data: function () {\n    return {\n      top: 0,\n      left: 0,\n      targetTopOffset: null,\n      targetLeftOffset: null,\n      showDropHints: false,\n      showDragClueContent: null,\n      dropPosition: '',\n      items: [],\n      activeItem: {},\n      title: 'Control Alta Clientes',\n      schemaModelFields: {\n        CLIE_FECHA_ALTA: {\n          type: 'date'\n        },\n        AUDI_USUARIO: {\n          type: 'string'\n        },\n        USUA_NOMBRE: {\n          type: 'string'\n        },\n        CLIE_CLIENTE: {\n          type: 'number'\n        },\n        CLIE_NOMBRE: {\n          type: 'string'\n        },\n        CLIE_EMAIL: {\n          type: 'string'\n        },\n        CLC5_NOMBRE: {\n          type: 'string'\n        },\n        DCLI_DOMICILIO: {\n          type: 'string'\n        },\n        DCLI_LOCALIDAD: {\n          type: 'string'\n        },\n        DCLI_COD_LOCALIDAD: {\n          type: 'number'\n        },\n        DCLI_COD_POSTAL: {\n          type: 'number'\n        },\n        DCLI_PROVINCIA: {\n          type: 'string'\n        },\n        CLIE_CONDICION_IVA: {\n          type: 'string'\n        },\n        CLIE_CUIT: {\n          type: 'string'\n        },\n        CLIE_COBRADOR: {\n          type: 'string'\n        },\n        CLPF_FECHA_NACIM: {\n          type: 'date'\n        },\n        CLPF_NACIONALIDAD: {\n          type: 'string'\n        },\n        CLPF_SEXO: {\n          type: 'string'\n        }\n      }\n    };\n  },\n  computed: {\n    isDragging() {\n      return {\n        'dragging': this.activeItem.CLIE_FECHA_ALTA\n      };\n    }\n\n  },\n  methods: {\n    toolbarTemplate: function () {\n      var templateHtml = '<span id=\"form\" style=\"position:absolute; left:5px\">' + `<label for=\"fechadesde\">Fecha desde:</label>` + '<input id=\"fechadesde\" style=\"width: auto\"/>' + `<label for=\"fechahasta\" style=\"margin-left: 0.5rem; text-align: center\">hasta</label>` + '<input id=\"fechahasta\" style=\"width: auto\"/>' + '<span style=\"margin-left: 15px\">' + '<a class=\"k-pager-refresh k-link k-button play\" title=\"Ralizar consulta\" style=\"margin-right:5px\"><span class=\"k-icon k-i-play\"></span></a>' + '<a class=\"k-pager-refresh k-link k-button filter-clear\" title=\"Limpiar filtro\" style=\"margin-right:5px\"><span class=\"k-icon k-i-filter-clear\"></span></a>' + '<a class=\"k-pager-refresh k-link k-button\" title=\"Nueva consulta\" onClick=\"window.location.reload();\"><span class=\"k-icon k-i-file\"></span></a>' + '<a class=\"k-pager-refresh k-link k-button refresh\" title=\"Actualizar\" style=\"margin-left:5px\"><span class=\"k-icon k-i-reload\"></span></a>' + '</span>' + '</span>';\n      return templateHtml;\n    },\n    cellRenderTemplate: function () {\n      var rowTemplate = '<custom  :data-item=\"props.dataItem\" :field=\"props.field\" :dropPosition=\"dropPosition\"' + '@dragHandler=\"dragHandler\"' + '@pressHandler=\"pressHandler\"' + '@releaseHandler=\"releaseHandler\"/>';\n      return rowTemplate;\n    },\n\n    dragHandler(dataItem, event) {\n      this.top = event.pageY + 10;\n      this.left = event.pageX;\n      this.targetLeftOffset = this.getGridReference().offsetLeft + this.getGridReference().offsetLeft / 2;\n      this.targetTopOffset = getTargetTopOffSet(event);\n      this.dropPosition = this.getDropPosition(event);\n      this.showDropHints = true;\n    },\n\n    getDropPosition: function (event) {\n      return this.dropPosition = event.offsetY >= event.originalEvent.target.parentElement.clientHeight / 2 ? \"below\" : \"above\";\n    },\n\n    pressHandler(dataItem) {\n      this.activeItem = dataItem;\n    },\n\n    releaseHandler(dataItem, event) {\n      this.showDropHints = false;\n      const reorderedData = reorderData(event, this.items, this.activeItem, this.dropPosition);\n      this.items = reorderedData;\n      this.activeItem = {};\n    },\n\n    gridMouseover(e) {\n      this.showDragClueContent = true;\n    },\n\n    gridMouseout(e) {\n      this.showDragClueContent = false;\n    },\n\n    getGridReference() {\n      return document.querySelector(\".k-widget.k-grid\");\n    }\n\n  },\n\n  mounted() {\n    this.items = this.createRandomData(10);\n    const gridBody = document.getElementsByClassName(\"k-grid-content\")[0];\n    gridBody.addEventListener(\"mouseover\", this.gridMouseover, false);\n    gridBody.addEventListener(\"mouseout\", this.gridMouseout, false);\n  },\n\n  unmounted() {\n    const gridBody = document.getElementsByClassName(\"k-grid-content\")[0];\n    gridBody.removeEventListener(\"mouseover\", this.gridMouseover, false);\n    gridBody.removeEventListener(\"mouseout\", this.gridMouseout, false);\n  },\n\n  mounted: function () {\n    var grid = this.$refs.grid.kendoWidget();\n    var gridElement = grid.element;\n    var fechadesde = gridElement.find('#fechadesde');\n    var fechahasta = gridElement.find('#fechahasta');\n    var toolbarElement = gridElement.find('.k-grid-toolbar');\n    fechadesde.kendoDatePicker({\n      culture: \"es-AR\",\n      format: \"dd-MM-yyyy\",\n      dataValueField: \"CLIE_FECHA_ALTA\",\n\n      /* optionLabel: \"All\", */\n      autoBind: false,\n      dataSource: ['remoteDataSource']\n      /* change: function(e) {\r\n          var fdesde = e.sender.value(),\r\n          fhasta = fechahasta.data(\"kendoDatePicker\").value();\r\n          \r\n          if (fdesde & fhasta) {\r\n              var filter = { logic: \"and\", filters: [] };\r\n              filter.filters.push({ field: \"CLIE_FECHA_ALTA\", operator: \"gte\", value: new Date(fdesde) });\r\n              filter.filters.push({ field: \"CLIE_FECHA_ALTA\", operator: \"lte\", value: new Date(fhasta.getTime()+1000*60*60*24) });\r\n              grid.dataSource.filter(filter);\r\n          }\r\n      } */\n\n    });\n    fechahasta.kendoDatePicker({\n      culture: \"es-AR\",\n      format: \"dd-MM-yyyy\",\n      dataValueField: \"CLIE_FECHA_ALTA\",\n      autoBind: false,\n      dataSource: ['remoteDataSource']\n      /* change:function(e) {\r\n          var fdesde = fechadesde.data(\"kendoDatePicker\").value(),\r\n          fhasta = e.sender.value();\r\n            if (fdesde & fhasta) {\r\n              var filter = { logic: \"and\", filters: [] };\r\n              filter.filters.push({ field: \"CLIE_FECHA_ALTA\", operator: \"gte\", value: new Date(fdesde) });\r\n              filter.filters.push({ field: \"CLIE_FECHA_ALTA\", operator: \"lte\", value: new Date(fhasta.getTime()+1000*60*60*24) });\r\n              grid.dataSource.filter(filter);\r\n              grid.dataSource.sort({field: \"CLIE_FECHA_ALTA\", dir: \"asc\"})\r\n          }\r\n      } */\n\n    });\n    toolbarElement.on(\"click\", \".refresh\", function (e) {\n      e.preventDefault();\n      grid.dataSource.read();\n    });\n    toolbarElement.on(\"click\", \".play\", function () {\n      var fdesde = fechadesde.data(\"kendoDatePicker\").value();\n      var fhasta = fechahasta.data(\"kendoDatePicker\").value();\n\n      if (fdesde && fhasta == null) {\n        grid.dataSource.filter({\n          field: \"CLIE_FECHA_ALTA\",\n          operator: \"gte\",\n          value: new Date(fdesde)\n        });\n        /* grid.dataSource.filter({ field: \"CLIE_FECHA_ALTA\", operator: \"lte\", value: fhasta.addDays(1) }) */\n\n        grid.dataSource.sort({\n          field: \"CLIE_FECHA_ALTA\",\n          dir: \"desc\"\n        });\n      }\n\n      if (fdesde & fhasta) {\n        var filter = {\n          logic: \"and\",\n          filters: []\n        };\n        filter.filters.push({\n          field: \"CLIE_FECHA_ALTA\",\n          operator: \"gte\",\n          value: new Date(fdesde)\n        });\n        filter.filters.push({\n          field: \"CLIE_FECHA_ALTA\",\n          operator: \"lte\",\n          value: new Date(fhasta)\n        });\n        grid.dataSource.filter(filter);\n        grid.dataSource.sort({\n          field: \"CLIE_FECHA_ALTA\",\n          dir: \"desc\"\n        });\n      }\n    });\n    toolbarElement.on(\"click\", \".filter-clear\", function (e) {\n      e.preventDefault();\n      fechahasta.data(\"kendoDatePicker\").value(null);\n      fechadesde.data(\"kendoDatePicker\").value(null);\n      grid.dataSource.sort({});\n      grid.dataSource.filter({});\n      grid.dataSource.autoFitColumn();\n      /* grid.dataSource.read({}); */\n\n      /* grid.dataSource.refresh(); */\n\n      /* grid.dataSource.data(\"kendoGrid\").empty(null); */\n\n      /* grid.dataSource.data('kendoGrid').({}); */\n    });\n  }\n};","map":{"version":3,"mappings":"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","names":["DataSource","Grid","GridColumn","CustomCell","DragClue","reorderData","getTargetTopOffSet","name","components","data","top","left","targetTopOffset","targetLeftOffset","showDropHints","showDragClueContent","dropPosition","items","activeItem","title","schemaModelFields","CLIE_FECHA_ALTA","type","AUDI_USUARIO","USUA_NOMBRE","CLIE_CLIENTE","CLIE_NOMBRE","CLIE_EMAIL","CLC5_NOMBRE","DCLI_DOMICILIO","DCLI_LOCALIDAD","DCLI_COD_LOCALIDAD","DCLI_COD_POSTAL","DCLI_PROVINCIA","CLIE_CONDICION_IVA","CLIE_CUIT","CLIE_COBRADOR","CLPF_FECHA_NACIM","CLPF_NACIONALIDAD","CLPF_SEXO","computed","isDragging","methods","toolbarTemplate","templateHtml","cellRenderTemplate","rowTemplate","dragHandler","dataItem","event","pageY","pageX","getGridReference","offsetLeft","getDropPosition","offsetY","originalEvent","target","parentElement","clientHeight","pressHandler","releaseHandler","reorderedData","gridMouseover","e","gridMouseout","document","querySelector","mounted","createRandomData","gridBody","getElementsByClassName","addEventListener","unmounted","removeEventListener","grid","$refs","kendoWidget","gridElement","element","fechadesde","find","fechahasta","toolbarElement","kendoDatePicker","culture","format","dataValueField","autoBind","dataSource","on","preventDefault","read","fdesde","value","fhasta","filter","field","operator","Date","sort","dir","logic","filters","push","autoFitColumn"],"sourceRoot":"","sources":["C:\\Users\\abodean\\restapi-nodejs\\client\\app-router\\src\\views\\ControlAltaClientes.vue"],"sourcesContent":["<template>\r\n  <div class=\"container-fluid page-grid\">\r\n    <div style=\"background-color: #008645; height: 45px; border-top-left-radius: 10px; border-top-right-radius: 10px; display: flex; align-items: center;\">\r\n      <div style=\"margin-left: 5px; color: white;\" class=\"icon-title\">\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" fill=\"#fff\" class=\"bi bi-person-lines-fill\" viewBox=\"0 0 16 16\"><path d=\"M6 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-5 6s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H1zM11 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1h-4a.5.5 0 0 1-.5-.5zm.5 2.5a.5.5 0 0 0 0 1h4a.5.5 0 0 0 0-1h-4zm2 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1h-2zm0 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1h-2z\"/></svg>\r\n      </div>\r\n      <!-- <span style=\"margin-left: 5px; color: white;\" class=\"k-icon k-i-grid-layout\"></span> -->\r\n      <span style=\"color: white; margin-left: 5px;\">{{ title }}</span>\r\n    </div>\r\n    <datasource ref=\"remoteDataSource\"\r\n                      :transport-read-url=\"'http://192.168.0.250:8090/api/control/'\"\r\n                      :transport-read-data-type=\"'json'\"\r\n                      :transport-read-content-type=\"' application/json'\"\r\n                      :transport-read-type=\"'GET'\"\r\n                      :transport-read-cache=\"false\"\r\n                      :schema-model-fields=\"schemaModelFields\"\r\n                      :page-size='50'\r\n                      >\r\n    </datasource>\r\n    <grid ref=\"grid\"\r\n          :height=\"750\"\r\n          :data-source-ref=\"'remoteDataSource'\"\r\n          :sortable-mode=\"'multiple'\"\r\n          :sortable-allow-unsort=\"true\"\r\n          :sortable-show-indexes=\"true\"\r\n          :pageable='true'\r\n          :filterable=\"true\"\r\n          :filterable-extra=\"false\"\r\n          :reorderable=\"true\"\r\n          :resizable=\"true\"\r\n          :groupable=\"true\"\r\n          :column-menu=\"true\"\r\n          :auto-bind=\"false\"\r\n          :row-height=\"30\"\r\n          :toolbar=\"toolbarTemplate\"\r\n          :allow-copy=\"true\"\r\n          :navigatable=\"true\"\r\n          :selectable=\"false\"\r\n          :class=\"isDragging\"\r\n          :cell-render=\"'cellRenderTemplate'\"\r\n          >\r\n          <grid-column field=\"reorder\" title=\"Reorder\" :width=\"80\" template=\"cellRenderTemplate\" :filterable=\"false\"></grid-column>\r\n          <grid-column field=\"CLIE_FECHA_ALTA\" title=\"Fecha Alta\" type=\"date\" format=\"{0:dd-MM-yyyy}\" :width=\"150\"></grid-column>\r\n          <grid-column field=\"AUDI_USUARIO\" title=\"Auditoría\" :filterable-search=\"true\" :filterable-multi=\"true\" :width=\"130\"></grid-column>\r\n          <grid-column field=\"USUA_NOMBRE\" title=\"Nombre Usuario\" :width=\"200\"></grid-column>\r\n          <grid-column field=\"VEND_NOMBRE\" title=\"Vendedor\" :width=\"135\"></grid-column>\r\n          <grid-column field=\"CLIE_CLIENTE\" title=\"Nro. Cliente\" :width=\"135\"></grid-column>\r\n          <grid-column field=\"CLIE_NOMBRE\" title=\"Nombre Cliente\" :width=\"200\"></grid-column>\r\n          <grid-column field=\"CLIE_EMAIL\" title=\"E-mail\" :width=\"250\"></grid-column>\r\n          <grid-column field=\"CLC5_NOMBRE\" title=\"Clasificación 5\" :width=\"135\"></grid-column>\r\n          <grid-column field=\"DCLI_DOMICILIO\" title=\"Domicilio\" :width=\"135\"></grid-column>\r\n          <grid-column field=\"DCLI_LOCALIDAD\" title=\"Localidad\" :width=\"135\"></grid-column>\r\n          <grid-column field=\"DCLI_COD_LOCALIDAD\" title=\"Código Localidad\" :width=\"135\"></grid-column>\r\n          <grid-column field=\"DCLI_COD_POSTAL\" title=\"Código Postal\" :width=\"135\"></grid-column>\r\n          <grid-column field=\"DCLI_PROVINCIA\" title=\"Provincia\" :width=\"135\"></grid-column>\r\n          <grid-column field=\"CLIE_CONDICION_IVA\" title=\"Condicion IVA\" :width=\"135\"></grid-column>\r\n          <grid-column field=\"CLIE_CUIT\" title=\"CUIT\" :width=\"135\"></grid-column>\r\n          <grid-column field=\"CLIE_COBRADOR\" title=\"Cobrador\" :width=\"135\"></grid-column>\r\n          <grid-column field=\"CLPF_FECHA_NACIM\" title=\"Fecha nacimiento\" type=\"date\" format=\"{0:dd-MM-yyyy}\" :width=\"135\"></grid-column>\r\n          <grid-column field=\"CLPF_NACIONALIDAD\" title=\"Nacionalidad\" :width=\"135\"></grid-column>\r\n          <grid-column field=\"CLPF_SEXO\" title=\"Sexo\" :width=\"135\"></grid-column>\r\n    </grid>\r\n    <dragclue v-if=\"showDropHints\" \r\n        :top=\"top\" :left=\"left\" :data-item=\"activeItem\" :showContent=\"showDragClueContent\" />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport '@progress/kendo-ui'\r\nimport '@progress/kendo-ui/js/messages/kendo.messages.es-AR'\r\nimport '@progress/kendo-ui/js/cultures/kendo.culture.es-AR'\r\nimport '@progress/kendo-theme-bootstrap/dist/all.css'\r\nimport { DataSource } from '@progress/kendo-datasource-vue-wrapper'\r\nimport { Grid, GridColumn } from '@progress/kendo-grid-vue-wrapper'\r\nimport CustomCell from './CustomCell.vue';\r\nimport DragClue from './DragClue.vue';\r\nimport { reorderData, getTargetTopOffSet  } from './common'\r\n\r\nexport default {\r\n  name: 'ControlAltaClientes',\r\n  components: {\r\n    \"grid\": Grid,\r\n    \"grid-column\": GridColumn,\r\n    \"datasource\": DataSource,\r\n    'custom': CustomCell,\r\n    'dragclue': DragClue\r\n},\r\n  data: function () {\r\n         return {\r\n            top: 0,\r\n            left: 0,\r\n            targetTopOffset: null,\r\n            targetLeftOffset: null,\r\n            showDropHints: false,\r\n            showDragClueContent: null,\r\n            dropPosition: '',\r\n            items: [],\r\n            activeItem: {},\r\n            title: 'Control Alta Clientes',\r\n            schemaModelFields: {\r\n                CLIE_FECHA_ALTA: {type: 'date'},\r\n                AUDI_USUARIO: {type: 'string'},\r\n                USUA_NOMBRE: {type: 'string'},\r\n                CLIE_CLIENTE: {type: 'number'},\r\n                CLIE_NOMBRE: {type: 'string'},\r\n                CLIE_EMAIL: {type: 'string'},\r\n                CLC5_NOMBRE: {type: 'string'},\r\n                DCLI_DOMICILIO: {type: 'string'},\r\n                DCLI_LOCALIDAD: {type: 'string'},\r\n                DCLI_COD_LOCALIDAD: {type: 'number'},\r\n                DCLI_COD_POSTAL: {type: 'number'},\r\n                DCLI_PROVINCIA: {type: 'string'},\r\n                CLIE_CONDICION_IVA: {type: 'string'},\r\n                CLIE_CUIT: {type: 'string'},\r\n                CLIE_COBRADOR: {type: 'string'},\r\n                CLPF_FECHA_NACIM: {type: 'date'},\r\n                CLPF_NACIONALIDAD: {type: 'string'},\r\n                CLPF_SEXO: {type: 'string'}\r\n            }\r\n         }\r\n  },\r\n  computed: {\r\n        isDragging() {\r\n            return {\r\n                'dragging': this.activeItem.CLIE_FECHA_ALTA\r\n            };\r\n        }\r\n    },\r\n  methods: {\r\n            toolbarTemplate: function() {\r\n            var templateHtml =\r\n                '<span id=\"form\" style=\"position:absolute; left:5px\">' +\r\n                    `<label for=\"fechadesde\">Fecha desde:</label>` +\r\n                    '<input id=\"fechadesde\" style=\"width: auto\"/>' +\r\n                    `<label for=\"fechahasta\" style=\"margin-left: 0.5rem; text-align: center\">hasta</label>` +\r\n                    '<input id=\"fechahasta\" style=\"width: auto\"/>' +\r\n                    '<span style=\"margin-left: 15px\">'+\r\n                    '<a class=\"k-pager-refresh k-link k-button play\" title=\"Ralizar consulta\" style=\"margin-right:5px\"><span class=\"k-icon k-i-play\"></span></a>' +\r\n                    '<a class=\"k-pager-refresh k-link k-button filter-clear\" title=\"Limpiar filtro\" style=\"margin-right:5px\"><span class=\"k-icon k-i-filter-clear\"></span></a>'+\r\n                    '<a class=\"k-pager-refresh k-link k-button\" title=\"Nueva consulta\" onClick=\"window.location.reload();\"><span class=\"k-icon k-i-file\"></span></a>' +\r\n                    '<a class=\"k-pager-refresh k-link k-button refresh\" title=\"Actualizar\" style=\"margin-left:5px\"><span class=\"k-icon k-i-reload\"></span></a>' +\r\n                    '</span>' +\r\n                '</span>';\r\n            return templateHtml;\r\n            },\r\n            cellRenderTemplate: function(){\r\n            var rowTemplate =\r\n                '<custom  :data-item=\"props.dataItem\" :field=\"props.field\" :dropPosition=\"dropPosition\"'+\r\n                        '@dragHandler=\"dragHandler\"'+\r\n                        '@pressHandler=\"pressHandler\"'+\r\n                        '@releaseHandler=\"releaseHandler\"/>';\r\n              return rowTemplate;\r\n            },\r\n            dragHandler(dataItem,  event) {\r\n            this.top = event.pageY + 10;\r\n            this.left = event.pageX;\r\n            this.targetLeftOffset = this.getGridReference().offsetLeft + this.getGridReference().offsetLeft/2;\r\n            this.targetTopOffset = getTargetTopOffSet(event);\r\n            this.dropPosition = this.getDropPosition(event)\r\n            this.showDropHints = true;\r\n        },\r\n        getDropPosition: function(event){\r\n            return this.dropPosition = event.offsetY >= event.originalEvent.target.parentElement.clientHeight/2? \"below\":\"above\";\r\n        },\r\n        pressHandler(dataItem) {\r\n          this.activeItem = dataItem;\r\n        },\r\n        releaseHandler(dataItem, event) {\r\n            this.showDropHints = false;\r\n            const reorderedData = reorderData(event, this.items, this.activeItem, this.dropPosition);\r\n            this.items = reorderedData;\r\n            this.activeItem = {};\r\n        },\r\n        gridMouseover(e) {\r\n             this.showDragClueContent = true;\r\n        },\r\n        gridMouseout(e){\r\n            this.showDragClueContent = false;\r\n        },\r\n        getGridReference(){\r\n            return document.querySelector(\".k-widget.k-grid\");\r\n        }\r\n    },\r\n    mounted() {\r\n        this.items = this.createRandomData(10);\r\n\r\n        const gridBody = document.getElementsByClassName(\"k-grid-content\")[0];\r\n        gridBody.addEventListener(\"mouseover\", this.gridMouseover, false)\r\n        gridBody.addEventListener(\"mouseout\", this.gridMouseout, false)\r\n    },\r\n    unmounted() {\r\n        const gridBody = document.getElementsByClassName(\"k-grid-content\")[0];\r\n        gridBody.removeEventListener(\"mouseover\", this.gridMouseover, false)\r\n        gridBody.removeEventListener(\"mouseout\", this.gridMouseout, false)\r\n    },\r\n    mounted: function(){\r\n            var grid = this.$refs.grid.kendoWidget();\r\n            var gridElement = grid.element;\r\n            var fechadesde = gridElement.find('#fechadesde');\r\n            var fechahasta = gridElement.find('#fechahasta');\r\n            var toolbarElement = gridElement.find('.k-grid-toolbar');\r\n\r\n            fechadesde.kendoDatePicker({\r\n                culture: \"es-AR\",\r\n                format: \"dd-MM-yyyy\",\r\n                dataValueField: \"CLIE_FECHA_ALTA\",\r\n                /* optionLabel: \"All\", */\r\n                autoBind: false,\r\n                dataSource: ['remoteDataSource']\r\n                /* change: function(e) {\r\n                    var fdesde = e.sender.value(),\r\n                    fhasta = fechahasta.data(\"kendoDatePicker\").value();\r\n                    \r\n                    if (fdesde & fhasta) {\r\n                        var filter = { logic: \"and\", filters: [] };\r\n                        filter.filters.push({ field: \"CLIE_FECHA_ALTA\", operator: \"gte\", value: new Date(fdesde) });\r\n                        filter.filters.push({ field: \"CLIE_FECHA_ALTA\", operator: \"lte\", value: new Date(fhasta.getTime()+1000*60*60*24) });\r\n                        grid.dataSource.filter(filter);\r\n                    }\r\n                } */\r\n            });\r\n            fechahasta.kendoDatePicker({\r\n                culture: \"es-AR\", \r\n                format: \"dd-MM-yyyy\",\r\n                dataValueField: \"CLIE_FECHA_ALTA\",\r\n                autoBind: false,\r\n                dataSource: ['remoteDataSource']\r\n                /* change:function(e) {\r\n                    var fdesde = fechadesde.data(\"kendoDatePicker\").value(),\r\n                    fhasta = e.sender.value();\r\n\r\n                    if (fdesde & fhasta) {\r\n                        var filter = { logic: \"and\", filters: [] };\r\n                        filter.filters.push({ field: \"CLIE_FECHA_ALTA\", operator: \"gte\", value: new Date(fdesde) });\r\n                        filter.filters.push({ field: \"CLIE_FECHA_ALTA\", operator: \"lte\", value: new Date(fhasta.getTime()+1000*60*60*24) });\r\n                        grid.dataSource.filter(filter);\r\n                        grid.dataSource.sort({field: \"CLIE_FECHA_ALTA\", dir: \"asc\"})\r\n                    }\r\n                } */\r\n            });\r\n            toolbarElement.on(\"click\", \".refresh\", function (e) {\r\n              e.preventDefault(); \r\n              grid.dataSource.read();\r\n            });\r\n            toolbarElement.on(\"click\", \".play\", function(){\r\n              var fdesde = fechadesde.data(\"kendoDatePicker\").value();\r\n              var fhasta = fechahasta.data(\"kendoDatePicker\").value();\r\n              if (fdesde && fhasta == null) {\r\n                        grid.dataSource.filter({ field: \"CLIE_FECHA_ALTA\", operator: \"gte\", value: new Date(fdesde) });\r\n                        /* grid.dataSource.filter({ field: \"CLIE_FECHA_ALTA\", operator: \"lte\", value: fhasta.addDays(1) }) */\r\n                        grid.dataSource.sort({field: \"CLIE_FECHA_ALTA\", dir: \"desc\"});\r\n                    }\r\n              if (fdesde & fhasta) {\r\n                        var filter = { logic: \"and\", filters: [] };\r\n                        filter.filters.push({ field: \"CLIE_FECHA_ALTA\", operator: \"gte\", value: new Date(fdesde) });\r\n                        filter.filters.push({ field: \"CLIE_FECHA_ALTA\", operator: \"lte\", value: new Date(fhasta) });\r\n                        grid.dataSource.filter(filter);\r\n                        grid.dataSource.sort({field: \"CLIE_FECHA_ALTA\", dir: \"desc\"});\r\n              }\r\n\r\n            });\r\n            toolbarElement.on(\"click\", \".filter-clear\", function(e){\r\n              e.preventDefault();\r\n              fechahasta.data(\"kendoDatePicker\").value(null);\r\n              fechadesde.data(\"kendoDatePicker\").value(null);\r\n              grid.dataSource.sort({});\r\n              grid.dataSource.filter({});\r\n              grid.dataSource.autoFitColumn();\r\n              \r\n              /* grid.dataSource.read({}); */\r\n              /* grid.dataSource.refresh(); */\r\n              /* grid.dataSource.data(\"kendoGrid\").empty(null); */\r\n              /* grid.dataSource.data('kendoGrid').({}); */\r\n            })\r\n        }\r\n      }\r\n</script>\r\n\r\n<style>\r\n.k-grid {\r\n    font-size: 12px;\r\n}\r\n.k-grid td{\r\n    white-space: nowrap;\r\n    text-overflow: ellipsis;\r\n}\r\n\r\n.k-grid-content{\r\n  overflow-x: scroll;\r\n}\r\n\r\n.page-grid{\r\n  padding: 20px 0px;\r\n  background-color: currentColor;\r\n}\r\n\r\n.icon-title{\r\n  width: auto;\r\n  height: auto;\r\n  margin-left: 5px;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}
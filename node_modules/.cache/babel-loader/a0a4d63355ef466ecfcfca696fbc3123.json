{"ast":null,"code":"require(\"core-js/modules/es.error.cause.js\");\n\n/******/\n(function () {\n  // webpackBootstrap\n\n  /******/\n  var __webpack_modules__ = {\n    /***/\n    53942:\n    /***/\n    function (module, exports, __webpack_require__) {\n      var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__; // -*- fill-column: 100 -*-\n\n\n      (function (f, define) {\n        !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(22360), __webpack_require__(67539)], __WEBPACK_AMD_DEFINE_FACTORY__ = f, __WEBPACK_AMD_DEFINE_RESULT__ = typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? __WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__) : __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n      })(function () {\n        \"use strict\"; // WARNING: removing the following jshint declaration and turning\n        // == into === to make JSHint happy will break functionality.\n\n        var util = kendo.util;\n        var spreadsheet = kendo.spreadsheet;\n        var calc = spreadsheet.calc;\n        var runtime = calc.runtime;\n        var defineFunction = runtime.defineFunction;\n        var defineAlias = runtime.defineAlias;\n        var CalcError = runtime.CalcError;\n        var RangeRef = spreadsheet.RangeRef;\n        var CellRef = spreadsheet.CellRef;\n        var UnionRef = spreadsheet.UnionRef;\n        var Matrix = runtime.Matrix;\n        var Ref = spreadsheet.Ref;\n        var NameRef = spreadsheet.NameRef;\n        var daysInMonth = runtime.daysInMonth;\n        var packDate = runtime.packDate;\n        var unpackDate = runtime.unpackDate;\n        var daysInYear = runtime.daysInYear;\n        var limitPrecision = runtime.limitPrecision;\n        /* -----[ Math functions ]----- */\n\n        [\"abs\", \"cos\", \"sin\", \"acos\", \"asin\", \"tan\", \"atan\", \"exp\", \"sqrt\"].forEach(function (name) {\n          defineFunction(name, Math[name]).args([[\"*n\", \"number\"]]);\n        });\n        defineFunction(\"ln\", Math.log).args([[\"*n\", \"number\"]]);\n        defineFunction(\"log\", function (num, base) {\n          return Math.log(num) / Math.log(base);\n        }).args([[\"*num\", \"number++\"], [\"*base\", [\"or\", \"number++\", [\"null\", 10]]], [\"?\", [\"assert\", \"$base != 1\", \"DIV/0\"]]]);\n        defineFunction(\"log10\", function (num) {\n          return Math.log(num) / Math.log(10);\n        }).args([[\"*num\", \"number++\"]]);\n        defineFunction(\"pi\", function () {\n          return Math.PI;\n        }).args([]);\n        defineFunction(\"sqrtpi\", function (n) {\n          return Math.sqrt(n * Math.PI);\n        }).args([[\"*num\", \"number+\"]]);\n        defineFunction(\"degrees\", function (rad) {\n          return 180 * rad / Math.PI % 360;\n        }).args([[\"*radians\", \"number\"]]);\n        defineFunction(\"radians\", function (deg) {\n          return Math.PI * deg / 180;\n        }).args([[\"*degrees\", \"number\"]]);\n\n        function _cosh(n) {\n          return (Math.exp(n) + Math.exp(-n)) / 2;\n        }\n\n        defineFunction(\"cosh\", _cosh).args([[\"*num\", \"number\"]]);\n        defineFunction(\"acosh\", function (n) {\n          return Math.log(n + Math.sqrt(n - 1) * Math.sqrt(n + 1));\n        }).args([[\"*num\", \"number\"], [\"?\", [\"assert\", \"$num >= 1\"]]]);\n\n        function _sinh(n) {\n          return (Math.exp(n) - Math.exp(-n)) / 2;\n        }\n\n        defineFunction(\"sinh\", _sinh).args([[\"*num\", \"number\"]]);\n        defineFunction(\"asinh\", function (n) {\n          return Math.log(n + Math.sqrt(n * n + 1));\n        }).args([[\"*num\", \"number\"]]);\n        defineFunction(\"sec\", function (n) {\n          return 1 / Math.cos(n);\n        }).args([[\"*num\", \"number\"]]);\n        defineFunction(\"sech\", function (n) {\n          return 1 / _cosh(n);\n        }).args([[\"*num\", \"number\"]]);\n        defineFunction(\"csc\", function (n) {\n          return 1 / Math.sin(n);\n        }).args([[\"*num\", \"number\"]]);\n        defineFunction(\"csch\", function (n) {\n          return 1 / _sinh(n);\n        }).args([[\"*num\", \"number\"]]);\n        defineFunction(\"atan2\", function (x, y) {\n          return Math.atan(y / x);\n        }).args([[\"*x\", \"divisor\"], [\"*y\", \"number\"]]);\n\n        function _tanh(n) {\n          return _sinh(n) / _cosh(n);\n        }\n\n        defineFunction(\"tanh\", _tanh).args([[\"*num\", \"number\"]]);\n        defineFunction(\"atanh\", function (n) {\n          return Math.log(Math.sqrt(1 - n * n) / (1 - n));\n        }).args([[\"*num\", [\"and\", \"number\", [\"(between)\", -1, 1]]]]);\n        defineFunction(\"cot\", function (n) {\n          return 1 / Math.tan(n);\n        }).args([[\"*num\", \"divisor\"]]);\n        defineFunction(\"coth\", function (n) {\n          return 1 / _tanh(n);\n        }).args([[\"*num\", \"divisor\"]]);\n        defineFunction(\"acot\", function (n) {\n          return Math.PI / 2 - Math.atan(n);\n        }).args([[\"*num\", \"number\"]]);\n        defineFunction(\"acoth\", function (n) {\n          return Math.log((n + 1) / (n - 1)) / 2;\n        }).args([[\"*num\", \"number\"], [\"?\", [\"or\", [\"assert\", \"$num < -1\"], [\"assert\", \"$num > 1\"]]]]);\n        defineFunction(\"power\", function (a, b) {\n          return Math.pow(a, b);\n        }).args([[\"*a\", \"number\"], [\"*b\", \"number\"]]);\n        defineFunction(\"mod\", function (a, b) {\n          return a % b;\n        }).args([[\"*a\", \"number\"], [\"*b\", \"divisor\"]]);\n        defineFunction(\"quotient\", function (a, b) {\n          return Math.floor(a / b);\n        }).args([[\"*a\", \"number\"], [\"*b\", \"divisor\"]]);\n        defineFunction(\"ceiling\", function (num, s) {\n          return s ? s * Math.ceil(num / s) : 0;\n        }).args([[\"*number\", \"number\"], [\"*significance\", \"number\"], [\"?\", [\"assert\", \"$significance >= 0 || $number < 0\"]]]);\n        defineFunction(\"ceiling.precise\", function (num, s) {\n          s = Math.abs(s);\n          return s ? s * Math.ceil(num / s) : 0;\n        }).args([[\"*number\", \"number\"], [\"*significance\", [\"or\", \"number\", [\"null\", 1]]]]);\n        defineAlias(\"iso.ceiling\", \"ceiling.precise\"); // XXX: how do we know if this function is correct?\n        //\n        // https://support.office.com/en-gb/article/CEILING-MATH-function-80f95d2f-b499-4eee-9f16-f795a8e306c8\n        //\n        // “There are many combinations of Significance and Mode values that affect rounding of negative\n        // numbers in different ways.” — right, thanks for the info. :-\\\n\n        defineFunction(\"ceiling.math\", function (num, s, mode) {\n          if (!s || !num) {\n            return 0;\n          }\n\n          if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n            s = -s;\n          }\n\n          return s ? s * Math.ceil(num / s) : 0;\n        }).args([[\"*number\", \"number\"], [\"*significance\", [\"or\", \"number\", [\"null\", \"$number < 0 ? -1 : 1\"]]], [\"*mode\", [\"or\", \"logical\", [\"null\", 0]]]]);\n        defineFunction(\"floor\", function (num, s) {\n          return s ? s * Math.floor(num / s) : 0;\n        }).args([[\"*number\", \"number\"], [\"*significance\", \"number\"], [\"?\", [\"assert\", \"$significance >= 0 || $number < 0\"]]]);\n        defineFunction(\"floor.precise\", function (num, s) {\n          s = Math.abs(s);\n          return s ? s * Math.floor(num / s) : 0;\n        }).args([[\"*number\", \"number\"], [\"*significance\", [\"or\", \"number\", [\"null\", 1]]]]); // XXX: check this\n\n        defineFunction(\"floor.math\", function (num, s, mode) {\n          if (!s || !num) {\n            return 0;\n          }\n\n          if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n            s = -s;\n          }\n\n          return s ? s * Math.floor(num / s) : 0;\n        }).args([[\"*number\", \"number\"], [\"*significance\", [\"or\", \"number\", [\"null\", \"$number < 0 ? -1 : 1\"]]], [\"*mode\", [\"or\", \"logical\", [\"null\", 0]]]]);\n        defineFunction(\"int\", Math.floor).args([[\"*number\", \"number\"]]);\n        defineFunction(\"mround\", function (num, mult) {\n          return mult ? mult * Math.round(num / mult) : 0;\n        }).args([[\"*number\", \"number\"], [\"*multiple\", \"number\"]]);\n        defineFunction(\"round\", function (num, digits) {\n          var sign = num < 0 ? -1 : 1;\n\n          if (sign < 0) {\n            num = -num;\n          }\n\n          digits = Math.pow(10, digits);\n          num = limitPrecision(num * digits);\n          num = Math.round(num);\n          return sign * num / digits;\n        }).args([[\"*number\", \"number\"], [\"*digits\", \"number\"]]);\n        defineFunction(\"roundup\", function (num, digits) {\n          digits = Math.pow(10, digits);\n          num = limitPrecision(num * digits);\n          num = num < 0 ? Math.floor(num) : Math.ceil(num);\n          return num / digits;\n        }).args([[\"*number\", \"number\"], [\"*digits\", \"number\"]]);\n        defineFunction(\"rounddown\", function (num, digits) {\n          digits = Math.pow(10, digits);\n          num = limitPrecision(num * digits);\n          num = num < 0 ? Math.ceil(num) : Math.floor(num);\n          return num / digits;\n        }).args([[\"*number\", \"number\"], [\"*digits\", \"number\"]]);\n        defineFunction(\"even\", function (num) {\n          var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n          return n % 2 ? n + (n < 0 ? -1 : 1) : n;\n        }).args([[\"*number\", \"number\"]]);\n        defineFunction(\"odd\", function (num) {\n          var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n          return n % 2 ? n : n + (n < 0 ? -1 : 1);\n        }).args([[\"*number\", \"number\"]]);\n        defineFunction(\"sign\", function (num) {\n          return num < 0 ? -1 : num > 0 ? 1 : 0;\n        }).args([[\"*number\", \"number\"]]);\n\n        function _gcd(a, b) {\n          while (b) {\n            var r = a % b;\n            a = b;\n            b = r;\n          }\n\n          return a;\n        }\n\n        function _lcm(a, b) {\n          return Math.abs(a * b) / _gcd(a, b);\n        }\n\n        defineFunction(\"gcd\", function (args) {\n          var a = args[0];\n\n          for (var i = 1; i < args.length; ++i) {\n            a = _gcd(a, args[i]);\n          }\n\n          return a;\n        }).args([[\"numbers\", [\"collect\", \"number\"]]]);\n        defineFunction(\"lcm\", function (args) {\n          var a = args[0];\n\n          for (var i = 1; i < args.length; ++i) {\n            a = _lcm(a, args[i]);\n          }\n\n          return a;\n        }).args([[\"numbers\", [\"collect\", \"number\"]]]);\n        defineFunction(\"sum\", function (numbers) {\n          return numbers.reduce(function (sum, num) {\n            return sum + num;\n          }, 0);\n        }).args([[\"numbers\", [\"collect\", \"number\"]]]);\n        defineFunction(\"product\", function (numbers) {\n          return numbers.reduce(function (prod, num) {\n            return prod * num;\n          }, 1);\n        }).args([[\"numbers\", [\"collect\", \"number\"]]]);\n        defineFunction(\"sumproduct\", function (first, rest) {\n          var sum = 0;\n          first.each(function (p, row, col) {\n            if (typeof p == \"number\") {\n              for (var i = 0; i < rest.length; ++i) {\n                var v = rest[i].get(row, col);\n\n                if (typeof v != \"number\") {\n                  return;\n                }\n\n                p *= v;\n              }\n\n              sum += p;\n            }\n          });\n          return sum;\n        }).args([[\"a1\", \"matrix\"], [\"+\", [\"a2\", [\"and\", \"matrix\", [\"assert\", \"$a2.width == $a1.width\"], [\"assert\", \"$a2.height == $a1.height\"]]]]]);\n        defineFunction(\"sumsq\", function (numbers) {\n          return numbers.reduce(function (sum, num) {\n            return sum + num * num;\n          }, 0);\n        }).args([[\"numbers\", [\"collect\", \"number\"]]]);\n        defineFunction(\"sumx2my2\", function (a, b) {\n          var sum = 0;\n          a.each(function (x, row, col) {\n            var y = b.get(row, col);\n\n            if (typeof x == \"number\" && typeof y == \"number\") {\n              sum += x * x - y * y;\n            }\n          });\n          return sum;\n        }).args([[\"a\", \"matrix\"], [\"b\", [\"and\", \"matrix\", [\"assert\", \"$b.width == $a.width\"], [\"assert\", \"$b.height == $a.height\"]]]]);\n        defineFunction(\"sumx2py2\", function (a, b) {\n          var sum = 0;\n          a.each(function (x, row, col) {\n            var y = b.get(row, col);\n\n            if (typeof x == \"number\" && typeof y == \"number\") {\n              sum += x * x + y * y;\n            }\n          });\n          return sum;\n        }).args([[\"a\", \"matrix\"], [\"b\", [\"and\", \"matrix\", [\"assert\", \"$b.width == $a.width\"], [\"assert\", \"$b.height == $a.height\"]]]]);\n        defineFunction(\"sumxmy2\", function (a, b) {\n          var sum = 0;\n          a.each(function (x, row, col) {\n            var y = b.get(row, col);\n\n            if (typeof x == \"number\" && typeof y == \"number\") {\n              sum += (x - y) * (x - y);\n            }\n          });\n          return sum;\n        }).args([[\"a\", \"matrix\"], [\"b\", [\"and\", \"matrix\", [\"assert\", \"$b.width == $a.width\"], [\"assert\", \"$b.height == $a.height\"]]]]);\n        defineFunction(\"seriessum\", function (x, n, m, a) {\n          var sum = 0;\n          a.each(function (coef) {\n            if (typeof coef != \"number\") {\n              throw new CalcError(\"VALUE\");\n            }\n\n            sum += coef * Math.pow(x, n);\n            n += m;\n          });\n          return sum;\n        }).args([[\"x\", \"number\"], [\"y\", \"number\"], [\"m\", \"number\"], [\"a\", \"matrix\"]]);\n        defineFunction(\"min\", function (numbers) {\n          return numbers.length ? Math.min.apply(Math, numbers) : 0;\n        }).args([[\"numbers\", [\"collect\", \"number!\"]]]);\n        defineFunction(\"max\", function (numbers) {\n          return numbers.length ? Math.max.apply(Math, numbers) : 0;\n        }).args([[\"numbers\", [\"collect\", \"number!\"]]]);\n        defineFunction(\"counta\", function (values) {\n          return values.length;\n        }).args([[\"values\", [\"#collect\", \"anyvalue\"]]]);\n        defineFunction(\"count\", function (numbers) {\n          return numbers.length;\n        }).args([[\"numbers\", [\"#collect\", \"number\"]]]);\n        defineFunction(\"countunique\", function (values) {\n          var count = 0,\n              seen = [];\n          values.forEach(function (val) {\n            if (seen.indexOf(val) < 0) {\n              count++;\n              seen.push(val);\n            }\n          });\n          return count;\n        }).args([[\"values\", [\"#collect\", \"anyvalue\"]]]);\n        defineFunction(\"countblank\", function (a) {\n          var count = 0;\n\n          function add(val) {\n            if (val == null || val === \"\") {\n              count++;\n            }\n          }\n\n          function loop(args) {\n            for (var i = 0; i < args.length; ++i) {\n              var x = args[i];\n\n              if (x instanceof Matrix) {\n                x.each(add, true);\n              } else {\n                add(x);\n              }\n            }\n          }\n\n          loop(a);\n          return count;\n        }).args([[\"+\", [\"args\", [\"or\", \"matrix\", \"anyvalue\"]]]]);\n        defineFunction(\"iseven\", function (num) {\n          return num % 2 === 0;\n        }).args([[\"*number\", \"number\"]]);\n        defineFunction(\"isodd\", function (num) {\n          return num % 2 !== 0;\n        }).args([[\"*number\", \"number\"]]);\n        defineFunction(\"n\", function (val) {\n          if (typeof val == \"boolean\") {\n            return val ? 1 : 0;\n          }\n\n          if (typeof val == \"number\") {\n            return val;\n          }\n\n          return 0;\n        }).args([[\"*value\", \"anyvalue\"]]);\n        defineFunction(\"na\", function () {\n          return new CalcError(\"N/A\");\n        }).args([]);\n        /* -----[ the \"*IFS\" functions ]----- */\n        // helper function: take `args` like COUNTIFS (see Excel docs) and\n        // calls `f` for each cell matching all criteria.  `f` receives\n        // `chunks` (parsed args containing matrix and predicate) and\n        // row,col of matching cells.\n\n        function forIFS(args, f) {\n          var chunks = [],\n              i = 0,\n              matrix = args[0];\n\n          while (i < args.length) {\n            chunks.push({\n              matrix: args[i++],\n              pred: parseCriteria(args[i++])\n            });\n          }\n\n          ROW: for (var row = 0; row < matrix.height; ++row) {\n            COL: for (var col = 0; col < matrix.width; ++col) {\n              for (i = 0; i < chunks.length; ++i) {\n                var val = chunks[i].matrix.get(row, col);\n\n                if (!chunks[i].pred(val == null || val === \"\" ? 0 : val)) {\n                  continue COL;\n                }\n              }\n\n              f(row, col);\n            }\n          }\n        }\n\n        var ARGS_COUNTIFS = [[\"m1\", \"matrix\"], [\"c1\", \"anyvalue\"], [[\"m2\", \"matrix\"], [\"c2\", \"anyvalue\"]]];\n        defineFunction(\"countifs\", function (m1, c1, rest) {\n          var count = 0;\n          rest.unshift(m1, c1);\n          forIFS(rest, function () {\n            count++;\n          });\n          return count;\n        }).args(ARGS_COUNTIFS);\n        var ARGS_SUMIFS = [[\"range\", \"matrix\"]].concat(ARGS_COUNTIFS);\n        defineFunction(\"sumifs\", function (range, m1, c1, args) {\n          // hack: insert a predicate that filters out non-numeric\n          // values; should also accept blank cells.  it's safe to\n          // modify args.\n          args.unshift(range, numericPredicate, m1, c1);\n          var sum = 0;\n          forIFS(args, function (row, col) {\n            var val = range.get(row, col);\n\n            if (val) {\n              sum += val;\n            }\n          });\n          return sum;\n        }).args(ARGS_SUMIFS); // similar to sumifs, but compute average of matching cells\n\n        defineFunction(\"averageifs\", function (range, m1, c1, args) {\n          args.unshift(range, numericPredicate, m1, c1);\n          var sum = 0,\n              count = 0;\n          forIFS(args, function (row, col) {\n            var val = range.get(row, col);\n\n            if (val == null || val === \"\") {\n              val = 0;\n            }\n\n            sum += val;\n            count++;\n          });\n          return count ? sum / count : new CalcError(\"DIV/0\");\n        }).args(ARGS_SUMIFS);\n        defineFunction(\"countif\", function (matrix, criteria) {\n          criteria = parseCriteria(criteria);\n          var count = 0;\n          matrix.each(function (val) {\n            if (criteria(val)) {\n              count++;\n            }\n          });\n          return count;\n        }).args([[\"range\", \"matrix\"], [\"*criteria\", \"anyvalue\"]]);\n        var ARGS_SUMIF = [[\"range\", \"matrix\"], [\"*criteria\", \"anyvalue\"], [\"sumRange\", [\"or\", \"area\", \"#matrix\", [\"null\", \"$range\"]]]];\n\n        function fetchSumRange(continuation) {\n          return function (callback, range, criteria, sumRange) {\n            var self = this;\n\n            if (sumRange instanceof Ref) {\n              // make sure it covers the same area as `range`, as the “spec” mentions:\n              //\n              //     The sum_range argument does not have to be the same size and shape as the\n              //     range argument. The actual cells that are added are determined by using the\n              //     upper leftmost cell in the sum_range argument as the beginning cell, and then\n              //     including cells that correspond in size and shape to the range argument.\n              //\n              // It does make one wonder, since only the top-left cell in `sumRange` matters, why\n              // should it be a range at all?  Oh well, Excel.\n              var r = sumRange.clone().toRangeRef();\n\n              if (r.width() != range.width || r.height() != range.height) {\n                if (!isFinite(r.topLeft.row)) {\n                  r.topLeft.row = 0;\n                }\n\n                if (!isFinite(r.topLeft.col)) {\n                  r.topLeft.col = 0;\n                }\n\n                r.bottomRight.row = r.topLeft.row + range.height - 1;\n                r.bottomRight.col = r.topLeft.col + range.width - 1;\n                return self.resolveCells([r], function () {\n                  callback(continuation(range, criteria, self.asMatrix(r)));\n                });\n              }\n            }\n\n            callback(continuation(range, criteria, self.asMatrix(sumRange)));\n          };\n        }\n\n        defineFunction(\"sumif\", fetchSumRange(function (range, criteria, sumRange) {\n          var sum = 0;\n          criteria = parseCriteria(criteria);\n          range.each(function (val, row, col) {\n            if (criteria(val)) {\n              var v = sumRange.get(row, col);\n\n              if (numericPredicate(v)) {\n                sum += v || 0;\n              }\n            }\n          });\n          return sum;\n        })).argsAsync(ARGS_SUMIF);\n        defineFunction(\"averageif\", fetchSumRange(function (range, criteria, sumRange) {\n          var sum = 0,\n              count = 0;\n          criteria = parseCriteria(criteria);\n          range.each(function (val, row, col) {\n            if (criteria(val)) {\n              var v = sumRange.get(row, col);\n\n              if (numericPredicate(v)) {\n                sum += v || 0;\n                count++;\n              }\n            }\n          });\n          return count ? sum / count : new CalcError(\"DIV/0\");\n        })).argsAsync(ARGS_SUMIF);\n\n        (function (def) {\n          def(\"large\", function (numbers, nth) {\n            return numbers.sort(descending)[nth];\n          });\n          def(\"small\", function (numbers, nth) {\n            return numbers.sort(ascending)[nth];\n          });\n        })(function (name, handler) {\n          defineFunction(name, function (matrix, nth) {\n            var numbers = [];\n            var error = matrix.each(function (val) {\n              if (val instanceof CalcError) {\n                return val;\n              }\n\n              if (typeof val == \"number\") {\n                numbers.push(val);\n              }\n            });\n\n            if (error) {\n              return error;\n            }\n\n            if (nth > numbers.length) {\n              return new CalcError(\"NUM\");\n            }\n\n            return handler(numbers, nth - 1);\n          }).args([[\"array\", \"matrix\"], [\"*nth\", \"number++\"]]);\n        });\n\n        function _avg(numbers) {\n          return numbers.reduce(function (sum, num) {\n            return sum + num;\n          }, 0) / numbers.length;\n        }\n\n        function _var_sp(numbers, divisor, avg) {\n          if (avg == null) {\n            avg = _avg(numbers);\n          }\n\n          return numbers.reduce(function (sum, num) {\n            return sum + Math.pow(num - avg, 2);\n          }, 0) / divisor;\n        }\n\n        function _stdev_sp(numbers, divisor) {\n          return Math.sqrt(_var_sp(numbers, divisor));\n        } // https://support.office.com/en-sg/article/STDEV-S-function-7d69cf97-0c1f-4acf-be27-f3e83904cc23\n\n\n        defineFunction(\"stdev.s\", function (numbers) {\n          return _stdev_sp(numbers, numbers.length - 1);\n        }).args([[\"numbers\", [\"collect\", \"number\"]], [\"?\", [\"assert\", \"$numbers.length >= 2\", \"NUM\"]]]); // https://support.office.com/en-sg/article/STDEV-P-function-6e917c05-31a0-496f-ade7-4f4e7462f285\n\n        defineFunction(\"stdev.p\", function (numbers) {\n          return _stdev_sp(numbers, numbers.length);\n        }).args([[\"numbers\", [\"collect\", \"number!\"]], [\"?\", [\"assert\", \"$numbers.length >= 1\", \"NUM\"]]]);\n        defineFunction(\"var.s\", function (numbers) {\n          return _var_sp(numbers, numbers.length - 1);\n        }).args([[\"numbers\", [\"collect\", \"number\"]], [\"?\", [\"assert\", \"$numbers.length >= 2\", \"NUM\"]]]);\n        defineFunction(\"var.p\", function (numbers) {\n          return _var_sp(numbers, numbers.length);\n        }).args([[\"numbers\", [\"collect\", \"number\"]], [\"?\", [\"assert\", \"$numbers.length >= 2\", \"NUM\"]]]);\n        defineFunction(\"median\", function (numbers) {\n          var n = numbers.length;\n          numbers.sort(ascending);\n\n          if (n % 2) {\n            // when length is odd, the median is the number in the middle\n            return numbers[n >> 1];\n          } // that's the average of the two middle numbers, written in in a fancy way\n\n\n          return (numbers[n >>= 1] + numbers[n - 1]) / 2;\n        }).args([[\"numbers\", [\"collect\", \"number\"]], [\"?\", [\"assert\", \"$numbers.length > 0\", \"N/A\"]]]);\n        defineFunction(\"mode.sngl\", function (numbers) {\n          numbers.sort(ascending);\n          var prev = null,\n              count = 0,\n              max = 1,\n              mode = null;\n\n          for (var i = 0; i < numbers.length; ++i) {\n            var n = numbers[i];\n\n            if (n != prev) {\n              count = 1;\n              prev = n;\n            } else {\n              count++;\n            }\n\n            if (count > max) {\n              max = count;\n              mode = n;\n            }\n          }\n\n          return mode == null ? new CalcError(\"N/A\") : mode;\n        }).args([[\"numbers\", [\"collect\", \"number\"]]]);\n        defineFunction(\"mode.mult\", function (numbers) {\n          var seen = Object.create(null),\n              max = 2,\n              res = [];\n          numbers.forEach(function (num) {\n            var s = seen[num] || 0;\n            seen[num] = ++s;\n\n            if (s == max) {\n              res.push(num);\n            } else if (s > max) {\n              max = s;\n              res = [num];\n            }\n          });\n          var m = new Matrix(this);\n          res.forEach(function (num, i) {\n            m.set(i, 0, num);\n          });\n          return m;\n        }).args([[\"numbers\", [\"collect\", \"number\"]]]);\n        defineFunction(\"geomean\", function (numbers) {\n          var n = numbers.length;\n          var p = numbers.reduce(function (p, num) {\n            if (num < 0) {\n              throw new CalcError(\"NUM\");\n            }\n\n            return p * num;\n          }, 1);\n          return Math.pow(p, 1 / n);\n        }).args([[\"numbers\", [\"collect\", \"number\"]], [\"?\", [\"assert\", \"$numbers.length > 0\", \"NUM\"]]]);\n        defineFunction(\"harmean\", function (numbers) {\n          var n = numbers.length;\n          var s = numbers.reduce(function (s, num) {\n            if (!num) {\n              throw new CalcError(\"DIV/0\");\n            }\n\n            return s + 1 / num;\n          }, 0);\n          return n / s;\n        }).args([[\"numbers\", [\"collect\", \"number\"]], [\"?\", [\"assert\", \"$numbers.length > 0\", \"NUM\"]]]);\n        defineFunction(\"trimmean\", function (numbers, p) {\n          var n = numbers.length;\n          numbers.sort(ascending);\n          var discard = Math.floor(n * p);\n\n          if (discard % 2) {\n            --discard;\n          }\n\n          discard /= 2;\n          var sum = 0;\n\n          for (var i = discard; i < n - discard; ++i) {\n            sum += numbers[i];\n          }\n\n          return sum / (n - discard * 2);\n        }).args([[\"numbers\", [\"collect\", \"number\", 1]], [\"percent\", [\"and\", \"number\", [\"[between)\", 0, 1]]], [\"?\", [\"assert\", \"$numbers.length > 0\", \"NUM\"]]]);\n        defineFunction(\"frequency\", function (data, bins) {\n          // apparently this always returns a vertical matrix in Excel, so we collect all numbers in\n          // bins instead of receiving it as a Matrix and try to mimic its shape.\n          data.sort(ascending);\n          bins.sort(ascending);\n          var prev = -Infinity;\n          var i = 0;\n\n          function count(max) {\n            var n = 0;\n\n            while (i < data.length && data[i] > prev && data[i] <= max) {\n              ++n;\n              ++i;\n            }\n\n            return n;\n          }\n\n          var m = new Matrix(this);\n          bins.forEach(function (val, i) {\n            var n = count(val);\n            prev = val;\n            m.set(i, 0, n);\n          });\n          m.set(m.height, 0, data.length - i);\n          return m;\n        }).args([[\"data\", [\"collect\", \"number\", 1]], [\"bins\", [\"collect\", \"number\", 1]]]);\n        defineFunction(\"rank.eq\", function (val, numbers, asc) {\n          numbers.sort(asc ? ascending : descending);\n          var pos = numbers.indexOf(val);\n          return pos < 0 ? new CalcError(\"N/A\") : pos + 1;\n        }).args([[\"value\", \"number\"], [\"numbers\", [\"collect\", \"number\"]], [\"order\", [\"or\", \"logical\", [\"null\", false]]]]);\n        defineAlias(\"rank\", \"rank.eq\");\n        defineFunction(\"rank.avg\", function (val, numbers, asc) {\n          numbers.sort(asc ? ascending : descending);\n          var pos = numbers.indexOf(val);\n\n          if (pos < 0) {\n            return new CalcError(\"N/A\");\n          }\n\n          for (var i = pos; numbers[i] == val; ++i) {}\n\n          return (pos + i + 1) / 2;\n        }).args([[\"value\", \"number\"], [\"numbers\", [\"collect\", \"number\"]], [\"order\", [\"or\", \"logical\", [\"null\", false]]]]); // formula available at https://support.office.microsoft.com/en-us/article/KURT-function-cbbc2312-dfa6-4cc4-b5c0-1b3c59cc9377\n\n        defineFunction(\"kurt\", function (numbers) {\n          var n = numbers.length;\n\n          var avg = _avg(numbers);\n\n          var variance = _var_sp(numbers, n - 1, avg);\n\n          var stddev = Math.sqrt(variance);\n          var sum = numbers.reduce(function (sum, num) {\n            return sum + Math.pow((num - avg) / stddev, 4);\n          }, 0);\n          return n * (n + 1) / ((n - 1) * (n - 2) * (n - 3)) * sum - 3 * Math.pow(n - 1, 2) / ((n - 2) * (n - 3));\n        }).args([[\"numbers\", [\"collect\", \"number\"]], [\"?\", [\"assert\", \"$numbers.length >= 4\", \"NUM\"]]]);\n\n        function _percentrank(numbers, x, exc) {\n          var nlt = 0,\n              ngt = 0,\n              left = null,\n              right = null,\n              found = false;\n          numbers.forEach(function (num) {\n            if (num < x) {\n              nlt++;\n              left = left == null ? num : Math.max(left, num);\n            } else if (num > x) {\n              ngt++;\n              right = right == null ? num : Math.min(right, num);\n            } else {\n              found = true;\n            }\n          });\n\n          if (!nlt && !ngt) {\n            return new CalcError(\"N/A\");\n          }\n\n          if (found) {\n            if (exc) {\n              return (nlt + 1) / (numbers.length + 1);\n            }\n\n            return nlt / (nlt + ngt);\n          }\n\n          return ((right - x) * _percentrank(numbers, left, exc) + (x - left) * _percentrank(numbers, right, exc)) / (right - left);\n        }\n\n        var ARGS_PERCENTRANK = [[\"array\", [\"collect\", \"number\", 1]], [\"x\", \"number\"], [\"significance\", [\"or\", [\"null\", 3], \"integer++\"]], [\"?\", [\"assert\", \"$array.length > 0\", \"NUM\"]]];\n        defineFunction(\"percentrank.inc\", function (numbers, x, significance) {\n          var p = _percentrank(numbers, x, 0);\n\n          p = p.toFixed(significance + 1);\n          return parseFloat(p.substr(0, p.length - 1));\n        }).args(ARGS_PERCENTRANK);\n        defineFunction(\"percentrank.exc\", function (numbers, x, significance) {\n          var p = _percentrank(numbers, x, 1);\n\n          p = p.toFixed(significance + 1);\n          return parseFloat(p.substr(0, p.length - 1));\n        }).args(ARGS_PERCENTRANK);\n        defineAlias(\"percentrank\", \"percentrank.inc\");\n\n        function _covariance(x, y, divisor) {\n          var sum = 0;\n\n          var ax = _avg(x);\n\n          var ay = _avg(y);\n\n          var n = x.length;\n\n          for (var i = 0; i < n; ++i) {\n            sum += (x[i] - ax) * (y[i] - ay);\n          }\n\n          return sum / divisor;\n        }\n\n        defineFunction(\"covariance.p\", function (x, y) {\n          return _covariance(x, y, x.length);\n        }).args([[\"array1\", [\"collect\", \"number\", 1]], [\"array2\", [\"collect\", \"number\", 1]], [\"?\", [\"assert\", \"$array1.length == $array2.length\", \"N/A\"]], [\"?\", [\"assert\", \"$array1.length > 0\", \"DIV/0\"]]]);\n        defineFunction(\"covariance.s\", function (x, y) {\n          return _covariance(x, y, x.length - 1);\n        }).args([[\"array1\", [\"collect\", \"number\", 1]], [\"array2\", [\"collect\", \"number\", 1]], [\"?\", [\"assert\", \"$array1.length == $array2.length\", \"N/A\"]], [\"?\", [\"assert\", \"$array1.length > 1\", \"DIV/0\"]]]);\n        defineAlias(\"covar\", \"covariance.p\");\n        /* -----[ Factorials ]----- */\n\n        var _fact = util.memoize(function (n) {\n          for (var i = 2, fact = 1; i <= n; ++i) {\n            fact *= i;\n          }\n\n          return fact;\n        });\n\n        defineFunction(\"fact\", _fact).args([[\"*n\", \"integer+\"]]);\n        defineFunction(\"factdouble\", function (n) {\n          for (var i = 2 + (n & 1), fact = 1; i <= n; i += 2) {\n            fact *= i;\n          }\n\n          return fact;\n        }).args([[\"*n\", \"integer+\"]]);\n        defineFunction(\"multinomial\", function (numbers) {\n          var div = 1,\n              sum = 0;\n          numbers.forEach(function (n) {\n            if (n < 0) {\n              throw new CalcError(\"NUM\");\n            }\n\n            sum += n;\n            div *= _fact(n);\n          });\n          return _fact(sum) / div;\n        }).args([[\"numbers\", [\"collect\", \"number\"]]]);\n\n        var _combinations = util.memoize(function (n, k) {\n          for (var f1 = k + 1, f2 = 1, p1 = 1, p2 = 1; f2 <= n - k; ++f1, ++f2) {\n            p1 *= f1;\n            p2 *= f2;\n          }\n\n          return p1 / p2;\n        });\n\n        defineFunction(\"combin\", _combinations).args([[\"*n\", \"integer++\"], [\"*k\", [\"and\", \"integer\", [\"[between]\", 0, \"$n\"]]]]);\n        defineFunction(\"combina\", function (n, k) {\n          return _combinations(n + k - 1, n - 1);\n        }).args([[\"*n\", \"integer++\"], [\"*k\", [\"and\", \"integer\", [\"[between]\", 1, \"$n\"]]]]);\n        /* -----[ Statistical functions ]----- */\n\n        defineFunction(\"average\", function (numbers) {\n          var sum = numbers.reduce(function (sum, num) {\n            return sum + num;\n          }, 0);\n          return sum / numbers.length;\n        }).args([// most numeric functions must treat booleans as numbers (1 for TRUE\n        // and 0 for FALSE), but AVERAGE shouldn't.\n        [\"numbers\", [\"collect\", \"number!\"]], [\"?\", [\"assert\", \"$numbers.length > 0\", \"DIV/0\"]]]);\n        defineFunction(\"averagea\", function (values) {\n          var sum = 0,\n              count = 0;\n          values.forEach(function (num) {\n            if (typeof num != \"string\") {\n              sum += num;\n            }\n\n            ++count;\n          });\n          return count ? sum / count : new CalcError(\"DIV/0\");\n        }).args([[\"values\", [\"collect\", \"anyvalue\"]]]);\n\n        function _percentile(numbers, rank) {\n          numbers.sort(ascending);\n          var n = numbers.length;\n          var k = rank | 0,\n              d = rank - k;\n\n          if (k === 0) {\n            return numbers[0];\n          }\n\n          if (k >= n) {\n            return numbers[n - 1];\n          }\n\n          --k;\n          return numbers[k] + d * (numbers[k + 1] - numbers[k]);\n        }\n\n        function _percentile_inc(numbers, p) {\n          // algorithm from https://en.wikipedia.org/wiki/Percentile#Microsoft_Excel_method\n          var rank = p * (numbers.length - 1) + 1;\n          return _percentile(numbers, rank);\n        }\n\n        function _percentile_exc(numbers, p) {\n          // https://en.wikipedia.org/wiki/Percentile#NIST_method\n          var rank = p * (numbers.length + 1);\n          return _percentile(numbers, rank);\n        }\n\n        defineFunction(\"percentile.inc\", _percentile_inc).args([[\"numbers\", [\"collect\", \"number\", 1]], [\"p\", [\"and\", \"number\", [\"[between]\", 0, 1]]]]);\n        defineFunction(\"percentile.exc\", _percentile_exc).args([[\"numbers\", [\"collect\", \"number\", 1]], [\"p\", [\"and\", \"number\", [\"(between)\", 0, 1]]]]);\n        defineFunction(\"quartile.inc\", function (numbers, quarter) {\n          return _percentile_inc(numbers, quarter / 4);\n        }).args([[\"numbers\", [\"collect\", \"number\", 1]], [\"quarter\", [\"values\", 0, 1, 2, 3, 4]]]);\n        defineFunction(\"quartile.exc\", function (numbers, quarter) {\n          return _percentile_exc(numbers, quarter / 4);\n        }).args([[\"numbers\", [\"collect\", \"number\", 1]], [\"quarter\", [\"values\", 0, 1, 2, 3, 4]]]);\n        defineAlias(\"quartile\", \"quartile.inc\");\n        defineAlias(\"percentile\", \"percentile.inc\");\n        var AGGREGATE_FUNCS = [\"AVERAGE\", \"COUNT\", \"COUNTA\", \"MAX\", \"MIN\", \"PRODUCT\", \"STDEV.S\", \"STDEV.P\", \"SUM\", \"VAR.S\", \"VAR.P\", \"MEDIAN\", \"MODE.SNGL\", \"LARGE\", \"SMALL\", \"PERCENTILE.INC\", \"QUARTILE.INC\", \"PERCENTILE.EXC\", \"QUARTILE.EXC\"];\n\n        function fetchValuesForAggregate(self, args, options) {\n          var values = [];\n          var opt_ignore_hidden_rows = 1;\n          var opt_ignore_errors = 2;\n          var opt_use_aggregates = 4;\n\n          (function fetchValues(args) {\n            if (args instanceof Ref) {\n              self.getRefCells(args, true).forEach(function (cell) {\n                var value = cell.value;\n\n                if (options & opt_ignore_hidden_rows && cell.hidden) {\n                  return;\n                }\n\n                if (cell.formula) {\n                  // XXX: formula.print is fast, but still, can't we do any better here?\n                  //      perhaps access the input string directly somehow?\n                  var str = cell.formula.print(cell.row, cell.col);\n\n                  if (/^\\s*(?:aggregate|subtotal)\\s*\\(/i.test(str)) {\n                    if (!(options & opt_use_aggregates)) {\n                      return;\n                    }\n                  }\n                }\n\n                if (options & opt_ignore_errors && value instanceof CalcError) {\n                  return;\n                }\n\n                if (typeof value == \"number\" || value instanceof CalcError) {\n                  values.push(value);\n                }\n              });\n            } else if (Array.isArray(args)) {\n              for (var i = 0; i < args.length; ++i) {\n                fetchValues(args[i]);\n              }\n            } else if (args instanceof Matrix) {\n              args.each(fetchValues);\n            } else if (typeof args == \"number\") {\n              values.push(args);\n            } else if (args instanceof CalcError && !(options & opt_ignore_errors)) {\n              values.push(args);\n            }\n          })(args);\n\n          return values;\n        } // AGGREGATE function\n        //\n        // https://support.office.com/en-SG/article/aggregate-function-c8caed56-07df-4aeb-9741-23693ffbe525\n        //\n        // we can only partially type-check this function.  also, we need to use the async version in\n        // order to resolve references and delegate values to the function to aggregate.\n\n\n        defineFunction(\"aggregate\", function (callback, funcId, options, args) {\n          // options is a bit field.  that makes sense; it's the documentation which doesn't.\n          var self = this;\n          self.resolveCells(args, function () {\n            var values;\n\n            if (funcId > 12) {\n              // \"array form\"\n              values = fetchValuesForAggregate(self, args[0], options);\n              var k = args[1];\n\n              if (k instanceof CellRef) {\n                k = self.getRefData(k);\n              }\n\n              if (typeof k != \"number\") {\n                return callback(new CalcError(\"VALUE\"));\n              }\n            } else {\n              values = fetchValuesForAggregate(self, args, options);\n            }\n\n            self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n          });\n        }).argsAsync([[\"funcId\", [\"values\", 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]], [\"options\", [\"or\", [\"null\", 0], [\"values\", 0, 1, 2, 3, 4, 5, 6, 7]]], [\"args\", \"rest\"]]);\n        defineFunction(\"subtotal\", function (callback, funcId) {\n          var self = this;\n          var ignoreHidden = funcId > 100;\n\n          if (ignoreHidden) {\n            funcId -= 100;\n          }\n\n          var args = [];\n\n          for (var i = 2; i < arguments.length; ++i) {\n            args.push(arguments[i]);\n          }\n\n          self.resolveCells(args, function () {\n            var values = fetchValuesForAggregate(self, args, ignoreHidden ? 1 : 0);\n            self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n          });\n        }).argsAsync([[\"funcId\", [\"values\", 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111]], [\"+\", [\"ref\", [\"or\", \"ref\", \"#matrix\"]]]]); // https://support.office.com/en-sg/article/AVEDEV-function-ec78fa01-4755-466c-9a2b-0c4f9eacaf6d\n\n        defineFunction(\"avedev\", function (numbers) {\n          var avg = numbers.reduce(function (sum, num) {\n            return sum + num;\n          }, 0) / numbers.length;\n          return numbers.reduce(function (sum, num) {\n            return sum + Math.abs(num - avg);\n          }, 0) / numbers.length;\n        }).args([[\"numbers\", [\"collect\", \"number\"]], [\"?\", [\"assert\", \"$numbers.length >= 2\", \"NUM\"]]]);\n\n        function _binom_dist(x, n, p, cumulative) {\n          if (!cumulative) {\n            return _combinations(n, x) * Math.pow(p, x) * Math.pow(1 - p, n - x);\n          } else {\n            var sum = 0;\n\n            for (var j = 0; j <= x; ++j) {\n              sum += _combinations(n, j) * Math.pow(p, j) * Math.pow(1 - p, n - j);\n            }\n\n            return sum;\n          }\n        }\n\n        defineFunction(\"binom.dist\", _binom_dist).args([[\"successes\", \"integer+\"], [\"trials\", [\"and\", \"integer\", [\"assert\", \"$trials >= $successes\"]]], [\"probability\", [\"and\", \"number\", [\"[between]\", 0, 1]]], [\"cumulative\", \"logical\"]]);\n        defineAlias(\"binomdist\", \"binom.dist\");\n        defineFunction(\"binom.inv\", function (n, p, alpha) {\n          // XXX: could a binary search be faster?\n          for (var x = 0; x <= n; ++x) {\n            if (_binom_dist(x, n, p, true) >= alpha) {\n              return x;\n            }\n          }\n\n          return new CalcError(\"N/A\"); // XXX: is this right?\n        }).args([[\"trials\", \"integer+\"], [\"probability\", [\"and\", \"number\", [\"[between]\", 0, 1]]], [\"alpha\", [\"and\", \"number\", [\"[between]\", 0, 1]]]]);\n        defineAlias(\"critbinom\", \"binom.inv\");\n        defineFunction(\"binom.dist.range\", function (n, p, s, s2) {\n          var sum = 0;\n\n          for (var k = s; k <= s2; ++k) {\n            sum += _combinations(n, k) * Math.pow(p, k) * Math.pow(1 - p, n - k);\n          }\n\n          return sum;\n        }).args([[\"trials\", \"integer+\"], [\"probability\", [\"and\", \"number\", [\"[between]\", 0, 1]]], [\"successes_min\", [\"and\", \"integer\", [\"[between]\", 0, \"$trials\"]]], [\"successes_max\", [\"or\", [\"and\", \"integer\", [\"[between]\", \"$successes_min\", \"$trials\"]], [\"null\", \"$successes_min\"]]]]);\n        defineFunction(\"negbinom.dist\", function (x, k, p, cumulative) {\n          if (cumulative) {\n            var sum = 0;\n\n            while (x >= 0) {\n              sum += _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n              x--;\n            }\n\n            return sum;\n          }\n\n          return _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n        }).args([[\"number_f\", \"integer+\"], [\"number_s\", \"integer+\"], [\"probability_s\", [\"and\", \"number\", [\"[between]\", 0, 1]]], [\"cumulative\", \"logical\"]]);\n        defineAlias(\"negbinomdist\", \"negbinom.dist\");\n        /* -----[ lookup functions ]----- */\n\n        defineFunction(\"address\", function (row, col, abs, a1, sheet) {\n          // by some lucky coincidence, we get the corret `rel` value by just subtracting 1 from the\n          // abs argument\n          var cell = new CellRef(row - 1, col - 1, abs - 1);\n\n          if (sheet) {\n            cell.setSheet(sheet, true);\n          }\n\n          return a1 ? cell.print(0, 0) : cell.print();\n        }).args([[\"row\", \"integer++\"], [\"col\", \"integer++\"], [\"abs\", [\"or\", [\"null\", 1], [\"values\", 1, 2, 3, 4]]], [\"a1\", [\"or\", [\"null\", true], \"logical\"]], [\"sheet\", [\"or\", \"null\", \"string\"]]]);\n        defineFunction(\"areas\", function (ref) {\n          var count = 0;\n\n          (function loop(x) {\n            if (x instanceof CellRef || x instanceof RangeRef) {\n              count++;\n            } else if (x instanceof UnionRef) {\n              x.refs.forEach(loop);\n            } // XXX: NameRef if we add support\n\n          })(ref);\n\n          return count;\n        }).args([[\"ref\", \"ref\"]]);\n        defineFunction(\"choose\", function (index, args) {\n          if (index > args.length) {\n            return new CalcError(\"N/A\");\n          } else {\n            return args[index - 1];\n          }\n        }).args([[\"*index\", \"integer\"], [\"+\", [\"value\", \"anything\"]]]);\n        defineFunction(\"column\", function (ref) {\n          if (!ref) {\n            return this.formula.col + 1;\n          }\n\n          if (ref instanceof CellRef) {\n            return ref.col + 1;\n          }\n\n          return this.asMatrix(ref).mapCol(function (col) {\n            return col + ref.topLeft.col + 1;\n          });\n        }).args([[\"ref\", [\"or\", \"area\", \"null\"]]]);\n        defineFunction(\"columns\", function (m) {\n          return m instanceof Ref ? m.width() : m.width;\n        }).args([[\"ref\", [\"or\", \"area\", \"#matrix\"]]]);\n        defineFunction(\"formulatext\", function (ref) {\n          var cell = this.getRefCells(ref)[0]; // XXX: overkill, but oh well.\n\n          if (!cell.formula) {\n            return new CalcError(\"N/A\");\n          }\n\n          return cell.formula.print(cell.row, cell.col);\n        }).args([[\"ref\", \"ref\"]]);\n        defineFunction(\"hlookup\", function (value, m, row, approx) {\n          var resultCol = null;\n          m.eachCol(function (col) {\n            var data = m.get(0, col);\n\n            if (approx) {\n              if (data > value) {\n                return true;\n              }\n\n              resultCol = col;\n            } else if (data === value) {\n              resultCol = col;\n              return true;\n            }\n          });\n\n          if (resultCol == null) {\n            return new CalcError(\"N/A\");\n          }\n\n          return m.get(row - 1, resultCol);\n        }).args([[\"value\", \"anyvalue\"], [\"range\", \"matrix\"], [\"row\", \"integer++\"], [\"approx\", [\"or\", \"logical\", [\"null\", true]]]]);\n        defineFunction(\"index\", function (callback, ref, row, col, areanum) {\n          var self = this;\n\n          if (ref instanceof UnionRef) {\n            ref = ref.refs[areanum - 1];\n          }\n\n          if (!row && !col || !ref) {\n            return callback(new CalcError(\"N/A\"));\n          }\n\n          if (ref instanceof CellRef) {\n            ref = ref.toRangeRef();\n          }\n\n          if (ref instanceof RangeRef) {\n            if (row && col) {\n              if (col > ref.width() || row > ref.height()) {\n                return callback(new CalcError(\"REF\"));\n              } // fetching a single cell\n\n\n              var cell = ref.toCell(row - 1, col - 1);\n              self.resolveCells([cell], function () {\n                callback(self.getRefData(cell));\n              });\n              return;\n            }\n\n            if (!row) {\n              // fetch a full column\n              var colRange = ref.toColumn(col - 1);\n              self.resolveCells([colRange], function () {\n                callback(self.asMatrix(colRange));\n              });\n              return;\n            }\n\n            if (!col) {\n              // fetch a full row\n              var rowRange = ref.toRow(row - 1);\n              self.resolveCells([rowRange], function () {\n                callback(self.asMatrix(rowRange));\n              });\n              return;\n            }\n          } else if (ref instanceof Matrix) {\n            if (ref.width > 1 && ref.height > 1) {\n              if (row && col) {\n                return callback(ref.get(row - 1, col - 1));\n              }\n\n              if (!row) {\n                return callback(ref.mapRow(function (row) {\n                  return ref.get(row, col - 1);\n                }));\n              }\n\n              if (!col) {\n                return callback(ref.mapCol(function (col) {\n                  return ref.get(row - 1, col);\n                }));\n              }\n            }\n\n            if (ref.width == 1) {\n              return callback(ref.get(row - 1, 0));\n            }\n\n            if (ref.height == 1) {\n              return callback(ref.get(0, col - 1));\n            }\n          } else {\n            callback(new CalcError(\"REF\"));\n          }\n        }).argsAsync([[\"range\", [\"or\", \"ref\", \"matrix\"]], [\"row\", [\"or\", \"integer+\", \"null\"]], [\"col\", [\"or\", \"integer+\", \"null\"]], [\"areanum\", [\"or\", \"integer++\", [\"null\", 1]]]]);\n        defineFunction(\"indirect\", function (thing) {\n          try {\n            // XXX: does more work than needed.  we could go for parseReference, but that one\n            // doesn't (yet?) support \"SheetName!\" prefix.\n            var f = this.formula;\n            var exp = calc.parseFormula(f.sheet, f.row, f.col, thing);\n            var ref = exp.ast;\n\n            if (ref instanceof NameRef) {\n              ref = this.ss.nameValue(ref, f.sheet, f.row, f.col);\n            }\n\n            if (!(ref instanceof Ref)) {\n              throw 1;\n            }\n\n            return ref.absolute(f.row, f.col);\n          } catch (ex) {\n            return new CalcError(\"REF\");\n          }\n        }).args([[\"thing\", \"string\"]]); // XXX: LOOKUP.  seems to be deprecated in favor of HLOOKUP/VLOOKUP\n        // XXX: double-check this one.\n\n        defineFunction(\"match\", function (val, m, type) {\n          var index = 1,\n              cmp;\n\n          if (type === 0) {\n            cmp = parseCriteria(val);\n          } else if (type === -1) {\n            cmp = parseCriteria(\"<=\" + val);\n          } else if (type === 1) {\n            cmp = parseCriteria(\">=\" + val);\n          }\n\n          if (m.each(function (el) {\n            if (el != null && cmp(el)) {\n              if (type !== 0 && val != el) {\n                --index;\n              }\n\n              return true;\n            }\n\n            index++;\n          }, true) && index > 0) {\n            return index;\n          } else {\n            return new CalcError(\"N/A\");\n          }\n        }).args([[\"value\", \"anyvalue\"], [\"range\", \"matrix\"], [\"type\", [\"or\", [\"values\", -1, 0, 1], [\"null\", 1]]]]);\n        defineFunction(\"offset\", function (ref, rows, cols, height, width) {\n          var topLeft = (ref instanceof CellRef ? ref : ref.topLeft).clone();\n          topLeft.row += rows;\n          topLeft.col += cols;\n\n          if (topLeft.row < 0 || topLeft.col < 0) {\n            return new CalcError(\"VALUE\");\n          }\n\n          if (height > 1 || width > 1) {\n            return new RangeRef(topLeft, new CellRef(topLeft.row + height - 1, topLeft.col + width - 1)).setSheet(ref.sheet, ref.hasSheet());\n          }\n\n          return topLeft;\n        }).args([[\"ref\", \"area\"], [\"*rows\", \"integer\"], [\"*cols\", \"integer\"], [\"*height\", [\"or\", \"integer++\", [\"null\", \"$ref.height()\"]]], [\"*width\", [\"or\", \"integer++\", [\"null\", \"$ref.width()\"]]]]);\n        defineFunction(\"row\", function (ref) {\n          if (!ref) {\n            return this.formula.row + 1;\n          }\n\n          if (ref instanceof CellRef) {\n            return ref.row + 1;\n          }\n\n          return this.asMatrix(ref).mapRow(function (row) {\n            return row + ref.topLeft.row + 1;\n          });\n        }).args([[\"ref\", [\"or\", \"area\", \"null\"]]]);\n        defineFunction(\"rows\", function (m) {\n          return m instanceof Ref ? m.height() : m.height;\n        }).args([[\"ref\", [\"or\", \"area\", \"#matrix\"]]]);\n        defineFunction(\"vlookup\", function (value, m, col, approx) {\n          var resultRow = null;\n\n          if (typeof value != \"number\") {\n            approx = false;\n          }\n\n          if (typeof value == \"string\") {\n            value = value.toLowerCase();\n          }\n\n          m.eachRow(function (row) {\n            var data = m.get(row, 0);\n\n            if (approx) {\n              if (data > value) {\n                return true;\n              }\n\n              resultRow = row;\n            } else {\n              if (typeof data == \"string\") {\n                data = data.toLowerCase();\n              }\n\n              if (data === value) {\n                resultRow = row;\n                return true;\n              }\n            }\n          });\n\n          if (resultRow == null) {\n            return new CalcError(\"N/A\");\n          }\n\n          return m.get(resultRow, col - 1);\n        }).args([[\"value\", \"anyvalue\"], [\"range\", \"matrix\"], [\"col\", \"integer++\"], [\"approx\", [\"or\", \"logical\", [\"null\", true]]]]);\n        /* -----[ Date and time functions ]----- */\n\n        defineFunction(\"date\", function (year, month, date) {\n          return packDate(year, month - 1, date);\n        }).args([[\"*year\", \"integer\"], [\"*month\", \"integer\"], [\"*date\", \"integer\"]]);\n        defineFunction(\"day\", function (date) {\n          return unpackDate(date).date;\n        }).args([[\"*date\", \"date\"]]);\n        defineFunction(\"month\", function (date) {\n          return unpackDate(date).month + 1;\n        }).args([[\"*date\", \"date\"]]);\n        defineFunction(\"year\", function (date) {\n          return unpackDate(date).year;\n        }).args([[\"*date\", \"date\"]]);\n        defineFunction(\"weekday\", function (date) {\n          // XXX: TODO type\n          return unpackDate(date).day + 1;\n        }).args([[\"*date\", \"date\"]]); // https://support.office.com/en-GB/article/WEEKNUM-function-e5c43a03-b4ab-426c-b411-b18c13c75340\n        // XXX: this is a mess.\n\n        defineFunction(\"weeknum\", function (date, type) {\n          var fw = packDate(unpackDate(date).year, 0, 1);\n          var sy = unpackDate(fw);\n          var diff;\n\n          if (type == 21) {\n            // Monday-based weeks, first week is the one containing the first Thursday of the year\n            // we want to place in fw and sy the first Thursday\n            diff = 3 - (sy.day + 6) % 7;\n\n            if (diff < 0) {\n              diff += 7;\n            }\n\n            fw += diff;\n            sy.date += diff;\n            sy.day = 4; // Thursday.\n\n            type = 1;\n          } else {\n            if (type == 1) {\n              type = 0;\n            } else if (type == 2) {\n              type = 1;\n            } else {\n              type = (type - 10) % 7;\n            } // finally compatible with what we got:\n            // type == 0 means week starts on Sunday\n            //         1                      Monday\n            //         2                      Tuesday\n            // ...\n\n          }\n\n          diff = sy.day - type;\n\n          if (diff < 0) {\n            diff += 7;\n          }\n\n          fw -= diff;\n          return Math.ceil((date + 1 - fw) / 7);\n        }).args([[\"*date\", \"date\"], [\"*type\", [\"or\", [\"null\", 1], [\"values\", 1, 2, 11, 12, 13, 14, 15, 16, 17, 21]]]]);\n\n        function weeksInYear(year) {\n          var d = unpackDate(packDate(year, 0, 1));\n\n          if (d.day == 4 || d.day == 3 && runtime.isLeapYear(year)) {\n            // long year\n            return 53;\n          }\n\n          return 52;\n        }\n\n        defineFunction(\"isoweeknum\", function isoweeknum(date) {\n          // https://en.wikipedia.org/wiki/ISO_week_date#Calculating_the_week_number_of_a_given_date\n          var d = unpackDate(date);\n          var dow = d.day || 7;\n          var wk = Math.floor((d.ord - dow + 10) / 7);\n\n          if (wk < 1) {\n            return weeksInYear(d.year - 1);\n          } else if (wk == 53 && wk > weeksInYear(d.year)) {\n            return 1;\n          }\n\n          return wk;\n        }).args([[\"*date\", \"date\"]]);\n        defineFunction(\"now\", function () {\n          return runtime.dateToSerial(new Date());\n        }).args([]);\n        defineFunction(\"today\", function () {\n          return runtime.dateToSerial(new Date()) | 0;\n        }).args([]);\n        defineFunction(\"time\", function (hh, mm, ss) {\n          return runtime.packTime(hh, mm, ss, 0);\n        }).args([[\"*hours\", \"integer\"], [\"*minutes\", \"integer\"], [\"*seconds\", \"integer\"]]);\n        defineFunction(\"hour\", function (time) {\n          return runtime.unpackTime(time).hours;\n        }).args([[\"*time\", \"datetime\"]]);\n        defineFunction(\"minute\", function (time) {\n          return runtime.unpackTime(time).minutes;\n        }).args([[\"*time\", \"datetime\"]]);\n        defineFunction(\"second\", function (time) {\n          return runtime.unpackTime(time).seconds;\n        }).args([[\"*time\", \"datetime\"]]);\n        defineFunction(\"edate\", function (base, months) {\n          var d = unpackDate(base);\n          var m = d.month + months;\n          var y = d.year + Math.floor(m / 12);\n          m %= 12;\n\n          if (m < 0) {\n            m += 12;\n          }\n\n          d = Math.min(d.date, daysInMonth(y, m));\n          return packDate(y, m, d);\n        }).args([[\"*start_date\", \"date\"], [\"*months\", \"integer\"]]);\n        defineFunction(\"eomonth\", function (base, months) {\n          var d = unpackDate(base);\n          var m = d.month + months;\n          var y = d.year + Math.floor(m / 12);\n          m %= 12;\n\n          if (m < 0) {\n            m += 12;\n          }\n\n          d = daysInMonth(y, m);\n          return packDate(y, m, d);\n        }).args([[\"*start_date\", \"date\"], [\"*months\", \"integer\"]]);\n        defineFunction(\"workday\", function (date, n, holidays) {\n          // XXX: the algorithm here is pretty dumb, can we do better?\n          var inc = n > 0 ? 1 : -1;\n          n = Math.abs(n);\n          var dow = unpackDate(date).day;\n\n          while (n > 0) {\n            date += inc;\n            dow = (dow + inc) % 7;\n\n            if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n              --n;\n            }\n          }\n\n          return date;\n        }).args([[\"start_date\", \"date\"], [\"days\", \"integer\"], [\"holidays\", [\"collect\", \"date\"]]]);\n        defineFunction(\"networkdays\", function (date, end, holidays) {\n          // XXX: the algorithm here is pretty dumb, can we do better?\n          if (date > end) {\n            var tmp = date;\n            date = end;\n            end = tmp;\n          }\n\n          var count = 0;\n          var dow = unpackDate(date).day;\n\n          while (date <= end) {\n            if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n              count++;\n            }\n\n            date++;\n            dow = (dow + 1) % 7;\n          }\n\n          return count;\n        }).args([[\"start_date\", \"date\"], [\"end_date\", \"date\"], [\"holidays\", [\"collect\", \"date\"]]]);\n        defineFunction(\"days\", function (end, start) {\n          return end - start;\n        }).args([[\"*start_date\", \"date\"], [\"*end_date\", \"date\"]]);\n\n        function _days_360(start, end, method) {\n          var d1 = unpackDate(start);\n          var d2 = unpackDate(end); // https://en.wikipedia.org/wiki/360-day_calendar\n          // humanity is a mess.\n\n          if (method) {\n            // EU method\n            if (d1.date == 31) {\n              d1.date = 30;\n            }\n\n            if (d2.date == 31) {\n              d2.date = 30;\n            }\n          } else {\n            // US method\n            if (d1.month == 1 && d2.month == 1 && d1.date == daysInMonth(d1.year, 1) && d2.date == daysInMonth(d2.year, 1)) {\n              d2.date = 30;\n            }\n\n            if (d1.date == daysInMonth(d1.year, d1.month)) {\n              d1.date = 30;\n\n              if (d2.date == 31) {\n                d2.date = 30;\n              }\n            } else {\n              if (d1.date == 30 && d2.date == 31) {\n                d2.date = 30;\n              }\n            }\n          }\n\n          return 360 * (d2.year - d1.year) + 30 * (d2.month - d1.month) + (d2.date - d1.date);\n        }\n\n        runtime._days_360 = _days_360;\n        defineFunction(\"days360\", _days_360).args([[\"*start_date\", \"date\"], [\"*end_date\", \"date\"], [\"*method\", [\"or\", \"logical\", [\"null\", false]]]]);\n        defineFunction(\"yearfrac\", function (start, end, method) {\n          switch (method) {\n            case 0:\n              return _days_360(start, end, false) / 360;\n\n            case 1:\n              return (end - start) / daysInYear(unpackDate(start).year);\n\n            case 2:\n              return (end - start) / 360;\n\n            case 3:\n              return (end - start) / 365;\n\n            case 4:\n              return _days_360(start, end, true) / 360;\n          }\n        }).args([[\"*start_date\", \"date\"], [\"*end_date\", \"date\"], [\"*method\", [\"or\", [\"null\", 0], [\"values\", 0, 1, 2, 3, 4]]]]);\n        defineFunction(\"datevalue\", function (text) {\n          var date = runtime.parseDate(text);\n\n          if (date) {\n            return runtime.dateToSerial(date);\n          }\n\n          return new CalcError(\"VALUE\");\n        }).args([[\"*text\", \"string\"]]);\n        defineFunction(\"timevalue\", function (text) {\n          var m = text.toLowerCase().match(/(\\d+):(\\d+)(:(\\d+)(\\.(\\d+))?)?\\s*(am?|pm?)?/);\n\n          if (m) {\n            var hh = parseFloat(m[1]);\n            var mm = parseFloat(m[2]);\n            var ss = m[3] ? parseFloat(m[4]) : 0; //var ms = m[5] ? parseFloat(m[6]) : 0;\n\n            var ampm = m[7];\n\n            if (ampm && (hh > 12 || hh < 1)) {\n              return new CalcError(\"VALUE\");\n            }\n\n            if (/^p/.test(ampm)) {\n              hh += 12;\n            }\n\n            return runtime.packTime(hh, mm, ss, 0);\n          }\n\n          return new CalcError(\"VALUE\");\n        }).args([[\"*text\", \"string\"]]);\n        /* -----[ Matrix functions ]----- */\n\n        defineFunction(\"mdeterm\", function (m) {\n          var error = m.each(function (val) {\n            if (typeof val != \"number\") {\n              return new CalcError(\"VALUE\");\n            }\n          }, true);\n          return error || m.determinant();\n        }).args([[\"m\", [\"and\", \"matrix\", [\"assert\", \"$m.width == $m.height\"]]]]);\n        defineFunction(\"transpose\", function (m) {\n          return m.transpose();\n        }).args([[\"range\", \"matrix\"]]);\n        defineFunction(\"mmult\", function (a, b) {\n          return a.multiply(b);\n        }).args([[\"a\", \"matrix\"], [\"b\", [\"and\", \"matrix\", [\"assert\", \"$b.height == $a.width\"]]]]);\n        defineFunction(\"munit\", function (n) {\n          return new Matrix(this).unit(n);\n        }).args([[\"n\", \"integer+\"]]);\n        defineFunction(\"minverse\", function (m) {\n          var error = m.each(function (val) {\n            if (typeof val != \"number\") {\n              return new CalcError(\"VALUE\");\n            }\n          }, true);\n          return error || m.inverse() || new CalcError(\"VALUE\");\n        }).args([[\"m\", [\"and\", \"matrix\", [\"assert\", \"$m.width == $m.height\"]]]]);\n        /* -----[ Other ]----- */\n\n        defineFunction(\"rand\", function () {\n          return Math.random();\n        }).args([]);\n        defineFunction(\"randbetween\", function (min, max) {\n          return min + Math.floor((max - min + 1) * Math.random());\n        }).args([[\"min\", \"integer\"], [\"max\", [\"and\", \"integer\", [\"assert\", \"$max >= $min\"]]]]);\n        defineFunction(\"true\", function () {\n          return true;\n        }).args([]);\n        defineFunction(\"false\", function () {\n          return true;\n        }).args([]);\n        defineFunction(\"roman\", function (num) {\n          return util.arabicToRoman(num).toUpperCase();\n        }).args([[\"*number\", \"integer\"]]);\n        defineFunction(\"arabic\", function (rom) {\n          var num = util.romanToArabic(rom);\n          return num == null ? new CalcError(\"VALUE\") : num;\n        }).args([[\"*roman\", \"string\"]]);\n        defineFunction(\"base\", function (number, radix, minLen) {\n          var str = number.toString(radix).toUpperCase();\n\n          while (str.length < minLen) {\n            str = \"0\" + str;\n          }\n\n          return str;\n        }).args([[\"*number\", \"integer\"], [\"*radix\", [\"and\", \"integer\", [\"[between]\", 2, 36]]], [\"*minLen\", [\"or\", \"integer+\", [\"null\", 0]]]]);\n        defineFunction(\"decimal\", function (text, radix) {\n          text = text.toUpperCase();\n          var val = 0;\n\n          for (var i = 0; i < text.length; ++i) {\n            var d = text.charCodeAt(i);\n\n            if (d >= 48 && d <= 57) {\n              d -= 48;\n            } else if (d >= 65 && d < 55 + radix) {\n              d -= 55;\n            } else {\n              return new CalcError(\"VALUE\");\n            }\n\n            val = val * radix + d;\n          }\n\n          return val;\n        }).args([[\"*text\", \"string\"], [\"*radix\", [\"and\", \"integer\", [\"[between]\", 2, 36]]]]);\n        /* -----[ String functions ]----- */\n\n        defineFunction(\"char\", function (code) {\n          return String.fromCharCode(code);\n        }).args([[\"*code\", \"integer+\"]]); // From XRegExp\n\n        var RX_NON_PRINTABLE = /[\\0-\\x1F\\x7F-\\x9F\\xAD\\u0378\\u0379\\u037F-\\u0383\\u038B\\u038D\\u03A2\\u0528-\\u0530\\u0557\\u0558\\u0560\\u0588\\u058B-\\u058E\\u0590\\u05C8-\\u05CF\\u05EB-\\u05EF\\u05F5-\\u0605\\u061C\\u061D\\u06DD\\u070E\\u070F\\u074B\\u074C\\u07B2-\\u07BF\\u07FB-\\u07FF\\u082E\\u082F\\u083F\\u085C\\u085D\\u085F-\\u089F\\u08A1\\u08AD-\\u08E3\\u08FF\\u0978\\u0980\\u0984\\u098D\\u098E\\u0991\\u0992\\u09A9\\u09B1\\u09B3-\\u09B5\\u09BA\\u09BB\\u09C5\\u09C6\\u09C9\\u09CA\\u09CF-\\u09D6\\u09D8-\\u09DB\\u09DE\\u09E4\\u09E5\\u09FC-\\u0A00\\u0A04\\u0A0B-\\u0A0E\\u0A11\\u0A12\\u0A29\\u0A31\\u0A34\\u0A37\\u0A3A\\u0A3B\\u0A3D\\u0A43-\\u0A46\\u0A49\\u0A4A\\u0A4E-\\u0A50\\u0A52-\\u0A58\\u0A5D\\u0A5F-\\u0A65\\u0A76-\\u0A80\\u0A84\\u0A8E\\u0A92\\u0AA9\\u0AB1\\u0AB4\\u0ABA\\u0ABB\\u0AC6\\u0ACA\\u0ACE\\u0ACF\\u0AD1-\\u0ADF\\u0AE4\\u0AE5\\u0AF2-\\u0B00\\u0B04\\u0B0D\\u0B0E\\u0B11\\u0B12\\u0B29\\u0B31\\u0B34\\u0B3A\\u0B3B\\u0B45\\u0B46\\u0B49\\u0B4A\\u0B4E-\\u0B55\\u0B58-\\u0B5B\\u0B5E\\u0B64\\u0B65\\u0B78-\\u0B81\\u0B84\\u0B8B-\\u0B8D\\u0B91\\u0B96-\\u0B98\\u0B9B\\u0B9D\\u0BA0-\\u0BA2\\u0BA5-\\u0BA7\\u0BAB-\\u0BAD\\u0BBA-\\u0BBD\\u0BC3-\\u0BC5\\u0BC9\\u0BCE\\u0BCF\\u0BD1-\\u0BD6\\u0BD8-\\u0BE5\\u0BFB-\\u0C00\\u0C04\\u0C0D\\u0C11\\u0C29\\u0C34\\u0C3A-\\u0C3C\\u0C45\\u0C49\\u0C4E-\\u0C54\\u0C57\\u0C5A-\\u0C5F\\u0C64\\u0C65\\u0C70-\\u0C77\\u0C80\\u0C81\\u0C84\\u0C8D\\u0C91\\u0CA9\\u0CB4\\u0CBA\\u0CBB\\u0CC5\\u0CC9\\u0CCE-\\u0CD4\\u0CD7-\\u0CDD\\u0CDF\\u0CE4\\u0CE5\\u0CF0\\u0CF3-\\u0D01\\u0D04\\u0D0D\\u0D11\\u0D3B\\u0D3C\\u0D45\\u0D49\\u0D4F-\\u0D56\\u0D58-\\u0D5F\\u0D64\\u0D65\\u0D76-\\u0D78\\u0D80\\u0D81\\u0D84\\u0D97-\\u0D99\\u0DB2\\u0DBC\\u0DBE\\u0DBF\\u0DC7-\\u0DC9\\u0DCB-\\u0DCE\\u0DD5\\u0DD7\\u0DE0-\\u0DF1\\u0DF5-\\u0E00\\u0E3B-\\u0E3E\\u0E5C-\\u0E80\\u0E83\\u0E85\\u0E86\\u0E89\\u0E8B\\u0E8C\\u0E8E-\\u0E93\\u0E98\\u0EA0\\u0EA4\\u0EA6\\u0EA8\\u0EA9\\u0EAC\\u0EBA\\u0EBE\\u0EBF\\u0EC5\\u0EC7\\u0ECE\\u0ECF\\u0EDA\\u0EDB\\u0EE0-\\u0EFF\\u0F48\\u0F6D-\\u0F70\\u0F98\\u0FBD\\u0FCD\\u0FDB-\\u0FFF\\u10C6\\u10C8-\\u10CC\\u10CE\\u10CF\\u1249\\u124E\\u124F\\u1257\\u1259\\u125E\\u125F\\u1289\\u128E\\u128F\\u12B1\\u12B6\\u12B7\\u12BF\\u12C1\\u12C6\\u12C7\\u12D7\\u1311\\u1316\\u1317\\u135B\\u135C\\u137D-\\u137F\\u139A-\\u139F\\u13F5-\\u13FF\\u169D-\\u169F\\u16F1-\\u16FF\\u170D\\u1715-\\u171F\\u1737-\\u173F\\u1754-\\u175F\\u176D\\u1771\\u1774-\\u177F\\u17DE\\u17DF\\u17EA-\\u17EF\\u17FA-\\u17FF\\u180F\\u181A-\\u181F\\u1878-\\u187F\\u18AB-\\u18AF\\u18F6-\\u18FF\\u191D-\\u191F\\u192C-\\u192F\\u193C-\\u193F\\u1941-\\u1943\\u196E\\u196F\\u1975-\\u197F\\u19AC-\\u19AF\\u19CA-\\u19CF\\u19DB-\\u19DD\\u1A1C\\u1A1D\\u1A5F\\u1A7D\\u1A7E\\u1A8A-\\u1A8F\\u1A9A-\\u1A9F\\u1AAE-\\u1AFF\\u1B4C-\\u1B4F\\u1B7D-\\u1B7F\\u1BF4-\\u1BFB\\u1C38-\\u1C3A\\u1C4A-\\u1C4C\\u1C80-\\u1CBF\\u1CC8-\\u1CCF\\u1CF7-\\u1CFF\\u1DE7-\\u1DFB\\u1F16\\u1F17\\u1F1E\\u1F1F\\u1F46\\u1F47\\u1F4E\\u1F4F\\u1F58\\u1F5A\\u1F5C\\u1F5E\\u1F7E\\u1F7F\\u1FB5\\u1FC5\\u1FD4\\u1FD5\\u1FDC\\u1FF0\\u1FF1\\u1FF5\\u1FFF\\u200B-\\u200F\\u202A-\\u202E\\u2060-\\u206F\\u2072\\u2073\\u208F\\u209D-\\u209F\\u20BB-\\u20CF\\u20F1-\\u20FF\\u218A-\\u218F\\u23F4-\\u23FF\\u2427-\\u243F\\u244B-\\u245F\\u2700\\u2B4D-\\u2B4F\\u2B5A-\\u2BFF\\u2C2F\\u2C5F\\u2CF4-\\u2CF8\\u2D26\\u2D28-\\u2D2C\\u2D2E\\u2D2F\\u2D68-\\u2D6E\\u2D71-\\u2D7E\\u2D97-\\u2D9F\\u2DA7\\u2DAF\\u2DB7\\u2DBF\\u2DC7\\u2DCF\\u2DD7\\u2DDF\\u2E3C-\\u2E7F\\u2E9A\\u2EF4-\\u2EFF\\u2FD6-\\u2FEF\\u2FFC-\\u2FFF\\u3040\\u3097\\u3098\\u3100-\\u3104\\u312E-\\u3130\\u318F\\u31BB-\\u31BF\\u31E4-\\u31EF\\u321F\\u32FF\\u4DB6-\\u4DBF\\u9FCD-\\u9FFF\\uA48D-\\uA48F\\uA4C7-\\uA4CF\\uA62C-\\uA63F\\uA698-\\uA69E\\uA6F8-\\uA6FF\\uA78F\\uA794-\\uA79F\\uA7AB-\\uA7F7\\uA82C-\\uA82F\\uA83A-\\uA83F\\uA878-\\uA87F\\uA8C5-\\uA8CD\\uA8DA-\\uA8DF\\uA8FC-\\uA8FF\\uA954-\\uA95E\\uA97D-\\uA97F\\uA9CE\\uA9DA-\\uA9DD\\uA9E0-\\uA9FF\\uAA37-\\uAA3F\\uAA4E\\uAA4F\\uAA5A\\uAA5B\\uAA7C-\\uAA7F\\uAAC3-\\uAADA\\uAAF7-\\uAB00\\uAB07\\uAB08\\uAB0F\\uAB10\\uAB17-\\uAB1F\\uAB27\\uAB2F-\\uABBF\\uABEE\\uABEF\\uABFA-\\uABFF\\uD7A4-\\uD7AF\\uD7C7-\\uD7CA\\uD7FC-\\uF8FF\\uFA6E\\uFA6F\\uFADA-\\uFAFF\\uFB07-\\uFB12\\uFB18-\\uFB1C\\uFB37\\uFB3D\\uFB3F\\uFB42\\uFB45\\uFBC2-\\uFBD2\\uFD40-\\uFD4F\\uFD90\\uFD91\\uFDC8-\\uFDEF\\uFDFE\\uFDFF\\uFE1A-\\uFE1F\\uFE27-\\uFE2F\\uFE53\\uFE67\\uFE6C-\\uFE6F\\uFE75\\uFEFD-\\uFF00\\uFFBF-\\uFFC1\\uFFC8\\uFFC9\\uFFD0\\uFFD1\\uFFD8\\uFFD9\\uFFDD-\\uFFDF\\uFFE7\\uFFEF-\\uFFFB\\uFFFE\\uFFFF]/g;\n        defineFunction(\"clean\", function (text) {\n          return text.replace(RX_NON_PRINTABLE, \"\");\n        }).args([[\"*text\", \"string\"]]);\n        defineFunction(\"code\", function (text) {\n          return text.charAt(0);\n        }).args([[\"*text\", \"string\"]]);\n        defineAlias(\"unichar\", \"char\");\n        defineAlias(\"unicode\", \"code\");\n        defineFunction(\"concatenate\", function (args) {\n          var out = \"\";\n\n          for (var i = 0; i < args.length; ++i) {\n            out += args[i];\n          }\n\n          return out;\n        }).args([[\"+\", [\"*text\", \"string\"]]]);\n        defineFunction(\"dollar\", function (number, decimals) {\n          var format = \"$#,##0DECIMALS;($#,##0DECIMALS)\";\n          var dec = \"\";\n          var denomitator = 1;\n\n          while (decimals-- > 0) {\n            dec += \"0\";\n          }\n\n          while (++decimals < 0) {\n            denomitator *= 10;\n          }\n\n          if (dec !== \"\") {\n            dec = \".\" + dec;\n          } else if (denomitator !== 1) {\n            number = Math.round(number / denomitator) * denomitator;\n          }\n\n          format = format.replace(/DECIMALS/g, dec);\n          return spreadsheet.formatting.text(number, format);\n        }).args([[\"*number\", \"number\"], [\"*decimals\", [\"or\", \"integer\", [\"null\", 2]]]]);\n        defineFunction(\"exact\", function (a, b) {\n          return a === b;\n        }).args([[\"*text1\", \"string\"], [\"*text2\", \"string\"]]);\n        defineFunction(\"find\", function (substring, string, start) {\n          var pos = string.indexOf(substring, start - 1);\n          return pos < 0 ? new CalcError(\"VALUE\") : pos + 1;\n        }).args([[\"*substring\", \"string\"], [\"*string\", \"string\"], [\"*start\", [\"or\", \"integer++\", [\"null\", 1]]]]);\n        defineFunction(\"fixed\", function (number, decimals, noCommas) {\n          var scale = Math.pow(10, decimals);\n          number = Math.round(number * scale) / scale;\n          var format = noCommas ? \"0\" : \"#,##0\";\n\n          if (decimals > 0) {\n            format += \".\";\n\n            while (decimals-- > 0) {\n              format += \"0\";\n            }\n          }\n\n          return spreadsheet.formatting.text(number, format);\n        }).args([[\"*number\", \"number\"], [\"*decimals\", [\"or\", \"integer\", [\"null\", 2]]], [\"*noCommas\", [\"or\", \"boolean\", [\"null\", false]]]]);\n        defineFunction(\"left\", function (text, length) {\n          return text.substr(0, length);\n        }).args([[\"*text\", \"string\"], [\"*length\", [\"or\", \"integer+\", [\"null\", 1]]]]);\n        defineFunction(\"right\", function (text, length) {\n          return text.substr(-length);\n        }).args([[\"*text\", \"string\"], [\"*length\", [\"or\", \"integer+\", [\"null\", 1]]]]);\n        defineFunction(\"len\", function (text) {\n          return text.length;\n        }).args([[\"*text\", \"string\"]]);\n        defineFunction(\"lower\", function (text) {\n          return text.toLowerCase();\n        }).args([[\"*text\", \"string\"]]);\n        defineFunction(\"upper\", function (text) {\n          return text.toUpperCase();\n        }).args([[\"*text\", \"string\"]]);\n        defineFunction(\"ltrim\", function (text) {\n          return text.replace(/^\\s+/, \"\");\n        }).args([[\"*text\", \"string\"]]);\n        defineFunction(\"rtrim\", function (text) {\n          return text.replace(/\\s+$/, \"\");\n        }).args([[\"*text\", \"string\"]]);\n        defineFunction(\"trim\", function (text) {\n          return text.replace(/^\\s+|\\s+$/, \"\");\n        }).args([[\"*text\", \"string\"]]);\n        defineFunction(\"mid\", function (text, start, length) {\n          return text.substr(start - 1, length);\n        }).args([[\"*text\", \"string\"], [\"*start\", \"integer++\"], [\"*length\", \"integer+\"]]);\n        defineFunction(\"proper\", function (text) {\n          return text.toLowerCase().replace(/\\b./g, function (s) {\n            return s.toUpperCase();\n          });\n        }).args([[\"*text\", \"string\"]]);\n        defineFunction(\"replace\", function (text, start, length, newText) {\n          return text.substr(0, --start) + newText + text.substr(start + length);\n        }).args([[\"*text\", \"string\"], [\"*start\", \"integer++\"], [\"*length\", \"integer+\"], [\"*newText\", \"string\"]]);\n        defineFunction(\"rept\", function (text, number) {\n          var out = \"\";\n\n          while (number-- > 0) {\n            out += text;\n          }\n\n          return out;\n        }).args([[\"*text\", \"string\"], [\"*number\", \"integer+\"]]);\n        defineFunction(\"search\", function (substring, string, start) {\n          var pos = string.toLowerCase().indexOf(substring.toLowerCase(), start - 1);\n          return pos < 0 ? new CalcError(\"VALUE\") : pos + 1;\n        }).args([[\"*substring\", \"string\"], [\"*string\", \"string\"], [\"*start\", [\"or\", \"integer++\", [\"null\", 1]]]]);\n        defineFunction(\"substitute\", function (text, oldText, newText, nth) {\n          if (oldText === newText) {\n            return text;\n          }\n\n          var a = text.split(oldText);\n\n          if (nth == null) {\n            return a.join(newText);\n          }\n\n          text = \"\";\n          nth--;\n\n          for (var i = 0; i < a.length; ++i) {\n            text += a[i];\n\n            if (i < a.length - 1) {\n              if (i === nth) {\n                text += newText;\n              } else {\n                text += oldText;\n              }\n            }\n          }\n\n          return text;\n        }).args([[\"*text\", \"string\"], [\"*oldText\", \"string\"], [\"*newText\", \"string\"], [\"*nth\", [\"or\", \"integer++\", \"null\"]]]);\n        defineFunction(\"t\", function (value) {\n          return typeof value == \"string\" ? value : \"\";\n        }).args([[\"*value\", \"anyvalue\"]]);\n        defineFunction(\"text\", function (value, format) {\n          return spreadsheet.formatting.text(value, format);\n        }).args([[\"*value\", \"anyvalue\"], [\"*format\", \"string\"]]);\n        defineFunction(\"value\", function (value) {\n          if (typeof value == \"number\") {\n            return value;\n          }\n\n          if (typeof value == \"boolean\") {\n            return +value;\n          } // XXX: this is dirty.  we need it so we can parse i.e. \"$12,345.50\"\n\n\n          value = (value + \"\").replace(/[$€,]/g, \"\");\n          value = parseFloat(value);\n          return isNaN(value) ? new CalcError(\"VALUE\") : value;\n        }).args([[\"*value\", \"anyvalue\"]]);\n\n        function Hyperlink(link, text) {\n          this.link = link;\n          this.text = text;\n        }\n\n        Hyperlink.prototype.toString = function () {\n          return this.text;\n        };\n\n        defineFunction(\"hyperlink\", function (link, text) {\n          return new Hyperlink(link, text);\n        }).args([[\"*link\", \"string\"], [\"*text\", [\"or\", \"string\", [\"null\", \"$link\"]]]]); //// other misc functions\n\n        defineFunction(\"iferror\", function (value, valueIfError) {\n          return value instanceof CalcError ? valueIfError : value;\n        }).args([[\"*value\", \"forced!\"], [\"*value_if_error\", \"anyvalue!\"]]); //// utils\n\n        var parseCriteria = function () {\n          var RXCACHE = Object.create(null);\n\n          function makeComparator(cmp, x) {\n            if (typeof x == \"string\") {\n              var num = parseFloat(x);\n\n              if (!isNaN(num) && num == x) {\n                x = num;\n              }\n            }\n\n            return function (a) {\n              var b = x;\n\n              if (typeof a == \"string\" && typeof b == \"string\") {\n                a = a.toLowerCase();\n                b = b.toLowerCase();\n              }\n\n              return cmp(a, b);\n            };\n          }\n\n          function lc(a) {\n            var num, str;\n\n            if (typeof a == \"string\") {\n              a = a.toLowerCase();\n            }\n\n            if (/^[0-9.]+%$/.test(a)) {\n              str = a.substr(0, a.length - 1);\n              num = parseFloat(str);\n\n              if (!isNaN(num) && num == str) {\n                a = num / 100;\n              }\n            } else if (/^[0-9.]+$/.test(a)) {\n              num = parseFloat(a);\n\n              if (!isNaN(num) && num == a) {\n                a = num;\n              }\n            }\n\n            return a;\n          }\n\n          function compLT(a, b) {\n            return lc(a) < lc(b);\n          }\n\n          function compLTE(a, b) {\n            return lc(a) <= lc(b);\n          }\n\n          function compGT(a, b) {\n            return lc(a) > lc(b);\n          }\n\n          function compGTE(a, b) {\n            return lc(a) >= lc(b);\n          }\n\n          function compNE(a, b) {\n            return !compEQ(a, b);\n          }\n\n          function compEQ(a, b) {\n            if (b instanceof RegExp) {\n              return b.test(a);\n            }\n\n            if (typeof a == \"string\" || typeof b == \"string\") {\n              // if either one is string, make sure both are strings\n              a = String(a);\n              b = String(b);\n            }\n\n            return lc(a) == lc(b);\n          }\n\n          return function (cmp) {\n            if (typeof cmp == \"function\") {\n              return cmp;\n            }\n\n            var m;\n\n            if (m = /^=(.*)$/.exec(cmp)) {\n              return makeComparator(compEQ, m[1]);\n            }\n\n            if (m = /^<>(.*)$/.exec(cmp)) {\n              return makeComparator(compNE, m[1]);\n            }\n\n            if (m = /^<=(.*)$/.exec(cmp)) {\n              return makeComparator(compLTE, m[1]);\n            }\n\n            if (m = /^<(.*)$/.exec(cmp)) {\n              return makeComparator(compLT, m[1]);\n            }\n\n            if (m = /^>=(.*)$/.exec(cmp)) {\n              return makeComparator(compGTE, m[1]);\n            }\n\n            if (m = /^>(.*)$/.exec(cmp)) {\n              return makeComparator(compGT, m[1]);\n            }\n\n            if (/[?*]/.exec(cmp)) {\n              // has wildchars\n              var rx = RXCACHE[cmp];\n\n              if (!rx) {\n                rx = cmp.replace(/(~\\?|~\\*|[\\]({\\+\\.\\|\\^\\$\\\\})\\[]|[?*])/g, function (s) {\n                  switch (s) {\n                    case \"~?\":\n                      return \"\\\\?\";\n\n                    case \"~*\":\n                      return \"\\\\*\";\n\n                    case \"?\":\n                      return \".\";\n\n                    case \"*\":\n                      return \".*\";\n\n                    default:\n                      return \"\\\\\" + s;\n                  }\n                });\n                rx = RXCACHE[cmp] = new RegExp(\"^\" + rx + \"$\", \"i\");\n              }\n\n              return makeComparator(compEQ, rx);\n            }\n\n            return makeComparator(compEQ, cmp);\n          };\n        }();\n\n        function numericPredicate(val) {\n          return typeof val == \"number\" || typeof val == \"boolean\" || val == null || val === \"\";\n        }\n\n        function ascending(a, b) {\n          return a === b ? 0 : a < b ? -1 : 1;\n        }\n\n        function descending(a, b) {\n          return a === b ? 0 : a < b ? 1 : -1;\n        } // var m = new Matrix();\n        // m.data = [[1, 2, 3], [4, 1, 6], [7, 8, 9]];\n        // //m.data = [[0, 2, 1], [2, 6, 1], [1, 1, 4]];\n        // //m.data = [[1,4,1,1], [1,4,0,1], [2,3,1,2], [3,2,6,4]];\n        // m.width = m.height = 3;\n        // var x = m.inverse();\n        // x.dump();\n\n      }, __webpack_require__.amdD);\n      /***/\n\n    },\n\n    /***/\n    67539:\n    /***/\n    function (module) {\n      \"use strict\";\n\n      module.exports = require(\"../util/main\");\n      /***/\n    },\n\n    /***/\n    22360:\n    /***/\n    function (module) {\n      \"use strict\";\n\n      module.exports = require(\"./runtime\");\n      /***/\n    }\n    /******/\n\n  };\n  /************************************************************************/\n\n  /******/\n  // The module cache\n\n  /******/\n\n  var __webpack_module_cache__ = {};\n  /******/\n\n  /******/\n  // The require function\n\n  /******/\n\n  function __webpack_require__(moduleId) {\n    /******/\n    // Check if module is in cache\n\n    /******/\n    var cachedModule = __webpack_module_cache__[moduleId];\n    /******/\n\n    if (cachedModule !== undefined) {\n      /******/\n      return cachedModule.exports;\n      /******/\n    }\n    /******/\n    // Create a new module (and put it into the cache)\n\n    /******/\n\n\n    var module = __webpack_module_cache__[moduleId] = {\n      /******/\n      // no module.id needed\n\n      /******/\n      // no module.loaded needed\n\n      /******/\n      exports: {}\n      /******/\n\n    };\n    /******/\n\n    /******/\n    // Execute the module function\n\n    /******/\n\n    __webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n    /******/\n\n    /******/\n    // Return the exports of the module\n\n    /******/\n\n\n    return module.exports;\n    /******/\n  }\n  /******/\n\n  /************************************************************************/\n\n  /******/\n\n  /* webpack/runtime/amd define */\n\n  /******/\n\n\n  !function () {\n    /******/\n    __webpack_require__.amdD = function () {\n      /******/\n      throw new Error('define cannot be used indirect');\n      /******/\n    };\n    /******/\n\n  }();\n  /******/\n\n  /************************************************************************/\n\n  /******/\n\n  /******/\n  // startup\n\n  /******/\n  // Load entry module and return exports\n\n  /******/\n  // This entry module used 'module' so it can't be inlined\n\n  /******/\n\n  var __webpack_exports__ = __webpack_require__(53942);\n  /******/\n\n\n  module.exports = __webpack_exports__;\n  /******/\n\n  /******/\n})();","map":{"version":3,"names":["__webpack_modules__","module","exports","__webpack_require__","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","f","define","apply","undefined","util","kendo","spreadsheet","calc","runtime","defineFunction","defineAlias","CalcError","RangeRef","CellRef","UnionRef","Matrix","Ref","NameRef","daysInMonth","packDate","unpackDate","daysInYear","limitPrecision","forEach","name","Math","args","log","num","base","PI","n","sqrt","rad","deg","_cosh","exp","_sinh","cos","sin","x","y","atan","_tanh","tan","a","b","pow","floor","s","ceil","abs","mode","mult","round","digits","sign","_gcd","r","_lcm","i","length","numbers","reduce","sum","prod","first","rest","each","p","row","col","v","get","m","coef","min","max","values","count","seen","val","indexOf","push","add","loop","forIFS","chunks","matrix","pred","parseCriteria","ROW","height","COL","width","ARGS_COUNTIFS","m1","c1","unshift","ARGS_SUMIFS","concat","range","numericPredicate","criteria","ARGS_SUMIF","fetchSumRange","continuation","callback","sumRange","self","clone","toRangeRef","isFinite","topLeft","bottomRight","resolveCells","asMatrix","argsAsync","def","nth","sort","descending","ascending","handler","error","_avg","_var_sp","divisor","avg","_stdev_sp","prev","Object","create","res","set","discard","data","bins","Infinity","asc","pos","variance","stddev","_percentrank","exc","nlt","ngt","left","right","found","ARGS_PERCENTRANK","significance","toFixed","parseFloat","substr","_covariance","ax","ay","_fact","memoize","fact","div","_combinations","k","f1","f2","p1","p2","_percentile","rank","d","_percentile_inc","_percentile_exc","quarter","AGGREGATE_FUNCS","fetchValuesForAggregate","options","opt_ignore_hidden_rows","opt_ignore_errors","opt_use_aggregates","fetchValues","getRefCells","cell","value","hidden","formula","str","print","test","Array","isArray","funcId","getRefData","func","ignoreHidden","arguments","_binom_dist","cumulative","j","alpha","s2","a1","sheet","setSheet","ref","refs","index","mapCol","approx","resultCol","eachCol","areanum","toCell","colRange","toColumn","rowRange","toRow","mapRow","thing","parseFormula","ast","ss","nameValue","absolute","ex","type","cmp","el","rows","cols","hasSheet","resultRow","toLowerCase","eachRow","year","month","date","day","fw","sy","diff","weeksInYear","isLeapYear","isoweeknum","dow","wk","ord","dateToSerial","Date","hh","mm","packTime","time","unpackTime","hours","minutes","seconds","months","holidays","inc","end","tmp","start","_days_360","method","d1","d2","text","parseDate","match","ampm","determinant","transpose","multiply","unit","inverse","random","arabicToRoman","toUpperCase","rom","romanToArabic","number","radix","minLen","toString","charCodeAt","code","String","fromCharCode","RX_NON_PRINTABLE","replace","charAt","out","decimals","format","dec","denomitator","formatting","substring","string","noCommas","scale","newText","oldText","split","join","isNaN","Hyperlink","link","prototype","valueIfError","RXCACHE","makeComparator","lc","compLT","compLTE","compGT","compGTE","compNE","compEQ","RegExp","exec","rx","amdD","require","__webpack_module_cache__","moduleId","cachedModule","Error","__webpack_exports__"],"sources":["C:/Users/abodean/restapi-nodejs/vuejs/app-router/node_modules/@progress/kendo-ui/js/spreadsheet/runtime.functions.js"],"sourcesContent":["/******/ (function() { // webpackBootstrap\n/******/ \tvar __webpack_modules__ = ({\n\n/***/ 53942:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;// -*- fill-column: 100 -*-\n\n(function(f, define){\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [ __webpack_require__(22360), __webpack_require__(67539) ], __WEBPACK_AMD_DEFINE_FACTORY__ = (f),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n})(function(){\n    \"use strict\";\n\n    // WARNING: removing the following jshint declaration and turning\n    // == into === to make JSHint happy will break functionality.\n\n\n\n    var util = kendo.util;\n    var spreadsheet = kendo.spreadsheet;\n    var calc = spreadsheet.calc;\n    var runtime = calc.runtime;\n    var defineFunction = runtime.defineFunction;\n    var defineAlias = runtime.defineAlias;\n    var CalcError = runtime.CalcError;\n    var RangeRef = spreadsheet.RangeRef;\n    var CellRef = spreadsheet.CellRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var Matrix = runtime.Matrix;\n    var Ref = spreadsheet.Ref;\n    var NameRef = spreadsheet.NameRef;\n    var daysInMonth = runtime.daysInMonth;\n    var packDate = runtime.packDate;\n    var unpackDate = runtime.unpackDate;\n    var daysInYear = runtime.daysInYear;\n    var limitPrecision = runtime.limitPrecision;\n\n    /* -----[ Math functions ]----- */\n\n    [ \"abs\", \"cos\", \"sin\", \"acos\", \"asin\", \"tan\", \"atan\", \"exp\", \"sqrt\" ].forEach(function(name){\n        defineFunction(name, Math[name]).args([\n            [ \"*n\", \"number\" ]\n        ]);\n    });\n\n    defineFunction(\"ln\", Math.log).args([\n        [ \"*n\", \"number\" ]\n    ]);\n\n    defineFunction(\"log\", function(num, base){\n        return Math.log(num) / Math.log(base);\n    }).args([\n        [ \"*num\", \"number++\" ],\n        [ \"*base\", [ \"or\", \"number++\", [ \"null\", 10 ] ] ],\n        [ \"?\", [ \"assert\", \"$base != 1\", \"DIV/0\" ] ]\n    ]);\n\n    defineFunction(\"log10\", function(num){\n        return Math.log(num) / Math.log(10);\n    }).args([\n        [ \"*num\", \"number++\" ]\n    ]);\n\n    defineFunction(\"pi\", function(){\n        return Math.PI;\n    }).args([]);\n\n    defineFunction(\"sqrtpi\", function(n){\n        return Math.sqrt(n * Math.PI);\n    }).args([\n        [ \"*num\", \"number+\" ]\n    ]);\n\n    defineFunction(\"degrees\", function(rad){\n        return ((180 * rad) / Math.PI) % 360;\n    }).args([\n        [ \"*radians\", \"number\" ]\n    ]);\n\n    defineFunction(\"radians\", function(deg){\n        return Math.PI * deg / 180;\n    }).args([\n        [ \"*degrees\", \"number\" ]\n    ]);\n\n    function _cosh(n){\n        return (Math.exp(n) + Math.exp(-n)) / 2;\n    }\n\n    defineFunction(\"cosh\", _cosh).args([\n        [ \"*num\", \"number\" ]\n    ]);\n\n    defineFunction(\"acosh\", function(n){\n        return Math.log(n + Math.sqrt(n - 1) * Math.sqrt(n + 1));\n    }).args([\n        [ \"*num\", \"number\" ],\n        [ \"?\", [ \"assert\", \"$num >= 1\" ] ]\n    ]);\n\n    function _sinh(n){\n        return (Math.exp(n) - Math.exp(-n)) / 2;\n    }\n\n    defineFunction(\"sinh\", _sinh).args([\n        [ \"*num\", \"number\" ]\n    ]);\n\n    defineFunction(\"asinh\", function(n){\n        return Math.log(n + Math.sqrt(n * n + 1));\n    }).args([\n        [ \"*num\", \"number\" ]\n    ]);\n\n    defineFunction(\"sec\", function(n){\n        return 1 / Math.cos(n);\n    }).args([\n        [ \"*num\", \"number\" ]\n    ]);\n\n    defineFunction(\"sech\", function(n){\n        return 1 / _cosh(n);\n    }).args([\n        [ \"*num\", \"number\" ]\n    ]);\n\n    defineFunction(\"csc\", function(n){\n        return 1 / Math.sin(n);\n    }).args([\n        [ \"*num\", \"number\" ]\n    ]);\n\n    defineFunction(\"csch\", function(n){\n        return 1 / _sinh(n);\n    }).args([\n        [ \"*num\", \"number\" ]\n    ]);\n\n    defineFunction(\"atan2\", function(x, y){\n        return Math.atan(y / x);\n    }).args([\n        [ \"*x\", \"divisor\" ],\n        [ \"*y\", \"number\" ]\n    ]);\n\n    function _tanh(n) {\n        return _sinh(n) / _cosh(n);\n    }\n\n    defineFunction(\"tanh\", _tanh).args([\n        [ \"*num\", \"number\" ]\n    ]);\n\n    defineFunction(\"atanh\", function(n){\n        return Math.log(Math.sqrt(1 - n*n) / (1 - n));\n    }).args([\n        [ \"*num\", [ \"and\", \"number\", [ \"(between)\", -1, 1 ] ] ]\n    ]);\n\n    defineFunction(\"cot\", function(n){\n        return 1 / Math.tan(n);\n    }).args([\n        [ \"*num\", \"divisor\" ]\n    ]);\n\n    defineFunction(\"coth\", function(n){\n        return 1 / _tanh(n);\n    }).args([\n        [ \"*num\", \"divisor\" ]\n    ]);\n\n    defineFunction(\"acot\", function(n){\n        return Math.PI / 2 - Math.atan(n);\n    }).args([\n        [ \"*num\", \"number\" ]\n    ]);\n\n    defineFunction(\"acoth\", function(n){\n        return Math.log((n + 1) / (n - 1)) / 2;\n    }).args([\n        [ \"*num\", \"number\" ],\n        [ \"?\", [ \"or\",\n                 [ \"assert\", \"$num < -1\"],\n                 [ \"assert\", \"$num > 1\" ] ] ]\n    ]);\n\n    defineFunction(\"power\", function(a, b){\n        return Math.pow(a, b);\n    }).args([\n        [ \"*a\", \"number\" ],\n        [ \"*b\", \"number\" ]\n    ]);\n\n    defineFunction(\"mod\", function(a, b){\n        return a % b;\n    }).args([\n        [ \"*a\", \"number\" ],\n        [ \"*b\", \"divisor\" ]\n    ]);\n\n    defineFunction(\"quotient\", function(a, b){\n        return Math.floor(a / b);\n    }).args([\n        [ \"*a\", \"number\" ],\n        [ \"*b\", \"divisor\" ]\n    ]);\n\n    defineFunction(\"ceiling\", function(num, s){\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [ \"*number\", \"number\" ],\n        [ \"*significance\", \"number\" ],\n        [ \"?\", [ \"assert\", \"$significance >= 0 || $number < 0\" ] ]\n    ]);\n\n    defineFunction(\"ceiling.precise\", function(num, s){\n        s = Math.abs(s);\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [ \"*number\", \"number\" ],\n        [ \"*significance\", [ \"or\", \"number\", [ \"null\", 1 ] ] ]\n    ]);\n\n    defineAlias(\"iso.ceiling\", \"ceiling.precise\");\n\n    // XXX: how do we know if this function is correct?\n    //\n    // https://support.office.com/en-gb/article/CEILING-MATH-function-80f95d2f-b499-4eee-9f16-f795a8e306c8\n    //\n    // “There are many combinations of Significance and Mode values that affect rounding of negative\n    // numbers in different ways.” — right, thanks for the info. :-\\\n    defineFunction(\"ceiling.math\", function(num, s, mode){\n        if (!s || !num) {\n            return 0;\n        }\n        if (num < 0 && ((!mode && s < 0) || (mode && s > 0))) {\n            s = -s;\n        }\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [ \"*number\", \"number\" ],\n        [ \"*significance\", [ \"or\", \"number\", [ \"null\", \"$number < 0 ? -1 : 1\" ] ] ],\n        [ \"*mode\", [ \"or\", \"logical\", [ \"null\", 0 ] ] ]\n    ]);\n\n    defineFunction(\"floor\", function(num, s){\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [ \"*number\", \"number\" ],\n        [ \"*significance\", \"number\" ],\n        [ \"?\", [ \"assert\", \"$significance >= 0 || $number < 0\" ] ]\n    ]);\n\n    defineFunction(\"floor.precise\", function(num, s){\n        s = Math.abs(s);\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [ \"*number\", \"number\" ],\n        [ \"*significance\", [ \"or\", \"number\", [ \"null\", 1 ] ] ]\n    ]);\n\n    // XXX: check this\n    defineFunction(\"floor.math\", function(num, s, mode){\n        if (!s || !num) {\n            return 0;\n        }\n        if (num < 0 && ((!mode && s < 0) || (mode && s > 0))) {\n            s = -s;\n        }\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [ \"*number\", \"number\" ],\n        [ \"*significance\", [ \"or\", \"number\", [ \"null\", \"$number < 0 ? -1 : 1\" ] ] ],\n        [ \"*mode\", [ \"or\", \"logical\", [ \"null\", 0 ] ] ]\n    ]);\n\n    defineFunction(\"int\", Math.floor).args([\n        [ \"*number\", \"number\" ]\n    ]);\n\n    defineFunction(\"mround\", function(num, mult){\n        return mult ? mult * Math.round(num / mult) : 0;\n    }).args([\n        [ \"*number\", \"number\" ],\n        [ \"*multiple\", \"number\" ]\n    ]);\n\n    defineFunction(\"round\", function(num, digits){\n        var sign = num < 0 ? -1 : 1;\n        if (sign < 0) { num = -num; }\n        digits = Math.pow(10, digits);\n        num = limitPrecision(num * digits);\n        num = Math.round(num);\n        return sign * num / digits;\n    }).args([\n        [ \"*number\", \"number\" ],\n        [ \"*digits\", \"number\" ]\n    ]);\n\n    defineFunction(\"roundup\", function(num, digits){\n        digits = Math.pow(10, digits);\n        num = limitPrecision(num * digits);\n        num = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return num / digits;\n    }).args([\n        [ \"*number\", \"number\" ],\n        [ \"*digits\", \"number\" ]\n    ]);\n\n    defineFunction(\"rounddown\", function(num, digits){\n        digits = Math.pow(10, digits);\n        num = limitPrecision(num * digits);\n        num = num < 0 ? Math.ceil(num) : Math.floor(num);\n        return num / digits;\n    }).args([\n        [ \"*number\", \"number\" ],\n        [ \"*digits\", \"number\" ]\n    ]);\n\n    defineFunction(\"even\", function(num){\n        var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return n % 2 ? n + (n < 0 ? -1 : 1) : n;\n    }).args([\n        [ \"*number\", \"number\" ]\n    ]);\n\n    defineFunction(\"odd\", function(num){\n        var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return n % 2 ? n : n + (n < 0 ? -1 : 1);\n    }).args([\n        [ \"*number\", \"number\" ]\n    ]);\n\n    defineFunction(\"sign\", function(num){\n        return num < 0 ? -1 : num > 0 ? 1 : 0;\n    }).args([\n        [ \"*number\", \"number\" ]\n    ]);\n\n    function _gcd(a, b) {\n        while (b) {\n            var r = a % b;\n            a = b;\n            b = r;\n        }\n        return a;\n    }\n\n    function _lcm(a, b) {\n        return Math.abs(a * b) / _gcd(a, b);\n    }\n\n    defineFunction(\"gcd\", function(args){\n        var a = args[0];\n        for (var i = 1; i < args.length; ++i) {\n            a = _gcd(a, args[i]);\n        }\n        return a;\n    }).args([\n        [ \"numbers\", [ \"collect\", \"number\" ] ]\n    ]);\n\n    defineFunction(\"lcm\", function(args){\n        var a = args[0];\n        for (var i = 1; i < args.length; ++i) {\n            a = _lcm(a, args[i]);\n        }\n        return a;\n    }).args([\n        [ \"numbers\", [ \"collect\", \"number\" ] ]\n    ]);\n\n    defineFunction(\"sum\", function(numbers){\n        return numbers.reduce(function(sum, num){\n            return sum + num;\n        }, 0);\n    }).args([\n        [ \"numbers\", [ \"collect\", \"number\" ] ]\n    ]);\n\n    defineFunction(\"product\", function(numbers){\n        return numbers.reduce(function(prod, num){\n            return prod * num;\n        }, 1);\n    }).args([\n        [ \"numbers\", [ \"collect\", \"number\" ] ]\n    ]);\n\n    defineFunction(\"sumproduct\", function(first, rest) {\n        var sum = 0;\n        first.each(function(p, row, col){\n            if (typeof p == \"number\") {\n                for (var i = 0; i < rest.length; ++i) {\n                    var v = rest[i].get(row, col);\n                    if (typeof v != \"number\") {\n                        return;\n                    }\n                    p *= v;\n                }\n                sum += p;\n            }\n        });\n        return sum;\n    }).args([\n        [ \"a1\", \"matrix\" ],\n        [ \"+\",\n          [ \"a2\", [ \"and\", \"matrix\",\n                    [ \"assert\", \"$a2.width == $a1.width\" ],\n                    [ \"assert\", \"$a2.height == $a1.height\" ] ] ] ]\n    ]);\n\n    defineFunction(\"sumsq\", function(numbers){\n        return numbers.reduce(function(sum, num){\n            return sum + num * num;\n        }, 0);\n    }).args([\n        [ \"numbers\", [ \"collect\", \"number\" ] ]\n    ]);\n\n    defineFunction(\"sumx2my2\", function(a, b){\n        var sum = 0;\n        a.each(function(x, row, col){\n            var y = b.get(row, col);\n            if (typeof x == \"number\" && typeof y == \"number\") {\n                sum += x*x - y*y;\n            }\n        });\n        return sum;\n    }).args([\n        [ \"a\", \"matrix\" ],\n        [ \"b\", [ \"and\", \"matrix\",\n                 [ \"assert\", \"$b.width == $a.width\" ],\n                 [ \"assert\", \"$b.height == $a.height\" ] ] ]\n    ]);\n\n    defineFunction(\"sumx2py2\", function(a, b){\n        var sum = 0;\n        a.each(function(x, row, col){\n            var y = b.get(row, col);\n            if (typeof x == \"number\" && typeof y == \"number\") {\n                sum += x*x + y*y;\n            }\n        });\n        return sum;\n    }).args([\n        [ \"a\", \"matrix\" ],\n        [ \"b\", [ \"and\", \"matrix\",\n                 [ \"assert\", \"$b.width == $a.width\" ],\n                 [ \"assert\", \"$b.height == $a.height\" ] ] ]\n    ]);\n\n    defineFunction(\"sumxmy2\", function(a, b){\n        var sum = 0;\n        a.each(function(x, row, col){\n            var y = b.get(row, col);\n            if (typeof x == \"number\" && typeof y == \"number\") {\n                sum += (x - y) * (x - y);\n            }\n        });\n        return sum;\n    }).args([\n        [ \"a\", \"matrix\" ],\n        [ \"b\", [ \"and\", \"matrix\",\n                 [ \"assert\", \"$b.width == $a.width\" ],\n                 [ \"assert\", \"$b.height == $a.height\" ] ] ]\n    ]);\n\n    defineFunction(\"seriessum\", function(x, n, m, a){\n        var sum = 0;\n        a.each(function(coef){\n            if (typeof coef != \"number\") {\n                throw new CalcError(\"VALUE\");\n            }\n            sum += coef * Math.pow(x, n);\n            n += m;\n        });\n        return sum;\n    }).args([\n        [ \"x\", \"number\" ],\n        [ \"y\", \"number\" ],\n        [ \"m\", \"number\" ],\n        [ \"a\", \"matrix\" ]\n    ]);\n\n    defineFunction(\"min\", function(numbers){\n        return numbers.length ? Math.min.apply(Math, numbers) : 0;\n    }).args([\n        [ \"numbers\", [ \"collect\", \"number!\" ] ]\n    ]);\n\n    defineFunction(\"max\", function(numbers){\n        return numbers.length ? Math.max.apply(Math, numbers) : 0;\n    }).args([\n        [ \"numbers\", [ \"collect\", \"number!\" ] ]\n    ]);\n\n    defineFunction(\"counta\", function(values){\n        return values.length;\n    }).args([\n        [ \"values\", [ \"#collect\", \"anyvalue\" ] ]\n    ]);\n\n    defineFunction(\"count\", function(numbers){\n        return numbers.length;\n    }).args([\n        [ \"numbers\", [ \"#collect\", \"number\" ] ]\n    ]);\n\n    defineFunction(\"countunique\", function(values){\n        var count = 0, seen = [];\n        values.forEach(function(val){\n            if (seen.indexOf(val) < 0) {\n                count++;\n                seen.push(val);\n            }\n        });\n        return count;\n    }).args([\n        [ \"values\", [ \"#collect\", \"anyvalue\" ] ]\n    ]);\n\n    defineFunction(\"countblank\", function(a){\n        var count = 0;\n        function add(val) {\n            if (val == null || val === \"\") {\n                count++;\n            }\n        }\n        function loop(args){\n            for (var i = 0; i < args.length; ++i) {\n                var x = args[i];\n                if (x instanceof Matrix) {\n                    x.each(add, true);\n                } else {\n                    add(x);\n                }\n            }\n        }\n        loop(a);\n        return count;\n    }).args([\n        [ \"+\", [ \"args\", [ \"or\", \"matrix\", \"anyvalue\" ] ] ]\n    ]);\n\n    defineFunction(\"iseven\", function(num){\n        return num % 2 === 0;\n    }).args([\n        [ \"*number\", \"number\" ]\n    ]);\n\n    defineFunction(\"isodd\", function(num){\n        return num % 2 !== 0;\n    }).args([\n        [ \"*number\", \"number\" ]\n    ]);\n\n    defineFunction(\"n\", function(val){\n        if (typeof val == \"boolean\") {\n            return val ? 1 : 0;\n        }\n        if (typeof val == \"number\") {\n            return val;\n        }\n        return 0;\n    }).args([\n        [ \"*value\", \"anyvalue\" ]\n    ]);\n\n    defineFunction(\"na\", function(){\n        return new CalcError(\"N/A\");\n    }).args([]);\n\n    /* -----[ the \"*IFS\" functions ]----- */\n\n    // helper function: take `args` like COUNTIFS (see Excel docs) and\n    // calls `f` for each cell matching all criteria.  `f` receives\n    // `chunks` (parsed args containing matrix and predicate) and\n    // row,col of matching cells.\n    function forIFS(args, f) {\n        var chunks = [], i = 0, matrix = args[0];\n        while (i < args.length) {\n            chunks.push({\n                matrix: args[i++],\n                pred: parseCriteria(args[i++])\n            });\n        }\n        ROW: for (var row = 0; row < matrix.height; ++row) {\n            COL: for (var col = 0; col < matrix.width; ++col) {\n                for (i = 0; i < chunks.length; ++i) {\n                    var val = chunks[i].matrix.get(row, col);\n                    if (!chunks[i].pred(val == null || val === \"\" ? 0 : val)) {\n                        continue COL;\n                    }\n                }\n                f(row, col);\n            }\n        }\n    }\n\n    var ARGS_COUNTIFS = [\n        [ \"m1\", \"matrix\" ],\n        [ \"c1\", \"anyvalue\" ],\n        [ [ \"m2\", \"matrix\" ],\n          [ \"c2\", \"anyvalue\" ] ]\n    ];\n\n    defineFunction(\"countifs\", function(m1, c1, rest){\n        var count = 0;\n        rest.unshift(m1, c1);\n        forIFS(rest, function(){ count++; });\n        return count;\n    }).args(ARGS_COUNTIFS);\n\n    var ARGS_SUMIFS = [\n        [ \"range\", \"matrix\" ]\n    ].concat(ARGS_COUNTIFS);\n\n    defineFunction(\"sumifs\", function(range, m1, c1, args){\n        // hack: insert a predicate that filters out non-numeric\n        // values; should also accept blank cells.  it's safe to\n        // modify args.\n        args.unshift(range, numericPredicate, m1, c1);\n        var sum = 0;\n        forIFS(args, function(row, col){\n            var val = range.get(row, col);\n            if (val) {\n                sum += val;\n            }\n        });\n        return sum;\n    }).args(ARGS_SUMIFS);\n\n    // similar to sumifs, but compute average of matching cells\n    defineFunction(\"averageifs\", function(range, m1, c1, args){\n        args.unshift(range, numericPredicate, m1, c1);\n        var sum = 0, count = 0;\n        forIFS(args, function(row, col){\n            var val = range.get(row, col);\n            if (val == null || val === \"\") {\n                val = 0;\n            }\n            sum += val;\n            count++;\n        });\n        return count ? sum / count : new CalcError(\"DIV/0\");\n    }).args(ARGS_SUMIFS);\n\n    defineFunction(\"countif\", function(matrix, criteria){\n        criteria = parseCriteria(criteria);\n        var count = 0;\n        matrix.each(function(val){\n            if (criteria(val)) {\n                count++;\n            }\n        });\n        return count;\n    }).args([\n        [ \"range\", \"matrix\" ],\n        [ \"*criteria\", \"anyvalue\" ]\n    ]);\n\n    var ARGS_SUMIF = [\n        [ \"range\", \"matrix\" ],\n        [ \"*criteria\", \"anyvalue\" ],\n        [ \"sumRange\", [ \"or\", \"area\", \"#matrix\", [ \"null\", \"$range\" ] ] ]\n    ];\n\n    function fetchSumRange(continuation) {\n        return function(callback, range, criteria, sumRange) {\n            var self = this;\n            if (sumRange instanceof Ref) {\n                // make sure it covers the same area as `range`, as the “spec” mentions:\n                //\n                //     The sum_range argument does not have to be the same size and shape as the\n                //     range argument. The actual cells that are added are determined by using the\n                //     upper leftmost cell in the sum_range argument as the beginning cell, and then\n                //     including cells that correspond in size and shape to the range argument.\n                //\n                // It does make one wonder, since only the top-left cell in `sumRange` matters, why\n                // should it be a range at all?  Oh well, Excel.\n                var r = sumRange.clone().toRangeRef();\n                if (r.width() != range.width || r.height() != range.height) {\n                    if (!isFinite(r.topLeft.row)) {\n                        r.topLeft.row = 0;\n                    }\n                    if (!isFinite(r.topLeft.col)) {\n                        r.topLeft.col = 0;\n                    }\n                    r.bottomRight.row = r.topLeft.row + range.height - 1;\n                    r.bottomRight.col = r.topLeft.col + range.width - 1;\n                    return self.resolveCells([ r ], function(){\n                        callback(continuation(range, criteria, self.asMatrix(r)));\n                    });\n                }\n            }\n            callback(continuation(range, criteria, self.asMatrix(sumRange)));\n        };\n    }\n\n    defineFunction(\"sumif\", fetchSumRange(function(range, criteria, sumRange){\n        var sum = 0;\n        criteria = parseCriteria(criteria);\n        range.each(function(val, row, col){\n            if (criteria(val)) {\n                var v = sumRange.get(row, col);\n                if (numericPredicate(v)) {\n                    sum += v || 0;\n                }\n            }\n        });\n        return sum;\n    })).argsAsync(ARGS_SUMIF);\n\n    defineFunction(\"averageif\", fetchSumRange(function(range, criteria, sumRange){\n        var sum = 0, count = 0;\n        criteria = parseCriteria(criteria);\n        range.each(function(val, row, col){\n            if (criteria(val)) {\n                var v = sumRange.get(row, col);\n                if (numericPredicate(v)) {\n                    sum += v || 0;\n                    count++;\n                }\n            }\n        });\n        return count ? sum / count : new CalcError(\"DIV/0\");\n    })).argsAsync(ARGS_SUMIF);\n\n    (function(def){\n        def(\"large\", function(numbers, nth){\n            return numbers.sort(descending)[nth];\n        });\n        def(\"small\", function(numbers, nth){\n            return numbers.sort(ascending)[nth];\n        });\n    })(function(name, handler){\n        defineFunction(name, function(matrix, nth){\n            var numbers = [];\n            var error = matrix.each(function(val){\n                if (val instanceof CalcError) {\n                    return val;\n                }\n                if (typeof val == \"number\") {\n                    numbers.push(val);\n                }\n            });\n            if (error) {\n                return error;\n            }\n            if (nth > numbers.length) {\n                return new CalcError(\"NUM\");\n            }\n            return handler(numbers, nth - 1);\n        }).args([\n            [ \"array\", \"matrix\" ],\n            [ \"*nth\", \"number++\" ]\n        ]);\n    });\n\n    function _avg(numbers) {\n        return numbers.reduce(function(sum, num){\n            return sum + num;\n        }, 0) / numbers.length;\n    }\n\n    function _var_sp(numbers, divisor, avg) {\n        if (avg == null) {\n            avg = _avg(numbers);\n        }\n        return numbers.reduce(function(sum, num){\n            return sum + Math.pow(num - avg, 2);\n        }, 0) / divisor;\n    }\n\n    function _stdev_sp(numbers, divisor) {\n        return Math.sqrt(_var_sp(numbers, divisor));\n    }\n\n    // https://support.office.com/en-sg/article/STDEV-S-function-7d69cf97-0c1f-4acf-be27-f3e83904cc23\n    defineFunction(\"stdev.s\", function(numbers){\n        return _stdev_sp(numbers, numbers.length - 1);\n    }).args([\n        [ \"numbers\", [ \"collect\", \"number\" ] ],\n        [ \"?\", [ \"assert\", \"$numbers.length >= 2\", \"NUM\" ] ]\n    ]);\n\n    // https://support.office.com/en-sg/article/STDEV-P-function-6e917c05-31a0-496f-ade7-4f4e7462f285\n    defineFunction(\"stdev.p\", function(numbers){\n        return _stdev_sp(numbers, numbers.length);\n    }).args([\n        [ \"numbers\", [ \"collect\", \"number!\" ] ],\n        [ \"?\", [ \"assert\", \"$numbers.length >= 1\", \"NUM\" ] ]\n    ]);\n\n    defineFunction(\"var.s\", function(numbers){\n        return _var_sp(numbers, numbers.length - 1);\n    }).args([\n        [ \"numbers\", [ \"collect\", \"number\" ] ],\n        [ \"?\", [ \"assert\", \"$numbers.length >= 2\", \"NUM\" ] ]\n    ]);\n\n    defineFunction(\"var.p\", function(numbers){\n        return _var_sp(numbers, numbers.length);\n    }).args([\n        [ \"numbers\", [ \"collect\", \"number\" ] ],\n        [ \"?\", [ \"assert\", \"$numbers.length >= 2\", \"NUM\" ] ]\n    ]);\n\n    defineFunction(\"median\", function(numbers){\n        var n = numbers.length;\n        numbers.sort(ascending);\n        if (n % 2) {\n            // when length is odd, the median is the number in the middle\n            return numbers[n >> 1];\n        }\n        // that's the average of the two middle numbers, written in in a fancy way\n        return (numbers[n >>= 1] + numbers[n - 1]) / 2;\n    }).args([\n        [ \"numbers\", [ \"collect\", \"number\" ] ],\n        [ \"?\", [ \"assert\", \"$numbers.length > 0\", \"N/A\" ] ]\n    ]);\n\n    defineFunction(\"mode.sngl\", function(numbers){\n        numbers.sort(ascending);\n        var prev = null, count = 0, max = 1, mode = null;\n        for (var i = 0; i < numbers.length; ++i) {\n            var n = numbers[i];\n            if (n != prev) {\n                count = 1;\n                prev = n;\n            } else {\n                count++;\n            }\n            if (count > max) {\n                max = count;\n                mode = n;\n            }\n        }\n        return mode == null ? new CalcError(\"N/A\") : mode;\n    }).args([\n        [ \"numbers\", [ \"collect\", \"number\" ] ]\n    ]);\n\n    defineFunction(\"mode.mult\", function(numbers){\n        var seen = Object.create(null), max = 2, res = [];\n        numbers.forEach(function(num){\n            var s = seen[num] || 0;\n            seen[num] = ++s;\n            if (s == max) {\n                res.push(num);\n            } else if (s > max) {\n                max = s;\n                res = [ num ];\n            }\n        });\n        var m = new Matrix(this);\n        res.forEach(function(num, i){\n            m.set(i, 0, num);\n        });\n        return m;\n    }).args([\n        [ \"numbers\", [ \"collect\", \"number\" ] ]\n    ]);\n\n    defineFunction(\"geomean\", function(numbers){\n        var n = numbers.length;\n        var p = numbers.reduce(function(p, num){\n            if (num < 0) {\n                throw new CalcError(\"NUM\");\n            }\n            return p * num;\n        }, 1);\n        return Math.pow(p, 1/n);\n    }).args([\n        [ \"numbers\", [ \"collect\", \"number\" ] ],\n        [ \"?\", [ \"assert\", \"$numbers.length > 0\", \"NUM\" ] ]\n    ]);\n\n    defineFunction(\"harmean\", function(numbers){\n        var n = numbers.length;\n        var s = numbers.reduce(function(s, num){\n            if (!num) {\n                throw new CalcError(\"DIV/0\");\n            }\n            return s + 1 / num;\n        }, 0);\n        return n / s;\n    }).args([\n        [ \"numbers\", [ \"collect\", \"number\" ] ],\n        [ \"?\", [ \"assert\", \"$numbers.length > 0\", \"NUM\" ] ]\n    ]);\n\n    defineFunction(\"trimmean\", function(numbers, p){\n        var n = numbers.length;\n        numbers.sort(ascending);\n        var discard = Math.floor(n * p);\n        if (discard % 2) {\n            --discard;\n        }\n        discard /= 2;\n        var sum = 0;\n        for (var i = discard; i < n-discard; ++i) {\n            sum += numbers[i];\n        }\n        return sum / (n - discard * 2);\n    }).args([\n        [ \"numbers\", [ \"collect\", \"number\", 1 ] ],\n        [ \"percent\", [ \"and\", \"number\", [ \"[between)\", 0, 1 ] ] ],\n        [ \"?\", [ \"assert\", \"$numbers.length > 0\", \"NUM\" ] ]\n    ]);\n\n    defineFunction(\"frequency\", function(data, bins){\n        // apparently this always returns a vertical matrix in Excel, so we collect all numbers in\n        // bins instead of receiving it as a Matrix and try to mimic its shape.\n        data.sort(ascending);\n        bins.sort(ascending);\n        var prev = -Infinity;\n        var i = 0;\n        function count(max) {\n            var n = 0;\n            while (i < data.length && data[i] > prev && data[i] <= max) {\n                ++n; ++i;\n            }\n            return n;\n        }\n        var m = new Matrix(this);\n        bins.forEach(function(val, i){\n            var n = count(val);\n            prev = val;\n            m.set(i, 0, n);\n        });\n        m.set(m.height, 0, data.length - i);\n        return m;\n    }).args([\n        [ \"data\", [ \"collect\", \"number\", 1 ] ],\n        [ \"bins\", [ \"collect\", \"number\", 1 ] ]\n    ]);\n\n    defineFunction(\"rank.eq\", function(val, numbers, asc) {\n        numbers.sort(asc ? ascending : descending);\n        var pos = numbers.indexOf(val);\n        return pos < 0 ? new CalcError(\"N/A\") : pos + 1;\n    }).args([\n        [ \"value\", \"number\" ],\n        [ \"numbers\", [ \"collect\", \"number\" ] ],\n        [ \"order\", [ \"or\", \"logical\", [ \"null\", false ] ] ]\n    ]);\n\n    defineAlias(\"rank\", \"rank.eq\");\n\n    defineFunction(\"rank.avg\", function(val, numbers, asc) {\n        numbers.sort(asc ? ascending : descending);\n        var pos = numbers.indexOf(val);\n        if (pos < 0) {\n            return new CalcError(\"N/A\");\n        }\n        for (var i = pos; numbers[i] == val; ++i){}\n        return (pos + i + 1) / 2;\n    }).args([\n        [ \"value\", \"number\" ],\n        [ \"numbers\", [ \"collect\", \"number\" ] ],\n        [ \"order\", [ \"or\", \"logical\", [ \"null\", false ] ] ]\n    ]);\n\n    // formula available at https://support.office.microsoft.com/en-us/article/KURT-function-cbbc2312-dfa6-4cc4-b5c0-1b3c59cc9377\n    defineFunction(\"kurt\", function(numbers){\n        var n = numbers.length;\n        var avg = _avg(numbers);\n        var variance = _var_sp(numbers, n-1, avg);\n        var stddev = Math.sqrt(variance);\n        var sum = numbers.reduce(function(sum, num){\n            return sum + Math.pow((num - avg) / stddev, 4);\n        }, 0);\n        return n*(n+1)/((n-1)*(n-2)*(n-3)) * sum\n            - 3*Math.pow(n-1, 2)/((n-2)*(n-3));\n    }).args([\n        [ \"numbers\", [ \"collect\", \"number\" ] ],\n        [ \"?\", [ \"assert\", \"$numbers.length >= 4\", \"NUM\" ] ]\n    ]);\n\n    function _percentrank(numbers, x, exc) {\n        var nlt = 0, ngt = 0, left = null, right = null, found = false;\n        numbers.forEach(function(num){\n            if (num < x) {\n                nlt++;\n                left = left == null ? num : Math.max(left, num);\n            } else if (num > x) {\n                ngt++;\n                right = right == null ? num : Math.min(right, num);\n            } else {\n                found = true;\n            }\n        });\n        if (!nlt && !ngt) {\n            return new CalcError(\"N/A\");\n        }\n        if (found) {\n            if (exc) {\n                return (nlt + 1) / (numbers.length + 1);\n            }\n            return nlt / (nlt + ngt);\n        }\n        return ((right - x) * _percentrank(numbers, left, exc) +\n                (x - left) * _percentrank(numbers, right, exc)) / (right - left);\n    }\n\n    var ARGS_PERCENTRANK = [\n        [ \"array\", [ \"collect\", \"number\", 1 ] ],\n        [ \"x\", \"number\" ],\n        [ \"significance\", [ \"or\", [ \"null\", 3 ], \"integer++\" ] ],\n        [ \"?\", [ \"assert\", \"$array.length > 0\", \"NUM\" ] ]\n    ];\n\n    defineFunction(\"percentrank.inc\", function(numbers, x, significance) {\n        var p = _percentrank(numbers, x, 0);\n        p = p.toFixed(significance + 1);\n        return parseFloat(p.substr(0, p.length - 1));\n    }).args(ARGS_PERCENTRANK);\n\n    defineFunction(\"percentrank.exc\", function(numbers, x, significance) {\n        var p = _percentrank(numbers, x, 1);\n        p = p.toFixed(significance + 1);\n        return parseFloat(p.substr(0, p.length - 1));\n    }).args(ARGS_PERCENTRANK);\n\n    defineAlias(\"percentrank\", \"percentrank.inc\");\n\n    function _covariance(x, y, divisor) {\n        var sum = 0;\n        var ax = _avg(x);\n        var ay = _avg(y);\n        var n = x.length;\n        for (var i = 0; i < n; ++i) {\n            sum += (x[i] - ax) * (y[i] - ay);\n        }\n        return sum / divisor;\n    }\n\n    defineFunction(\"covariance.p\", function(x, y){\n        return _covariance(x, y, x.length);\n    }).args([\n        [ \"array1\", [ \"collect\", \"number\", 1 ] ],\n        [ \"array2\", [ \"collect\", \"number\", 1 ] ],\n        [ \"?\", [ \"assert\", \"$array1.length == $array2.length\", \"N/A\" ] ],\n        [ \"?\", [ \"assert\", \"$array1.length > 0\", \"DIV/0\" ] ]\n    ]);\n\n    defineFunction(\"covariance.s\", function(x, y){\n        return _covariance(x, y, x.length - 1);\n    }).args([\n        [ \"array1\", [ \"collect\", \"number\", 1 ] ],\n        [ \"array2\", [ \"collect\", \"number\", 1 ] ],\n        [ \"?\", [ \"assert\", \"$array1.length == $array2.length\", \"N/A\" ] ],\n        [ \"?\", [ \"assert\", \"$array1.length > 1\", \"DIV/0\" ] ]\n    ]);\n\n    defineAlias(\"covar\", \"covariance.p\");\n\n    /* -----[ Factorials ]----- */\n\n    var _fact = util.memoize(function(n){\n        for (var i = 2, fact = 1; i <= n; ++i) {\n            fact *= i;\n        }\n        return fact;\n    });\n\n    defineFunction(\"fact\", _fact).args([\n        [ \"*n\", \"integer+\" ]\n    ]);\n\n    defineFunction(\"factdouble\", function(n){\n        for (var i = 2 + (n&1), fact = 1; i <= n; i += 2) {\n            fact *= i;\n        }\n        return fact;\n    }).args([\n        [ \"*n\", \"integer+\" ]\n    ]);\n\n    defineFunction(\"multinomial\", function(numbers){\n        var div = 1, sum = 0;\n        numbers.forEach(function(n){\n            if (n < 0) {\n                throw new CalcError(\"NUM\");\n            }\n            sum += n;\n            div *= _fact(n);\n        });\n        return _fact(sum) / div;\n    }).args([\n        [ \"numbers\", [ \"collect\", \"number\" ] ]\n    ]);\n\n    var _combinations = util.memoize(function (n, k){\n        for (var f1 = k + 1, f2 = 1, p1 = 1, p2 = 1; f2 <= n - k; ++f1, ++f2) {\n            p1 *= f1;\n            p2 *= f2;\n        }\n        return p1/p2;\n    });\n\n    defineFunction(\"combin\", _combinations).args([\n        [ \"*n\", \"integer++\" ],\n        [ \"*k\", [ \"and\", \"integer\", [ \"[between]\", 0, \"$n\" ] ] ]\n    ]);\n\n    defineFunction(\"combina\", function(n, k){\n        return _combinations(n + k - 1, n - 1);\n    }).args([\n        [ \"*n\", \"integer++\" ],\n        [ \"*k\", [ \"and\", \"integer\", [ \"[between]\", 1, \"$n\" ] ] ]\n    ]);\n\n    /* -----[ Statistical functions ]----- */\n\n    defineFunction(\"average\", function(numbers){\n        var sum = numbers.reduce(function(sum, num){\n            return sum + num;\n        }, 0);\n        return sum / numbers.length;\n    }).args([\n        // most numeric functions must treat booleans as numbers (1 for TRUE\n        // and 0 for FALSE), but AVERAGE shouldn't.\n        [ \"numbers\", [ \"collect\", \"number!\" ] ],\n        [ \"?\", [ \"assert\", \"$numbers.length > 0\", \"DIV/0\" ] ]\n    ]);\n\n    defineFunction(\"averagea\", function(values){\n        var sum = 0, count = 0;\n        values.forEach(function(num){\n            if (typeof num != \"string\") {\n                sum += num;\n            }\n            ++count;\n        });\n        return count ? sum / count : new CalcError(\"DIV/0\");\n    }).args([\n        [ \"values\", [ \"collect\", \"anyvalue\" ] ]\n    ]);\n\n    function _percentile(numbers, rank) {\n        numbers.sort(ascending);\n        var n = numbers.length;\n        var k = rank | 0, d = rank - k;\n        if (k === 0) {\n            return numbers[0];\n        }\n        if (k >= n) {\n            return numbers[n - 1];\n        }\n        --k;\n        return numbers[k] + d * (numbers[k + 1] - numbers[k]);\n    }\n\n    function _percentile_inc(numbers, p){\n        // algorithm from https://en.wikipedia.org/wiki/Percentile#Microsoft_Excel_method\n        var rank = p * (numbers.length - 1) + 1;\n        return _percentile(numbers, rank);\n    }\n\n    function _percentile_exc(numbers, p){\n        // https://en.wikipedia.org/wiki/Percentile#NIST_method\n        var rank = p * (numbers.length + 1);\n        return _percentile(numbers, rank);\n    }\n\n    defineFunction(\"percentile.inc\", _percentile_inc).args([\n        [ \"numbers\", [ \"collect\", \"number\", 1 ] ],\n        [ \"p\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ]\n    ]);\n\n    defineFunction(\"percentile.exc\", _percentile_exc).args([\n        [ \"numbers\", [ \"collect\", \"number\", 1 ] ],\n        [ \"p\", [ \"and\", \"number\", [ \"(between)\", 0, 1 ] ] ]\n    ]);\n\n    defineFunction(\"quartile.inc\", function(numbers, quarter){\n        return _percentile_inc(numbers, quarter / 4);\n    }).args([\n        [ \"numbers\", [ \"collect\", \"number\", 1 ] ],\n        [ \"quarter\", [ \"values\", 0, 1, 2, 3, 4 ] ]\n    ]);\n\n    defineFunction(\"quartile.exc\", function(numbers, quarter){\n        return _percentile_exc(numbers, quarter / 4);\n    }).args([\n        [ \"numbers\", [ \"collect\", \"number\", 1 ] ],\n        [ \"quarter\", [ \"values\", 0, 1, 2, 3, 4 ] ]\n    ]);\n\n    defineAlias(\"quartile\", \"quartile.inc\");\n    defineAlias(\"percentile\", \"percentile.inc\");\n\n    var AGGREGATE_FUNCS = [\n        \"AVERAGE\", \"COUNT\", \"COUNTA\", \"MAX\", \"MIN\", \"PRODUCT\",\n        \"STDEV.S\", \"STDEV.P\", \"SUM\", \"VAR.S\", \"VAR.P\", \"MEDIAN\",\n        \"MODE.SNGL\", \"LARGE\", \"SMALL\", \"PERCENTILE.INC\",\n        \"QUARTILE.INC\", \"PERCENTILE.EXC\", \"QUARTILE.EXC\"\n    ];\n\n    function fetchValuesForAggregate(self, args, options) {\n        var values = [];\n        var opt_ignore_hidden_rows = 1;\n        var opt_ignore_errors = 2;\n        var opt_use_aggregates = 4;\n        (function fetchValues(args) {\n            if (args instanceof Ref) {\n                self.getRefCells(args, true).forEach(function(cell){\n                    var value = cell.value;\n                    if ((options & opt_ignore_hidden_rows) && cell.hidden) {\n                        return;\n                    }\n                    if (cell.formula) {\n                        // XXX: formula.print is fast, but still, can't we do any better here?\n                        //      perhaps access the input string directly somehow?\n                        var str = cell.formula.print(cell.row, cell.col);\n                        if (/^\\s*(?:aggregate|subtotal)\\s*\\(/i.test(str)) {\n                            if (!(options & opt_use_aggregates)) {\n                                return;\n                            }\n                        }\n                    }\n                    if ((options & opt_ignore_errors) && value instanceof CalcError) {\n                        return;\n                    }\n                    if (typeof value == \"number\" || value instanceof CalcError) {\n                        values.push(value);\n                    }\n                });\n            } else if (Array.isArray(args)) {\n                for (var i = 0; i < args.length; ++i) {\n                    fetchValues(args[i]);\n                }\n            } else if (args instanceof Matrix) {\n                args.each(fetchValues);\n            } else if (typeof args == \"number\") {\n                values.push(args);\n            } else if (args instanceof CalcError && !(options & opt_ignore_errors)) {\n                values.push(args);\n            }\n        })(args);\n        return values;\n    }\n\n    // AGGREGATE function\n    //\n    // https://support.office.com/en-SG/article/aggregate-function-c8caed56-07df-4aeb-9741-23693ffbe525\n    //\n    // we can only partially type-check this function.  also, we need to use the async version in\n    // order to resolve references and delegate values to the function to aggregate.\n    defineFunction(\"aggregate\", function(callback, funcId, options, args){\n        // options is a bit field.  that makes sense; it's the documentation which doesn't.\n        var self = this;\n        self.resolveCells(args, function(){\n            var values;\n            if (funcId > 12) {\n                // \"array form\"\n                values = fetchValuesForAggregate(self, args[0], options);\n                var k = args[1];\n                if (k instanceof CellRef) {\n                    k = self.getRefData(k);\n                }\n                if (typeof k != \"number\") {\n                    return callback(new CalcError(\"VALUE\"));\n                }\n            } else {\n                values = fetchValuesForAggregate(self, args, options);\n            }\n            self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n        });\n    }).argsAsync([\n        [ \"funcId\", [ \"values\", 1, 2, 3, 4, 5, 6, 7, 8, 9, 10,\n                      11, 12, 13, 14, 15, 16, 17, 18, 19 ] ],\n        [ \"options\", [ \"or\",\n                       [ \"null\", 0 ],\n                       [ \"values\", 0, 1, 2, 3, 4, 5, 6, 7  ] ] ],\n        [ \"args\", \"rest\" ]\n    ]);\n\n    defineFunction(\"subtotal\", function(callback, funcId){\n        var self = this;\n        var ignoreHidden = funcId > 100;\n        if (ignoreHidden) {\n            funcId -= 100;\n        }\n        var args = [];\n        for (var i = 2; i < arguments.length; ++i) {\n            args.push(arguments[i]);\n        }\n        self.resolveCells(args, function(){\n            var values = fetchValuesForAggregate(self, args, ignoreHidden ? 1 : 0);\n            self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n        });\n    }).argsAsync([\n        [ \"funcId\", [ \"values\", 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,\n                      101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111 ] ],\n        [ \"+\", [ \"ref\", [ \"or\", \"ref\", \"#matrix\" ] ] ]\n    ]);\n\n    // https://support.office.com/en-sg/article/AVEDEV-function-ec78fa01-4755-466c-9a2b-0c4f9eacaf6d\n    defineFunction(\"avedev\", function(numbers){\n        var avg = numbers.reduce(function(sum, num){\n            return sum + num;\n        }, 0) / numbers.length;\n        return numbers.reduce(function(sum, num){\n            return sum + Math.abs(num - avg);\n        }, 0) / numbers.length;\n    }).args([\n        [ \"numbers\", [ \"collect\", \"number\" ] ],\n        [ \"?\", [ \"assert\", \"$numbers.length >= 2\", \"NUM\" ] ]\n    ]);\n\n    function _binom_dist(x, n, p, cumulative) {\n        if (!cumulative) {\n            return _combinations(n, x) * Math.pow(p, x) * Math.pow(1-p, n-x);\n        } else {\n            var sum = 0;\n            for (var j = 0; j <= x; ++j) {\n                sum += _combinations(n, j) * Math.pow(p, j) * Math.pow(1-p, n-j);\n            }\n            return sum;\n        }\n    }\n\n    defineFunction(\"binom.dist\", _binom_dist).args([\n        [ \"successes\", \"integer+\" ],\n        [ \"trials\", [ \"and\", \"integer\", [ \"assert\", \"$trials >= $successes\" ] ] ],\n        [ \"probability\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n        [ \"cumulative\", \"logical\" ]\n    ]);\n\n    defineAlias(\"binomdist\", \"binom.dist\");\n\n    defineFunction(\"binom.inv\", function(n, p, alpha){\n        // XXX: could a binary search be faster?\n        for (var x = 0; x <= n; ++x) {\n            if (_binom_dist(x, n, p, true) >= alpha) {\n                return x;\n            }\n        }\n        return new CalcError(\"N/A\"); // XXX: is this right?\n    }).args([\n        [ \"trials\", \"integer+\" ],\n        [ \"probability\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n        [ \"alpha\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ]\n    ]);\n\n    defineAlias(\"critbinom\", \"binom.inv\");\n\n    defineFunction(\"binom.dist.range\", function(n, p, s, s2){\n        var sum = 0;\n        for (var k = s; k <= s2; ++k) {\n            sum += _combinations(n, k) * Math.pow(p, k) * Math.pow(1-p, n-k);\n        }\n        return sum;\n    }).args([\n        [ \"trials\", \"integer+\" ],\n        [ \"probability\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n        [ \"successes_min\", [ \"and\", \"integer\", [ \"[between]\", 0, \"$trials\" ] ] ],\n        [ \"successes_max\", [ \"or\",\n                             [ \"and\", \"integer\",\n                               [ \"[between]\", \"$successes_min\", \"$trials\" ] ],\n                             [ \"null\", \"$successes_min\" ] ] ]\n    ]);\n\n    defineFunction(\"negbinom.dist\", function(x, k, p, cumulative){\n        if (cumulative) {\n            var sum = 0;\n            while (x >= 0) {\n                sum += _combinations(x+k-1, x) * Math.pow(p, k) * Math.pow(1-p, x);\n                x--;\n            }\n            return sum;\n        }\n        return _combinations(x+k-1, x) * Math.pow(p, k) * Math.pow(1-p, x);\n    }).args([\n        [ \"number_f\", \"integer+\" ],\n        [ \"number_s\", \"integer+\" ],\n        [ \"probability_s\", [ \"and\", \"number\", [ \"[between]\", 0, 1 ] ] ],\n        [ \"cumulative\", \"logical\" ]\n    ]);\n\n    defineAlias(\"negbinomdist\", \"negbinom.dist\");\n\n    /* -----[ lookup functions ]----- */\n\n    defineFunction(\"address\", function(row, col, abs, a1, sheet){\n        // by some lucky coincidence, we get the corret `rel` value by just subtracting 1 from the\n        // abs argument\n        var cell = new CellRef(row - 1, col - 1, abs - 1);\n        if (sheet) {\n            cell.setSheet(sheet, true);\n        }\n        return a1 ? cell.print(0, 0) : cell.print();\n    }).args([\n        [ \"row\", \"integer++\" ],\n        [ \"col\", \"integer++\" ],\n        [ \"abs\", [ \"or\", [ \"null\", 1 ], [ \"values\", 1, 2, 3, 4 ]]],\n        [ \"a1\", [ \"or\", [ \"null\", true ], \"logical\" ]],\n        [ \"sheet\", [ \"or\", \"null\", \"string\" ]]\n    ]);\n\n    defineFunction(\"areas\", function(ref){\n        var count = 0;\n        (function loop(x){\n            if (x instanceof CellRef || x instanceof RangeRef) {\n                count++;\n            } else if (x instanceof UnionRef) {\n                x.refs.forEach(loop);\n            }\n            // XXX: NameRef if we add support\n        })(ref);\n        return count;\n    }).args([\n        [ \"ref\", \"ref\" ]\n    ]);\n\n    defineFunction(\"choose\", function(index, args){\n        if (index > args.length) {\n            return new CalcError(\"N/A\");\n        } else {\n            return args[index - 1];\n        }\n    }).args([\n        [ \"*index\", \"integer\" ],\n        [ \"+\", [ \"value\", \"anything\" ] ]\n    ]);\n\n    defineFunction(\"column\", function(ref){\n        if (!ref) {\n            return this.formula.col + 1;\n        }\n        if (ref instanceof CellRef) {\n            return ref.col + 1;\n        }\n        return this.asMatrix(ref).mapCol(function(col){\n            return col + ref.topLeft.col + 1;\n        });\n    }).args([\n        [ \"ref\", [ \"or\", \"area\", \"null\" ]]\n    ]);\n\n    defineFunction(\"columns\", function(m){\n        return m instanceof Ref ? m.width() : m.width;\n    }).args([\n        [ \"ref\", [ \"or\", \"area\", \"#matrix\" ] ]\n    ]);\n\n    defineFunction(\"formulatext\", function(ref){\n        var cell = this.getRefCells(ref)[0]; // XXX: overkill, but oh well.\n        if (!cell.formula) {\n            return new CalcError(\"N/A\");\n        }\n        return cell.formula.print(cell.row, cell.col);\n    }).args([\n        [ \"ref\", \"ref\" ]\n    ]);\n\n    defineFunction(\"hlookup\", function(value, m, row, approx){\n        var resultCol = null;\n        m.eachCol(function(col){\n            var data = m.get(0, col);\n            if (approx) {\n                if (data > value) {\n                    return true;\n                }\n                resultCol = col;\n            } else if (data === value) {\n                resultCol = col;\n                return true;\n            }\n        });\n        if (resultCol == null) {\n            return new CalcError(\"N/A\");\n        }\n        return m.get(row - 1, resultCol);\n    }).args([\n        [ \"value\", \"anyvalue\" ],\n        [ \"range\", \"matrix\" ],\n        [ \"row\", \"integer++\" ],\n        [ \"approx\", [ \"or\", \"logical\", [ \"null\", true ]]]\n    ]);\n\n    defineFunction(\"index\", function(callback, ref, row, col, areanum){\n        var self = this;\n        if (ref instanceof UnionRef) {\n            ref = ref.refs[areanum - 1];\n        }\n        if ((!row && !col) || !ref) {\n            return callback(new CalcError(\"N/A\"));\n        }\n        if (ref instanceof CellRef) {\n            ref = ref.toRangeRef();\n        }\n        if (ref instanceof RangeRef) {\n            if (row && col) {\n                if (col > ref.width() || row > ref.height()) {\n                    return callback(new CalcError(\"REF\"));\n                }\n                // fetching a single cell\n                var cell = ref.toCell(row - 1, col - 1);\n                self.resolveCells([ cell ], function(){\n                    callback(self.getRefData(cell));\n                });\n                return;\n            }\n            if (!row) {\n                // fetch a full column\n                var colRange = ref.toColumn(col - 1);\n                self.resolveCells([ colRange ], function(){\n                    callback(self.asMatrix(colRange));\n                });\n                return;\n            }\n            if (!col) {\n                // fetch a full row\n                var rowRange = ref.toRow(row - 1);\n                self.resolveCells([ rowRange ], function(){\n                    callback(self.asMatrix(rowRange));\n                });\n                return;\n            }\n        }\n        else if (ref instanceof Matrix) {\n            if (ref.width > 1 && ref.height > 1) {\n                if (row && col) {\n                    return callback(ref.get(row - 1, col - 1));\n                }\n                if (!row) {\n                    return callback(ref.mapRow(function(row){\n                        return ref.get(row, col - 1);\n                    }));\n                }\n                if (!col) {\n                    return callback(ref.mapCol(function(col){\n                        return ref.get(row - 1, col);\n                    }));\n                }\n            }\n            if (ref.width == 1) {\n                return callback(ref.get(row - 1, 0));\n            }\n            if (ref.height == 1) {\n                return callback(ref.get(0, col - 1));\n            }\n        }\n        else {\n            callback(new CalcError(\"REF\"));\n        }\n    }).argsAsync([\n        [ \"range\", [ \"or\", \"ref\", \"matrix\" ] ],\n        [ \"row\", [ \"or\", \"integer+\", \"null\" ] ],\n        [ \"col\", [ \"or\", \"integer+\", \"null\" ] ],\n        [ \"areanum\", [ \"or\", \"integer++\", [ \"null\", 1 ] ] ]\n    ]);\n\n    defineFunction(\"indirect\", function(thing){\n        try {\n            // XXX: does more work than needed.  we could go for parseReference, but that one\n            // doesn't (yet?) support \"SheetName!\" prefix.\n            var f = this.formula;\n            var exp = calc.parseFormula(f.sheet, f.row, f.col, thing);\n            var ref = exp.ast;\n            if (ref instanceof NameRef) {\n                ref = this.ss.nameValue(ref, f.sheet, f.row, f.col);\n            }\n            if (!(ref instanceof Ref)) {\n                throw 1;\n            }\n            return ref.absolute(f.row, f.col);\n        } catch(ex) {\n            return new CalcError(\"REF\");\n        }\n    }).args([\n        [ \"thing\", \"string\" ]\n    ]);\n\n    // XXX: LOOKUP.  seems to be deprecated in favor of HLOOKUP/VLOOKUP\n\n    // XXX: double-check this one.\n    defineFunction(\"match\", function(val, m, type){\n        var index = 1, cmp;\n        if (type === 0) {\n            cmp = parseCriteria(val);\n        } else if (type === -1) {\n            cmp = parseCriteria(\"<=\" + val);\n        } else if (type === 1) {\n            cmp = parseCriteria(\">=\" + val);\n        }\n        if (m.each(function(el){\n            if (el != null && cmp(el)) {\n                if (type !== 0 && val != el) {\n                    --index;\n                }\n                return true;\n            }\n            index++;\n        }, true) && index > 0) {\n            return index;\n        } else {\n            return new CalcError(\"N/A\");\n        }\n    }).args([\n        [ \"value\", \"anyvalue\" ],\n        [ \"range\", \"matrix\" ],\n        [ \"type\", [ \"or\",\n                    [ \"values\", -1, 0, 1 ],\n                    [ \"null\", 1 ]]]\n    ]);\n\n    defineFunction(\"offset\", function(ref, rows, cols, height, width){\n        var topLeft = (ref instanceof CellRef ? ref : ref.topLeft).clone();\n        topLeft.row += rows;\n        topLeft.col += cols;\n        if (topLeft.row < 0 || topLeft.col < 0) {\n            return new CalcError(\"VALUE\");\n        }\n        if (height > 1 || width > 1) {\n            return new RangeRef(topLeft, new CellRef(topLeft.row + height - 1,\n                                                     topLeft.col + width - 1))\n                .setSheet(ref.sheet, ref.hasSheet());\n        }\n        return topLeft;\n    }).args([\n        [ \"ref\", \"area\" ],\n        [ \"*rows\", \"integer\" ],\n        [ \"*cols\", \"integer\" ],\n        [ \"*height\", [ \"or\", \"integer++\", [ \"null\", \"$ref.height()\" ]]],\n        [ \"*width\", [ \"or\", \"integer++\", [ \"null\", \"$ref.width()\" ]]]\n    ]);\n\n    defineFunction(\"row\", function(ref){\n        if (!ref) {\n            return this.formula.row + 1;\n        }\n        if (ref instanceof CellRef) {\n            return ref.row + 1;\n        }\n        return this.asMatrix(ref).mapRow(function(row){\n            return row + ref.topLeft.row + 1;\n        });\n    }).args([\n        [ \"ref\", [ \"or\", \"area\", \"null\" ]]\n    ]);\n\n    defineFunction(\"rows\", function(m){\n        return m instanceof Ref ? m.height() : m.height;\n    }).args([\n        [ \"ref\", [ \"or\", \"area\", \"#matrix\" ] ]\n    ]);\n\n    defineFunction(\"vlookup\", function(value, m, col, approx){\n        var resultRow = null;\n        if (typeof value != \"number\") {\n            approx = false;\n        }\n        if (typeof value == \"string\") {\n            value = value.toLowerCase();\n        }\n        m.eachRow(function(row){\n            var data = m.get(row, 0);\n            if (approx) {\n                if (data > value) {\n                    return true;\n                }\n                resultRow = row;\n            } else {\n                if (typeof data == \"string\") {\n                    data = data.toLowerCase();\n                }\n                if (data === value) {\n                    resultRow = row;\n                    return true;\n                }\n            }\n        });\n        if (resultRow == null) {\n            return new CalcError(\"N/A\");\n        }\n        return m.get(resultRow, col - 1);\n    }).args([\n        [ \"value\", \"anyvalue\" ],\n        [ \"range\", \"matrix\" ],\n        [ \"col\", \"integer++\" ],\n        [ \"approx\", [ \"or\", \"logical\", [ \"null\", true ]]]\n    ]);\n\n    /* -----[ Date and time functions ]----- */\n\n    defineFunction(\"date\", function(year, month, date){\n        return packDate(year, month-1, date);\n    }).args([\n        [ \"*year\", \"integer\" ],\n        [ \"*month\", \"integer\" ],\n        [ \"*date\", \"integer\" ]\n    ]);\n\n    defineFunction(\"day\", function(date){\n        return unpackDate(date).date;\n    }).args([\n        [ \"*date\", \"date\" ]\n    ]);\n\n    defineFunction(\"month\", function(date){\n        return unpackDate(date).month + 1;\n    }).args([\n        [ \"*date\", \"date\" ]\n    ]);\n\n    defineFunction(\"year\", function(date){\n        return unpackDate(date).year;\n    }).args([\n        [ \"*date\", \"date\" ]\n    ]);\n\n    defineFunction(\"weekday\", function(date){\n        // XXX: TODO type\n        return unpackDate(date).day + 1;\n    }).args([\n        [ \"*date\", \"date\" ]\n    ]);\n\n    // https://support.office.com/en-GB/article/WEEKNUM-function-e5c43a03-b4ab-426c-b411-b18c13c75340\n    // XXX: this is a mess.\n    defineFunction(\"weeknum\", function(date, type){\n        var fw = packDate(unpackDate(date).year, 0, 1);\n        var sy = unpackDate(fw);\n        var diff;\n        if (type == 21) {\n            // Monday-based weeks, first week is the one containing the first Thursday of the year\n            // we want to place in fw and sy the first Thursday\n            diff = 3 - (sy.day + 6) % 7;\n            if (diff < 0) {\n                diff += 7;\n            }\n            fw += diff;\n            sy.date += diff;\n            sy.day = 4;         // Thursday.\n            type = 1;\n        } else {\n            if (type == 1) {\n                type = 0;\n            } else if (type == 2) {\n                type = 1;\n            } else {\n                type = (type - 10) % 7;\n            }\n            // finally compatible with what we got:\n            // type == 0 means week starts on Sunday\n            //         1                      Monday\n            //         2                      Tuesday\n            // ...\n        }\n        diff = sy.day - type;\n        if (diff < 0) {\n            diff += 7;\n        }\n        fw -= diff;\n        return Math.ceil((date + 1 - fw) / 7);\n    }).args([\n        [ \"*date\", \"date\" ],\n        [ \"*type\", [ \"or\", [ \"null\", 1 ],\n                     [ \"values\", 1, 2, 11, 12, 13, 14, 15, 16, 17, 21 ] ] ]\n    ]);\n\n    function weeksInYear(year) {\n        var d = unpackDate(packDate(year, 0, 1));\n        if ((d.day == 4) || (d.day == 3 && runtime.isLeapYear(year))) {\n            // long year\n            return 53;\n        }\n        return 52;\n    }\n\n    defineFunction(\"isoweeknum\", function isoweeknum(date){\n        // https://en.wikipedia.org/wiki/ISO_week_date#Calculating_the_week_number_of_a_given_date\n        var d = unpackDate(date);\n        var dow = d.day || 7;\n        var wk = Math.floor((d.ord - dow + 10) / 7);\n        if (wk < 1) {\n            return weeksInYear(d.year - 1);\n        } else if (wk == 53 && wk > weeksInYear(d.year)) {\n            return 1;\n        }\n        return wk;\n    }).args([\n        [ \"*date\", \"date\" ]\n    ]);\n\n    defineFunction(\"now\", function(){\n        return runtime.dateToSerial(new Date());\n    }).args([]);\n\n    defineFunction(\"today\", function(){\n        return runtime.dateToSerial(new Date()) | 0;\n    }).args([]);\n\n    defineFunction(\"time\", function(hh, mm, ss){\n        return runtime.packTime(hh, mm, ss, 0);\n    }).args([\n        [ \"*hours\", \"integer\" ],\n        [ \"*minutes\", \"integer\" ],\n        [ \"*seconds\", \"integer\" ]\n    ]);\n\n    defineFunction(\"hour\", function(time){\n        return runtime.unpackTime(time).hours;\n    }).args([\n        [ \"*time\", \"datetime\" ]\n    ]);\n\n    defineFunction(\"minute\", function(time){\n        return runtime.unpackTime(time).minutes;\n    }).args([\n        [ \"*time\", \"datetime\" ]\n    ]);\n\n    defineFunction(\"second\", function(time){\n        return runtime.unpackTime(time).seconds;\n    }).args([\n        [ \"*time\", \"datetime\" ]\n    ]);\n\n    defineFunction(\"edate\", function(base, months){\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m/12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = Math.min(d.date, daysInMonth(y, m));\n        return packDate(y, m, d);\n    }).args([\n        [ \"*start_date\", \"date\" ],\n        [ \"*months\", \"integer\" ]\n    ]);\n\n    defineFunction(\"eomonth\", function(base, months){\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m/12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = daysInMonth(y, m);\n        return packDate(y, m, d);\n    }).args([\n        [ \"*start_date\", \"date\" ],\n        [ \"*months\", \"integer\" ]\n    ]);\n\n    defineFunction(\"workday\", function(date, n, holidays){\n        // XXX: the algorithm here is pretty dumb, can we do better?\n        var inc = n > 0 ? 1 : -1;\n        n = Math.abs(n);\n        var dow = unpackDate(date).day;\n        while (n > 0) {\n            date += inc;\n            dow = (dow + inc) % 7;\n            if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                --n;\n            }\n        }\n        return date;\n    }).args([\n        [ \"start_date\", \"date\" ],\n        [ \"days\", \"integer\" ],\n        [ \"holidays\", [ \"collect\", \"date\" ] ]\n    ]);\n\n    defineFunction(\"networkdays\", function(date, end, holidays){\n        // XXX: the algorithm here is pretty dumb, can we do better?\n        if (date > end) {\n            var tmp = date;\n            date = end;\n            end = tmp;\n        }\n        var count = 0;\n        var dow = unpackDate(date).day;\n        while (date <= end) {\n            if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                count++;\n            }\n            date++;\n            dow = (dow + 1) % 7;\n        }\n        return count;\n    }).args([\n        [ \"start_date\", \"date\" ],\n        [ \"end_date\", \"date\" ],\n        [ \"holidays\", [ \"collect\", \"date\" ] ]\n    ]);\n\n    defineFunction(\"days\", function(end, start){\n        return end - start;\n    }).args([\n        [ \"*start_date\", \"date\" ],\n        [ \"*end_date\", \"date\" ]\n    ]);\n\n    function _days_360(start, end, method) {\n        var d1 = unpackDate(start);\n        var d2 = unpackDate(end);\n\n        // https://en.wikipedia.org/wiki/360-day_calendar\n        // humanity is a mess.\n        if (method) {\n            // EU method\n            if (d1.date == 31) {\n                d1.date = 30;\n            }\n            if (d2.date == 31) {\n                d2.date = 30;\n            }\n        } else {\n            // US method\n            if (d1.month == 1 && d2.month == 1\n                && d1.date == daysInMonth(d1.year, 1)\n                && d2.date == daysInMonth(d2.year, 1)) {\n                d2.date = 30;\n            }\n            if (d1.date == daysInMonth(d1.year, d1.month)) {\n                d1.date = 30;\n                if (d2.date == 31) {\n                    d2.date = 30;\n                }\n            } else {\n                if (d1.date == 30 && d2.date == 31) {\n                    d2.date = 30;\n                }\n            }\n        }\n\n        return (360 * (d2.year - d1.year)\n                + 30 * (d2.month - d1.month)\n                + (d2.date - d1.date));\n    }\n\n    runtime._days_360 = _days_360;\n\n    defineFunction(\"days360\", _days_360).args([\n        [ \"*start_date\", \"date\" ],\n        [ \"*end_date\", \"date\" ],\n        [ \"*method\", [ \"or\", \"logical\", [ \"null\", false ] ] ]\n    ]);\n\n    defineFunction(\"yearfrac\", function(start, end, method){\n        switch (method) {\n          case 0:\n            return _days_360(start, end, false) / 360;\n          case 1:\n            return (end - start) / daysInYear(unpackDate(start).year);\n          case 2:\n            return (end - start) / 360;\n          case 3:\n            return (end - start) / 365;\n          case 4:\n            return _days_360(start, end, true) / 360;\n        }\n    }).args([\n        [ \"*start_date\", \"date\" ],\n        [ \"*end_date\", \"date\" ],\n        [ \"*method\", [ \"or\", [ \"null\", 0 ], [ \"values\", 0, 1, 2, 3, 4 ] ] ]\n    ]);\n\n    defineFunction(\"datevalue\", function(text){\n        var date = runtime.parseDate(text);\n        if (date) {\n            return runtime.dateToSerial(date);\n        }\n        return new CalcError(\"VALUE\");\n    }).args([\n        [ \"*text\", \"string\" ]\n    ]);\n\n    defineFunction(\"timevalue\", function(text){\n        var m = text.toLowerCase().match(/(\\d+):(\\d+)(:(\\d+)(\\.(\\d+))?)?\\s*(am?|pm?)?/);\n        if (m) {\n            var hh = parseFloat(m[1]);\n            var mm = parseFloat(m[2]);\n            var ss = m[3] ? parseFloat(m[4]) : 0;\n            //var ms = m[5] ? parseFloat(m[6]) : 0;\n            var ampm = m[7];\n            if (ampm && (hh > 12 || hh < 1)) {\n                return new CalcError(\"VALUE\");\n            }\n            if (/^p/.test(ampm)) {\n                hh += 12;\n            }\n            return runtime.packTime(hh, mm, ss, 0);\n        }\n        return new CalcError(\"VALUE\");\n    }).args([\n        [ \"*text\", \"string\" ]\n    ]);\n\n    /* -----[ Matrix functions ]----- */\n\n    defineFunction(\"mdeterm\", function(m){\n        var error = m.each(function(val){\n            if (typeof val != \"number\") {\n                return new CalcError(\"VALUE\");\n            }\n        }, true);\n        return error || m.determinant();\n    }).args([\n        [ \"m\", [ \"and\", \"matrix\",\n                 [ \"assert\", \"$m.width == $m.height\" ] ] ]\n    ]);\n\n    defineFunction(\"transpose\", function(m){\n        return m.transpose();\n    }).args([\n        [ \"range\", \"matrix\" ]\n    ]);\n\n    defineFunction(\"mmult\", function(a, b){\n        return a.multiply(b);\n    }).args([\n        [ \"a\", \"matrix\" ],\n        [ \"b\", [ \"and\", \"matrix\",\n                 [ \"assert\", \"$b.height == $a.width\" ] ] ]\n    ]);\n\n    defineFunction(\"munit\", function(n){\n        return new Matrix(this).unit(n);\n    }).args([\n        [ \"n\", \"integer+\" ]\n    ]);\n\n    defineFunction(\"minverse\", function(m){\n        var error = m.each(function(val){\n            if (typeof val != \"number\") {\n                return new CalcError(\"VALUE\");\n            }\n        }, true);\n        return error || m.inverse() || new CalcError(\"VALUE\");\n    }).args([\n        [ \"m\", [ \"and\", \"matrix\",\n                 [ \"assert\", \"$m.width == $m.height\" ] ] ]\n    ]);\n\n    /* -----[ Other ]----- */\n\n    defineFunction(\"rand\", function() {\n        return Math.random();\n    }).args([]);\n\n    defineFunction(\"randbetween\", function(min, max){\n        return min + Math.floor((max - min + 1) * Math.random());\n    }).args([\n        [ \"min\", \"integer\" ],\n        [ \"max\", [ \"and\", \"integer\", [ \"assert\", \"$max >= $min\" ] ] ]\n    ]);\n\n    defineFunction(\"true\", function(){\n        return true;\n    }).args([]);\n\n    defineFunction(\"false\", function(){\n        return true;\n    }).args([]);\n\n    defineFunction(\"roman\", function(num){\n        return util.arabicToRoman(num).toUpperCase();\n    }).args([\n        [ \"*number\", \"integer\" ]\n    ]);\n\n    defineFunction(\"arabic\", function(rom){\n        var num = util.romanToArabic(rom);\n        return num == null ? new CalcError(\"VALUE\") : num;\n    }).args([\n        [ \"*roman\", \"string\" ]\n    ]);\n\n    defineFunction(\"base\", function(number, radix, minLen){\n        var str = number.toString(radix).toUpperCase();\n        while (str.length < minLen) {\n            str = \"0\" + str;\n        }\n        return str;\n    }).args([\n        [ \"*number\", \"integer\" ],\n        [ \"*radix\", [ \"and\", \"integer\", [ \"[between]\", 2, 36 ] ] ],\n        [ \"*minLen\", [ \"or\", \"integer+\", [ \"null\", 0 ] ] ]\n    ]);\n\n    defineFunction(\"decimal\", function(text, radix){\n        text = text.toUpperCase();\n        var val = 0;\n        for (var i = 0; i < text.length; ++i) {\n            var d = text.charCodeAt(i);\n            if (d >= 48 && d <= 57) {\n                d -= 48;\n            } else if (d >= 65 && d < (55 + radix)) {\n                d -= 55;\n            } else {\n                return new CalcError(\"VALUE\");\n            }\n            val = val * radix + d;\n        }\n        return val;\n    }).args([\n        [ \"*text\", \"string\" ],\n        [ \"*radix\", [ \"and\", \"integer\", [ \"[between]\", 2, 36 ] ] ]\n    ]);\n\n    /* -----[ String functions ]----- */\n\n    defineFunction(\"char\", function(code){\n        return String.fromCharCode(code);\n    }).args([\n        [ \"*code\", \"integer+\" ]\n    ]);\n\n    // From XRegExp\n    var RX_NON_PRINTABLE = /[\\0-\\x1F\\x7F-\\x9F\\xAD\\u0378\\u0379\\u037F-\\u0383\\u038B\\u038D\\u03A2\\u0528-\\u0530\\u0557\\u0558\\u0560\\u0588\\u058B-\\u058E\\u0590\\u05C8-\\u05CF\\u05EB-\\u05EF\\u05F5-\\u0605\\u061C\\u061D\\u06DD\\u070E\\u070F\\u074B\\u074C\\u07B2-\\u07BF\\u07FB-\\u07FF\\u082E\\u082F\\u083F\\u085C\\u085D\\u085F-\\u089F\\u08A1\\u08AD-\\u08E3\\u08FF\\u0978\\u0980\\u0984\\u098D\\u098E\\u0991\\u0992\\u09A9\\u09B1\\u09B3-\\u09B5\\u09BA\\u09BB\\u09C5\\u09C6\\u09C9\\u09CA\\u09CF-\\u09D6\\u09D8-\\u09DB\\u09DE\\u09E4\\u09E5\\u09FC-\\u0A00\\u0A04\\u0A0B-\\u0A0E\\u0A11\\u0A12\\u0A29\\u0A31\\u0A34\\u0A37\\u0A3A\\u0A3B\\u0A3D\\u0A43-\\u0A46\\u0A49\\u0A4A\\u0A4E-\\u0A50\\u0A52-\\u0A58\\u0A5D\\u0A5F-\\u0A65\\u0A76-\\u0A80\\u0A84\\u0A8E\\u0A92\\u0AA9\\u0AB1\\u0AB4\\u0ABA\\u0ABB\\u0AC6\\u0ACA\\u0ACE\\u0ACF\\u0AD1-\\u0ADF\\u0AE4\\u0AE5\\u0AF2-\\u0B00\\u0B04\\u0B0D\\u0B0E\\u0B11\\u0B12\\u0B29\\u0B31\\u0B34\\u0B3A\\u0B3B\\u0B45\\u0B46\\u0B49\\u0B4A\\u0B4E-\\u0B55\\u0B58-\\u0B5B\\u0B5E\\u0B64\\u0B65\\u0B78-\\u0B81\\u0B84\\u0B8B-\\u0B8D\\u0B91\\u0B96-\\u0B98\\u0B9B\\u0B9D\\u0BA0-\\u0BA2\\u0BA5-\\u0BA7\\u0BAB-\\u0BAD\\u0BBA-\\u0BBD\\u0BC3-\\u0BC5\\u0BC9\\u0BCE\\u0BCF\\u0BD1-\\u0BD6\\u0BD8-\\u0BE5\\u0BFB-\\u0C00\\u0C04\\u0C0D\\u0C11\\u0C29\\u0C34\\u0C3A-\\u0C3C\\u0C45\\u0C49\\u0C4E-\\u0C54\\u0C57\\u0C5A-\\u0C5F\\u0C64\\u0C65\\u0C70-\\u0C77\\u0C80\\u0C81\\u0C84\\u0C8D\\u0C91\\u0CA9\\u0CB4\\u0CBA\\u0CBB\\u0CC5\\u0CC9\\u0CCE-\\u0CD4\\u0CD7-\\u0CDD\\u0CDF\\u0CE4\\u0CE5\\u0CF0\\u0CF3-\\u0D01\\u0D04\\u0D0D\\u0D11\\u0D3B\\u0D3C\\u0D45\\u0D49\\u0D4F-\\u0D56\\u0D58-\\u0D5F\\u0D64\\u0D65\\u0D76-\\u0D78\\u0D80\\u0D81\\u0D84\\u0D97-\\u0D99\\u0DB2\\u0DBC\\u0DBE\\u0DBF\\u0DC7-\\u0DC9\\u0DCB-\\u0DCE\\u0DD5\\u0DD7\\u0DE0-\\u0DF1\\u0DF5-\\u0E00\\u0E3B-\\u0E3E\\u0E5C-\\u0E80\\u0E83\\u0E85\\u0E86\\u0E89\\u0E8B\\u0E8C\\u0E8E-\\u0E93\\u0E98\\u0EA0\\u0EA4\\u0EA6\\u0EA8\\u0EA9\\u0EAC\\u0EBA\\u0EBE\\u0EBF\\u0EC5\\u0EC7\\u0ECE\\u0ECF\\u0EDA\\u0EDB\\u0EE0-\\u0EFF\\u0F48\\u0F6D-\\u0F70\\u0F98\\u0FBD\\u0FCD\\u0FDB-\\u0FFF\\u10C6\\u10C8-\\u10CC\\u10CE\\u10CF\\u1249\\u124E\\u124F\\u1257\\u1259\\u125E\\u125F\\u1289\\u128E\\u128F\\u12B1\\u12B6\\u12B7\\u12BF\\u12C1\\u12C6\\u12C7\\u12D7\\u1311\\u1316\\u1317\\u135B\\u135C\\u137D-\\u137F\\u139A-\\u139F\\u13F5-\\u13FF\\u169D-\\u169F\\u16F1-\\u16FF\\u170D\\u1715-\\u171F\\u1737-\\u173F\\u1754-\\u175F\\u176D\\u1771\\u1774-\\u177F\\u17DE\\u17DF\\u17EA-\\u17EF\\u17FA-\\u17FF\\u180F\\u181A-\\u181F\\u1878-\\u187F\\u18AB-\\u18AF\\u18F6-\\u18FF\\u191D-\\u191F\\u192C-\\u192F\\u193C-\\u193F\\u1941-\\u1943\\u196E\\u196F\\u1975-\\u197F\\u19AC-\\u19AF\\u19CA-\\u19CF\\u19DB-\\u19DD\\u1A1C\\u1A1D\\u1A5F\\u1A7D\\u1A7E\\u1A8A-\\u1A8F\\u1A9A-\\u1A9F\\u1AAE-\\u1AFF\\u1B4C-\\u1B4F\\u1B7D-\\u1B7F\\u1BF4-\\u1BFB\\u1C38-\\u1C3A\\u1C4A-\\u1C4C\\u1C80-\\u1CBF\\u1CC8-\\u1CCF\\u1CF7-\\u1CFF\\u1DE7-\\u1DFB\\u1F16\\u1F17\\u1F1E\\u1F1F\\u1F46\\u1F47\\u1F4E\\u1F4F\\u1F58\\u1F5A\\u1F5C\\u1F5E\\u1F7E\\u1F7F\\u1FB5\\u1FC5\\u1FD4\\u1FD5\\u1FDC\\u1FF0\\u1FF1\\u1FF5\\u1FFF\\u200B-\\u200F\\u202A-\\u202E\\u2060-\\u206F\\u2072\\u2073\\u208F\\u209D-\\u209F\\u20BB-\\u20CF\\u20F1-\\u20FF\\u218A-\\u218F\\u23F4-\\u23FF\\u2427-\\u243F\\u244B-\\u245F\\u2700\\u2B4D-\\u2B4F\\u2B5A-\\u2BFF\\u2C2F\\u2C5F\\u2CF4-\\u2CF8\\u2D26\\u2D28-\\u2D2C\\u2D2E\\u2D2F\\u2D68-\\u2D6E\\u2D71-\\u2D7E\\u2D97-\\u2D9F\\u2DA7\\u2DAF\\u2DB7\\u2DBF\\u2DC7\\u2DCF\\u2DD7\\u2DDF\\u2E3C-\\u2E7F\\u2E9A\\u2EF4-\\u2EFF\\u2FD6-\\u2FEF\\u2FFC-\\u2FFF\\u3040\\u3097\\u3098\\u3100-\\u3104\\u312E-\\u3130\\u318F\\u31BB-\\u31BF\\u31E4-\\u31EF\\u321F\\u32FF\\u4DB6-\\u4DBF\\u9FCD-\\u9FFF\\uA48D-\\uA48F\\uA4C7-\\uA4CF\\uA62C-\\uA63F\\uA698-\\uA69E\\uA6F8-\\uA6FF\\uA78F\\uA794-\\uA79F\\uA7AB-\\uA7F7\\uA82C-\\uA82F\\uA83A-\\uA83F\\uA878-\\uA87F\\uA8C5-\\uA8CD\\uA8DA-\\uA8DF\\uA8FC-\\uA8FF\\uA954-\\uA95E\\uA97D-\\uA97F\\uA9CE\\uA9DA-\\uA9DD\\uA9E0-\\uA9FF\\uAA37-\\uAA3F\\uAA4E\\uAA4F\\uAA5A\\uAA5B\\uAA7C-\\uAA7F\\uAAC3-\\uAADA\\uAAF7-\\uAB00\\uAB07\\uAB08\\uAB0F\\uAB10\\uAB17-\\uAB1F\\uAB27\\uAB2F-\\uABBF\\uABEE\\uABEF\\uABFA-\\uABFF\\uD7A4-\\uD7AF\\uD7C7-\\uD7CA\\uD7FC-\\uF8FF\\uFA6E\\uFA6F\\uFADA-\\uFAFF\\uFB07-\\uFB12\\uFB18-\\uFB1C\\uFB37\\uFB3D\\uFB3F\\uFB42\\uFB45\\uFBC2-\\uFBD2\\uFD40-\\uFD4F\\uFD90\\uFD91\\uFDC8-\\uFDEF\\uFDFE\\uFDFF\\uFE1A-\\uFE1F\\uFE27-\\uFE2F\\uFE53\\uFE67\\uFE6C-\\uFE6F\\uFE75\\uFEFD-\\uFF00\\uFFBF-\\uFFC1\\uFFC8\\uFFC9\\uFFD0\\uFFD1\\uFFD8\\uFFD9\\uFFDD-\\uFFDF\\uFFE7\\uFFEF-\\uFFFB\\uFFFE\\uFFFF]/g;\n\n    defineFunction(\"clean\", function(text){\n        return text.replace(RX_NON_PRINTABLE, \"\");\n    }).args([\n        [ \"*text\", \"string\" ]\n    ]);\n\n    defineFunction(\"code\", function(text){\n        return text.charAt(0);\n    }).args([\n        [ \"*text\", \"string\" ]\n    ]);\n\n    defineAlias(\"unichar\", \"char\");\n    defineAlias(\"unicode\", \"code\");\n\n    defineFunction(\"concatenate\", function(args){\n        var out = \"\";\n        for (var i = 0; i < args.length; ++i) {\n            out += args[i];\n        }\n        return out;\n    }).args([\n        [ \"+\",\n          [ \"*text\", \"string\" ] ]\n    ]);\n\n    defineFunction(\"dollar\", function(number, decimals){\n        var format = \"$#,##0DECIMALS;($#,##0DECIMALS)\";\n        var dec = \"\";\n        var denomitator = 1;\n\n        while (decimals-- > 0) {\n          dec += \"0\";\n        }\n\n        while (++decimals < 0) {\n          denomitator *= 10;\n        }\n\n        if (dec !== \"\") {\n          dec = \".\" + dec;\n        } else if (denomitator !== 1) {\n            number = Math.round(number / denomitator) * denomitator;\n        }\n\n        format = format.replace(/DECIMALS/g, dec);\n\n        return spreadsheet.formatting.text(number, format);\n    }).args([\n        [ \"*number\", \"number\" ],\n        [ \"*decimals\", [ \"or\", \"integer\", [ \"null\", 2 ] ] ]\n    ]);\n\n    defineFunction(\"exact\", function(a, b){\n        return a === b;\n    }).args([\n        [ \"*text1\", \"string\" ],\n        [ \"*text2\", \"string\" ]\n    ]);\n\n    defineFunction(\"find\", function(substring, string, start){\n        var pos = string.indexOf(substring, start - 1);\n        return pos < 0 ? new CalcError(\"VALUE\") : pos + 1;\n    }).args([\n        [ \"*substring\", \"string\" ],\n        [ \"*string\", \"string\" ],\n        [ \"*start\", [ \"or\", \"integer++\", [ \"null\", 1 ] ] ]\n    ]);\n\n    defineFunction(\"fixed\", function(number, decimals, noCommas){\n        var scale = Math.pow(10, decimals);\n        number = Math.round(number * scale) / scale;\n        var format = noCommas ? \"0\" : \"#,##0\";\n        if (decimals > 0) {\n            format += \".\";\n            while (decimals-- > 0) { format += \"0\"; }\n        }\n        return spreadsheet.formatting.text(number, format);\n    }).args([\n        [ \"*number\", \"number\" ],\n        [ \"*decimals\", [ \"or\", \"integer\", [ \"null\", 2 ] ] ],\n        [ \"*noCommas\", [ \"or\", \"boolean\", [ \"null\", false ] ] ]\n    ]);\n\n    defineFunction(\"left\", function(text, length){\n        return text.substr(0, length);\n    }).args([\n        [ \"*text\", \"string\" ],\n        [ \"*length\", [ \"or\", \"integer+\", [ \"null\", 1 ] ] ]\n    ]);\n\n    defineFunction(\"right\", function(text, length){\n        return text.substr(-length);\n    }).args([\n        [ \"*text\", \"string\" ],\n        [ \"*length\", [ \"or\", \"integer+\", [ \"null\", 1 ] ] ]\n    ]);\n\n    defineFunction(\"len\", function(text){\n        return text.length;\n    }).args([\n        [ \"*text\", \"string\" ]\n    ]);\n\n    defineFunction(\"lower\", function(text){\n        return text.toLowerCase();\n    }).args([\n        [ \"*text\", \"string\" ]\n    ]);\n\n    defineFunction(\"upper\", function(text){\n        return text.toUpperCase();\n    }).args([\n        [ \"*text\", \"string\" ]\n    ]);\n\n    defineFunction(\"ltrim\", function(text){\n        return text.replace(/^\\s+/, \"\");\n    }).args([\n        [ \"*text\", \"string\" ]\n    ]);\n\n    defineFunction(\"rtrim\", function(text){\n        return text.replace(/\\s+$/, \"\");\n    }).args([\n        [ \"*text\", \"string\" ]\n    ]);\n\n    defineFunction(\"trim\", function(text){\n        return text.replace(/^\\s+|\\s+$/, \"\");\n    }).args([\n        [ \"*text\", \"string\" ]\n    ]);\n\n    defineFunction(\"mid\", function(text, start, length){\n        return text.substr(start - 1, length);\n    }).args([\n        [ \"*text\", \"string\" ],\n        [ \"*start\", \"integer++\" ],\n        [ \"*length\", \"integer+\" ]\n    ]);\n\n    defineFunction(\"proper\", function(text){\n        return text.toLowerCase().replace(/\\b./g, function(s){\n            return s.toUpperCase();\n        });\n    }).args([\n        [ \"*text\", \"string\" ]\n    ]);\n\n    defineFunction(\"replace\", function(text, start, length, newText){\n        return text.substr(0, --start) + newText + text.substr(start + length);\n    }).args([\n        [ \"*text\", \"string\" ],\n        [ \"*start\", \"integer++\" ],\n        [ \"*length\", \"integer+\" ],\n        [ \"*newText\", \"string\" ]\n    ]);\n\n    defineFunction(\"rept\", function(text, number){\n        var out = \"\";\n        while (number-- > 0) { out += text; }\n        return out;\n    }).args([\n        [ \"*text\", \"string\" ],\n        [ \"*number\", \"integer+\" ]\n    ]);\n\n    defineFunction(\"search\", function(substring, string, start){\n        var pos = string.toLowerCase().indexOf(substring.toLowerCase(), start - 1);\n        return pos < 0 ? new CalcError(\"VALUE\") : pos + 1;\n    }).args([\n        [ \"*substring\", \"string\" ],\n        [ \"*string\", \"string\" ],\n        [ \"*start\", [ \"or\", \"integer++\", [ \"null\", 1 ] ] ]\n    ]);\n\n    defineFunction(\"substitute\", function(text, oldText, newText, nth){\n        if (oldText === newText) {\n            return text;\n        }\n        var a = text.split(oldText);\n        if (nth == null) {\n            return a.join(newText);\n        }\n        text = \"\";\n        nth--;\n        for (var i = 0; i < a.length; ++i) {\n            text += a[i];\n            if (i < a.length - 1) {\n                if (i === nth) {\n                    text += newText;\n                } else {\n                    text += oldText;\n                }\n            }\n        }\n        return text;\n    }).args([\n        [ \"*text\", \"string\" ],\n        [ \"*oldText\", \"string\" ],\n        [ \"*newText\", \"string\" ],\n        [ \"*nth\", [ \"or\", \"integer++\", \"null\" ] ]\n    ]);\n\n    defineFunction(\"t\", function(value){\n        return typeof value == \"string\" ? value : \"\";\n    }).args([\n        [ \"*value\", \"anyvalue\" ]\n    ]);\n\n    defineFunction(\"text\", function(value, format){\n        return spreadsheet.formatting.text(value, format);\n    }).args([\n        [ \"*value\", \"anyvalue\" ],\n        [ \"*format\", \"string\" ]\n    ]);\n\n    defineFunction(\"value\", function(value){\n        if (typeof value == \"number\") {\n            return value;\n        }\n        if (typeof value == \"boolean\") {\n            return +value;\n        }\n        // XXX: this is dirty.  we need it so we can parse i.e. \"$12,345.50\"\n        value = (value+\"\").replace(/[$€,]/g, \"\");\n        value = parseFloat(value);\n        return isNaN(value) ? new CalcError(\"VALUE\") : value;\n    }).args([\n        [ \"*value\", \"anyvalue\" ]\n    ]);\n\n    function Hyperlink(link, text) {\n        this.link = link;\n        this.text = text;\n    }\n    Hyperlink.prototype.toString = function() {\n        return this.text;\n    };\n\n    defineFunction(\"hyperlink\", function(link, text){\n        return new Hyperlink(link, text);\n    }).args([\n        [ \"*link\", \"string\" ],\n        [ \"*text\", [ \"or\", \"string\", [ \"null\", \"$link\" ] ] ]\n    ]);\n\n    //// other misc functions\n\n    defineFunction(\"iferror\", function(value, valueIfError){\n        return value instanceof CalcError ? valueIfError : value;\n    }).args([\n        [ \"*value\", \"forced!\" ],\n        [ \"*value_if_error\", \"anyvalue!\" ]\n    ]);\n\n    //// utils\n\n    var parseCriteria = (function(){\n        var RXCACHE = Object.create(null);\n\n        function makeComparator(cmp, x) {\n            if (typeof x == \"string\") {\n                var num = parseFloat(x);\n                if (!isNaN(num) && num == x) {\n                    x = num;\n                }\n            }\n            return function(a) {\n                var b = x;\n                if (typeof a == \"string\" && typeof b == \"string\") {\n                    a = a.toLowerCase();\n                    b = b.toLowerCase();\n                }\n                return cmp(a, b);\n            };\n        }\n\n        function lc(a) {\n            var num, str;\n            if (typeof a == \"string\") {\n                a = a.toLowerCase();\n            }\n            if (/^[0-9.]+%$/.test(a)) {\n                str = a.substr(0, a.length - 1);\n                num = parseFloat(str);\n                if (!isNaN(num) && num == str) {\n                    a = num / 100;\n                }\n            } else if (/^[0-9.]+$/.test(a)) {\n                num = parseFloat(a);\n                if (!isNaN(num) && num == a) {\n                    a = num;\n                }\n            }\n            return a;\n        }\n\n        function compLT(a, b) { return lc(a) < lc(b); }\n        function compLTE(a, b) { return lc(a) <= lc(b); }\n        function compGT(a, b) { return lc(a) > lc(b); }\n        function compGTE(a, b) { return lc(a) >= lc(b); }\n        function compNE(a, b) { return !compEQ(a, b); }\n        function compEQ(a, b) {\n            if (b instanceof RegExp) {\n                return b.test(a);\n            }\n            if (typeof a == \"string\" || typeof b == \"string\") {\n                // if either one is string, make sure both are strings\n                a = String(a);\n                b = String(b);\n            }\n            return lc(a) == lc(b);\n        }\n\n        return function(cmp) {\n            if (typeof cmp == \"function\") {\n                return cmp;\n            }\n            var m;\n            if ((m = /^=(.*)$/.exec(cmp))) {\n                return makeComparator(compEQ, m[1]);\n            }\n            if ((m = /^<>(.*)$/.exec(cmp))) {\n                return makeComparator(compNE, m[1]);\n            }\n            if ((m = /^<=(.*)$/.exec(cmp))) {\n                return makeComparator(compLTE, m[1]);\n            }\n            if ((m = /^<(.*)$/.exec(cmp))) {\n                return makeComparator(compLT, m[1]);\n            }\n            if ((m = /^>=(.*)$/.exec(cmp))) {\n                return makeComparator(compGTE, m[1]);\n            }\n            if ((m = /^>(.*)$/.exec(cmp))) {\n                return makeComparator(compGT, m[1]);\n            }\n            if (/[?*]/.exec(cmp)) {\n                // has wildchars\n                var rx = RXCACHE[cmp];\n                if (!rx) {\n                    rx = cmp.replace(/(~\\?|~\\*|[\\]({\\+\\.\\|\\^\\$\\\\})\\[]|[?*])/g, function(s){\n                        switch (s) {\n                          case \"~?\" : return \"\\\\?\";\n                          case \"~*\" : return \"\\\\*\";\n                          case \"?\"  : return \".\";\n                          case \"*\"  : return \".*\";\n                          default   : return \"\\\\\" + s;\n                        }\n                    });\n                    rx = RXCACHE[cmp] = new RegExp(\"^\" + rx + \"$\", \"i\");\n                }\n                return makeComparator(compEQ, rx);\n            }\n            return makeComparator(compEQ, cmp);\n        };\n    })();\n\n    function numericPredicate(val) {\n        return typeof val == \"number\"\n            || typeof val == \"boolean\"\n            || val == null\n            || val === \"\";\n    }\n\n    function ascending(a, b) {\n        return a === b ? 0 : a < b ? -1 : 1;\n    }\n\n    function descending(a, b) {\n        return a === b ? 0 : a < b ? 1 : -1;\n    }\n\n    // var m = new Matrix();\n    // m.data = [[1, 2, 3], [4, 1, 6], [7, 8, 9]];\n    // //m.data = [[0, 2, 1], [2, 6, 1], [1, 1, 4]];\n    // //m.data = [[1,4,1,1], [1,4,0,1], [2,3,1,2], [3,2,6,4]];\n    // m.width = m.height = 3;\n    // var x = m.inverse();\n    // x.dump();\n\n}, __webpack_require__.amdD);\n\n\n/***/ }),\n\n/***/ 67539:\n/***/ (function(module) {\n\n\"use strict\";\nmodule.exports = require(\"../util/main\");\n\n/***/ }),\n\n/***/ 22360:\n/***/ (function(module) {\n\n\"use strict\";\nmodule.exports = require(\"./runtime\");\n\n/***/ })\n\n/******/ \t});\n/************************************************************************/\n/******/ \t// The module cache\n/******/ \tvar __webpack_module_cache__ = {};\n/******/ \t\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/ \t\t// Check if module is in cache\n/******/ \t\tvar cachedModule = __webpack_module_cache__[moduleId];\n/******/ \t\tif (cachedModule !== undefined) {\n/******/ \t\t\treturn cachedModule.exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = __webpack_module_cache__[moduleId] = {\n/******/ \t\t\t// no module.id needed\n/******/ \t\t\t// no module.loaded needed\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/ \t\n/******/ \t\t// Execute the module function\n/******/ \t\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n/******/ \t\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/ \t\n/************************************************************************/\n/******/ \t/* webpack/runtime/amd define */\n/******/ \t!function() {\n/******/ \t\t__webpack_require__.amdD = function () {\n/******/ \t\t\tthrow new Error('define cannot be used indirect');\n/******/ \t\t};\n/******/ \t}();\n/******/ \t\n/************************************************************************/\n/******/ \t\n/******/ \t// startup\n/******/ \t// Load entry module and return exports\n/******/ \t// This entry module used 'module' so it can't be inlined\n/******/ \tvar __webpack_exports__ = __webpack_require__(53942);\n/******/ \tmodule.exports = __webpack_exports__;\n/******/ \t\n/******/ })()\n;"],"mappings":"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"},"metadata":{},"sourceType":"script"}
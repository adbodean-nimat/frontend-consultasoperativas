{"ast":null,"code":"require(\"core-js/modules/es.error.cause.js\");\n\n/******/\n(function () {\n  // webpackBootstrap\n\n  /******/\n  var __webpack_modules__ = {\n    /***/\n    26929:\n    /***/\n    function (module, exports, __webpack_require__) {\n      var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;\n\n      (function (f, define) {\n        !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(54752), __webpack_require__(97757), __webpack_require__(22360), __webpack_require__(26232), __webpack_require__(81200)], __WEBPACK_AMD_DEFINE_FACTORY__ = f, __WEBPACK_AMD_DEFINE_RESULT__ = typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? __WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__) : __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n      })(function () {\n        (function (kendo) {\n          var RangeRef = kendo.spreadsheet.RangeRef;\n          var UnionRef = kendo.spreadsheet.UnionRef;\n          var CellRef = kendo.spreadsheet.CellRef;\n          var Range = kendo.spreadsheet.Range; // This is a “dynamic variable” (see Greenspun's 10th rule).  It's\n          // bound to an array via sheet._saveModifiedFormulas (which see)\n          // while the callback runs.  The goal is to enable external code\n          // to get a list of formulas or validations that have been\n          // adjusted as an effect of an insert/delete row/column operation,\n          // to be able to undo it.\n          //\n          // The reason why simply saving the state via sheet.getState() or\n          // range.getState() won't suffice is that an insert or delete\n          // operation can have far-reaching effects, like adjusting\n          // formulas from another sheet.\n\n          var MODIFIED_FORMULAS;\n          var Selection = kendo.Class.extend({\n            init: function (sheet) {\n              this._sheet = sheet;\n              this.selection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n              this.originalSelection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n              this._activeCell = kendo.spreadsheet.FIRSTREF.toRangeRef();\n              this.originalActiveCell = kendo.spreadsheet.FIRSTREF;\n            },\n            currentSelectionRange: function () {\n              return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n            currentOriginalNavigationRange: function () {\n              return this.originalSelection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n            currentNavigationRange: function () {\n              if (this.singleCellSelection()) {\n                return this._sheet._sheetRef;\n              } else {\n                return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n              }\n            },\n            nextNavigationRange: function () {\n              if (!this.singleCellSelection()) {\n                this.selectionRangeIndex = this.selection.nextRangeIndex(this.selectionRangeIndex);\n              }\n\n              return this.currentNavigationRange();\n            },\n            previousNavigationRange: function () {\n              if (!this.singleCellSelection()) {\n                this.selectionRangeIndex = this.selection.previousRangeIndex(this.selectionRangeIndex);\n              }\n\n              return this.currentNavigationRange();\n            },\n            activeCell: function (ref) {\n              if (ref) {\n                this.originalActiveCell = ref.first();\n                this._activeCell = this._sheet.unionWithMerged(ref.toRangeRef());\n\n                this._sheet.focus(ref);\n\n                this._sheet.triggerChange({\n                  activeCell: true,\n                  selection: true\n                });\n              }\n\n              return this._activeCell;\n            },\n            select: function (ref, expanded, changeActiveCell, view) {\n              if (ref) {\n                if (ref.eq(this.originalSelection)) {\n                  return;\n                }\n\n                this._sheet.triggerSelect(new Range(ref, this._sheet));\n\n                this.originalSelection = ref;\n                this.selection = expanded;\n\n                if (changeActiveCell !== false) {\n                  if (ref.isCell()) {\n                    // when selecting part of a merged cell, i.e. A1:B2 is merged and select(B2)\n                    // is requested, mark A1 as the actually active cell.\n                    // https://github.com/telerik/kendo/issues/7698\n                    this._sheet.forEachMergedCell(ref, function (merged) {\n                      ref = merged.topLeft;\n                    });\n\n                    this.activeCell(ref);\n                  } else {\n                    ref = this.selection.lastRange();\n\n                    if (view && view._sheet === this._sheet && view.panes[0]) {\n                      // we should intersect this ref with the range that's currently on\n                      // screen, so that the view doesn't scroll (that is, keep the activeCell\n                      // visible) - https://github.com/telerik/kendo-ui-core/issues/5182 —\n                      // XXX: fiddling with View internals here is probably bad practice, but\n                      // this whole thing is a mess already, so it can be forgiven. :-/\n                      var panes = view.panes;\n                      var i, pane, rows, cols, visible, newRef;\n\n                      for (i = 0; i < panes.length; i++) {\n                        pane = panes[i];\n\n                        if (!pane._currentView) {\n                          continue;\n                        }\n\n                        rows = pane._currentView.rows.values;\n                        cols = pane._currentView.columns.values;\n                        visible = new RangeRef(new CellRef(rows.start, cols.start), new CellRef(rows.end, cols.end));\n                        newRef = ref.intersect(visible);\n\n                        if (newRef !== kendo.spreadsheet.NULLREF) {\n                          break;\n                        }\n                      }\n\n                      if (newRef && newRef !== kendo.spreadsheet.NULLREF) {\n                        ref = newRef;\n                      }\n                    }\n\n                    this.activeCell(ref.first());\n                  }\n\n                  this.selectionRangeIndex = this.selection.size() - 1;\n                } else {\n                  this._sheet.triggerChange({\n                    selection: true\n                  });\n                }\n              }\n\n              return this.selection;\n            },\n            singleCellSelection: function () {\n              return this._activeCell.eq(this.selection);\n            }\n          });\n          var Sheet = kendo.Observable.extend({\n            init: function () {\n              kendo.Observable.prototype.init.call(this);\n\n              this._reinit.apply(this, arguments);\n            },\n            events: [\"changing\", \"commandRequest\", \"afterInsertRow\", \"afterDeleteRow\", \"insertRow\", \"insertColumn\", \"deleteRow\", \"deleteColumn\", \"hideRow\", \"hideColumn\", \"unhideRow\", \"unhideColumn\", \"select\", \"dataBinding\", \"dataBound\", \"progress\"],\n            _reinit: function (rowCount, columnCount, rowHeight, columnWidth, headerHeight, headerWidth, defaultCellStyle) {\n              defaultCellStyle = defaultCellStyle || {};\n              this._defaultCellStyle = {\n                background: defaultCellStyle.background,\n                color: defaultCellStyle.color,\n                fontFamily: defaultCellStyle.fontFamily,\n                fontSize: defaultCellStyle.fontSize,\n                italic: defaultCellStyle.italic,\n                bold: defaultCellStyle.bold,\n                underline: defaultCellStyle.underline,\n                wrap: defaultCellStyle.wrap,\n                verticalAlign: defaultCellStyle.verticalAlign,\n                textAlign: defaultCellStyle.textAlign\n              };\n              this._rows = new kendo.spreadsheet.Axis(rowCount, rowHeight);\n              this._columns = new kendo.spreadsheet.Axis(columnCount, columnWidth);\n              this._filteredRows = new kendo.spreadsheet.RangeList(0, rowCount - 1, false);\n              this._mergedCells = [];\n              this._frozenRows = 0;\n              this._frozenColumns = 0;\n              this._suspendChanges = false;\n              this._filter = null;\n              this._showGridLines = true;\n              this._gridLinesColor = null;\n              this._grid = new kendo.spreadsheet.Grid(this._rows, this._columns, rowCount, columnCount, headerHeight, headerWidth);\n              this._sheetRef = this._grid.normalize(kendo.spreadsheet.SHEETREF);\n              this._properties = new kendo.spreadsheet.PropertyBag(rowCount, columnCount, this._defaultCellStyle);\n              this._sorter = new kendo.spreadsheet.Sorter(this._grid, this._properties.sortable());\n              this._viewSelection = new Selection(this);\n              this._editSelection = new Selection(this);\n              this._formulaSelections = [];\n              this._drawings = [];\n            },\n            resize: function (newRows, newCols) {\n              newRows = Math.max(newRows, 1);\n              newCols = Math.max(newCols, 1);\n              var oldRows = this._rows._count;\n              var oldCols = this._columns._count;\n\n              if (newRows < oldRows) {\n                this.range(newRows, 0, oldRows - newRows, oldCols).clear();\n              }\n\n              if (newCols < oldCols) {\n                this.range(0, newCols, oldRows, oldCols - newCols).clear();\n              }\n\n              this._rows._resize(newRows);\n\n              this._columns._resize(newCols);\n\n              this._grid._resize(newRows, newCols);\n\n              this._properties._resize(newRows, newCols);\n\n              this._sheetRef = this._grid.normalize(kendo.spreadsheet.SHEETREF);\n\n              if (newRows > oldRows) {\n                this.range(oldRows, 0, newRows - oldRows, newCols).clear();\n\n                this._filteredRows.value(oldRows, newRows - 1, false);\n              }\n\n              if (newCols > oldCols) {\n                this.range(0, oldCols, newRows, newCols - oldCols).clear();\n              }\n\n              this.triggerChange({\n                layout: true\n              });\n            },\n            _resizeAddRow: function (count) {\n              this.resize(this._rows._count + (count || 1), this._columns._count);\n            },\n            _resizeAddColumn: function (count) {\n              this.resize(this._rows._count, this._columns._count + (count || 1));\n            },\n            _resizeDeleteRow: function (count) {\n              this._resizeAddRow(-(count || 1));\n            },\n            _resizeDeleteColumn: function (count) {\n              this._resizeAddColumn(-(count || 1));\n            },\n            _resizeForJSON: function (rows) {\n              var rowCount = rows.length,\n                  colCount = 0;\n\n              for (var ri = 0; ri < rows.length; ++ri) {\n                var row = rows[ri];\n\n                if (row.index != null) {\n                  rowCount = Math.max(rowCount, row.index + 1);\n                }\n\n                if (row.cells) {\n                  colCount = Math.max(colCount, row.cells.length);\n\n                  for (var ci = 0; ci < row.cells.length; ++ci) {\n                    var cell = row.cells[ci];\n\n                    if (cell.index != null) {\n                      colCount = Math.max(colCount, cell.index + 1);\n                    }\n                  }\n                }\n              }\n\n              this.resize(Math.max(rowCount, this._rows._count), Math.max(colCount, this._columns._count));\n            },\n            _selectionState: function () {\n              return this._inEdit ? this._editSelection : this._viewSelection;\n            },\n            navigator: function () {\n              if (!this._navigator) {\n                this._navigator = new kendo.spreadsheet.SheetNavigator(this);\n              }\n\n              return this._navigator;\n            },\n            axisManager: function () {\n              if (!this._axisManager) {\n                this._axisManager = new kendo.spreadsheet.AxisManager(this);\n              }\n\n              return this._axisManager;\n            },\n            _name: function (value) {\n              if (!value) {\n                return this._sheetName;\n              }\n\n              this._sheetName = value;\n              return this;\n            },\n            name: function () {\n              return this._name();\n            },\n            _property: function (accessor, value, reason) {\n              if (value === undefined) {\n                return accessor();\n              } else {\n                accessor(value);\n                return this.triggerChange(reason);\n              }\n            },\n            _field: function (name, value, reason) {\n              if (value === undefined) {\n                return this[name];\n              } else {\n                this[name] = value;\n                return this.triggerChange(reason);\n              }\n            },\n            suspendChanges: function (value) {\n              if (value === undefined) {\n                return this._suspendChanges;\n              }\n\n              this._suspendChanges = value;\n              return this;\n            },\n            triggerChange: function (reason) {\n              if (!this._suspendChanges) {\n                this.trigger(\"change\", reason);\n              } else if (reason && reason.isValue) {\n                this._valueChanged = true;\n              }\n\n              return this;\n            },\n            triggerSelect: function (range) {\n              this.trigger(\"select\", {\n                range: range\n              });\n            },\n            setDataSource: function (dataSource, columns) {\n              if (this.dataSourceBinder) {\n                this.dataSourceBinder.destroy();\n              }\n\n              this.dataSourceBinder = new kendo.spreadsheet.SheetDataSourceBinder({\n                dataSource: dataSource,\n                sheet: this,\n                columns: columns\n              });\n              this.dataSource = this.dataSourceBinder.dataSource;\n            },\n            hideColumn: function (columnIndex) {\n              if (this.trigger(\"hideColumn\", {\n                index: columnIndex\n              })) {\n                return;\n              }\n\n              return this._property(this._columns.hide.bind(this._columns), columnIndex, {\n                layout: true\n              });\n            },\n            unhideColumn: function (columnIndex) {\n              if (this.trigger(\"unhideColumn\", {\n                index: columnIndex\n              })) {\n                return;\n              }\n\n              return this._property(this._columns.unhide.bind(this._columns), columnIndex, {\n                layout: true\n              });\n            },\n            isHiddenColumn: function (columnIndex) {\n              return this._grid._columns.hidden(columnIndex);\n            },\n            _copyRange: function (sourceRangeRef, targetRef) {\n              var grid = this._grid;\n              var rowCount = grid.rowCount;\n              var nextRefTopLeft = grid.normalize(sourceRangeRef.topLeft);\n              var nextRefBottomRight = grid.normalize(sourceRangeRef.bottomRight);\n              var nextIndex = nextRefTopLeft.col * rowCount + nextRefTopLeft.row;\n              var nextBottomIndex = nextRefBottomRight.col * rowCount + nextRefBottomRight.row;\n              var targetIndex = targetRef.col * rowCount + targetRef.row;\n\n              this._properties.copy(nextIndex, nextBottomIndex, targetIndex);\n            },\n            _saveModifiedFormulas: function (array, callback) {\n              var save = MODIFIED_FORMULAS;\n              MODIFIED_FORMULAS = array;\n              var ret = callback();\n              MODIFIED_FORMULAS = save;\n              return ret;\n            },\n            _restoreModifiedFormulas: function (array) {\n              var wb = this._workbook;\n              array.forEach(function (f) {\n                var sheet = wb.sheetByName(f.sheet),\n                    index;\n\n                if (f instanceof kendo.spreadsheet.calc.runtime.Formula) {\n                  index = sheet._grid.cellRefIndex(f); // f has row, col\n\n                  sheet._properties.set(\"formula\", index, index, f);\n                }\n\n                if (f instanceof kendo.spreadsheet.validation.Validation) {\n                  index = sheet._grid.cellRefIndex(f); // f has row, col\n\n                  sheet._properties.set(\"validation\", index, index, f);\n                }\n              });\n            },\n            _adjustReferences: function (operation, start, delta, mergedCells) {\n              this._mergedCells = mergedCells.reduce(function (a, ref) {\n                ref = ref.adjust(null, null, null, null, operation == \"row\", start, delta);\n\n                if (ref instanceof RangeRef) {\n                  a.push(ref);\n                }\n\n                return a;\n              }, []);\n\n              if (this._workbook) {\n                var affectedSheet = this._name();\n\n                this._workbook._sheets.forEach(function (sheet) {\n                  sheet._forFormulas(function (formula) {\n                    var prev = formula.adjust(affectedSheet, operation, start, delta);\n\n                    if (prev && MODIFIED_FORMULAS) {\n                      // if formula.adjust returns non-null,\n                      // that means the formula was indeed\n                      // modified and the returned value is a\n                      // copy of the previous Formula, which we\n                      // can use for undoing the operation.\n                      MODIFIED_FORMULAS.push(prev);\n                    }\n                  });\n\n                  sheet._forValidations(function (validation) {\n                    var prev = validation.adjust(affectedSheet, operation, start, delta);\n\n                    if (prev && MODIFIED_FORMULAS) {\n                      MODIFIED_FORMULAS.push(prev);\n                    }\n                  });\n                });\n\n                this._workbook.adjustNames(affectedSheet, operation == \"row\", start, delta);\n              }\n\n              var selection = this.select();\n              selection = selection.adjust(null, null, null, null, operation == \"row\", start, delta);\n\n              if (selection !== kendo.spreadsheet.NULLREF) {\n                this.select(selection);\n              } // adjust column widths or row heights and hidden attribute\n\n\n              var axis = operation == \"col\" ? this._columns : this._rows;\n              axis.adjust(start, delta);\n\n              if (operation == \"row\") {\n                if (delta < 0) {\n                  this._filteredRows.copy(start - delta, this._rows._count - 1, start);\n                } else {\n                  this._filteredRows.copy(start, this._rows._count, start + delta);\n\n                  this._filteredRows.value(start, start + delta - 1, false);\n                }\n              } // adjust drawing anchor cells\n\n\n              this._drawings.forEach(function (drawing) {\n                if (drawing.topLeftCell) {\n                  drawing.topLeftCell = drawing.topLeftCell.adjust(null, null, null, null, operation == \"row\", start, delta);\n                }\n              });\n            },\n            _forFormulas: function (callback) {\n              var props = this._properties;\n              var formulas = props.get(\"formula\").values();\n              var n = formulas.length;\n              formulas.forEach(function (f, i) {\n                callback.call(this, f.value, i, n);\n              }, this);\n            },\n            _forValidations: function (callback) {\n              var props = this._properties;\n              props.get(\"validation\").values().forEach(function (v) {\n                callback.call(this, v.value);\n              }, this);\n            },\n            insertRow: function (rowIndex, skipDataSourceInsert) {\n              if (this.trigger(\"insertRow\", {\n                index: rowIndex\n              })) {\n                return;\n              }\n\n              this.batch(function () {\n                this._resizeAddRow();\n\n                var grid = this._grid;\n                var columnCount = grid.columnCount;\n                var rowCount = grid.rowCount;\n\n                if (rowIndex + 1 == rowCount) {\n                  // we just inserted after the last one, no need to shift data\n                  return;\n                }\n\n                var frozenRows = this.frozenRows();\n\n                if (rowIndex < frozenRows) {\n                  this.frozenRows(frozenRows + 1);\n                }\n\n                var mergedCells = this._mergedCells.slice();\n\n                for (var ci = 0; ci < columnCount; ci++) {\n                  var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n                  var topLeft = grid.normalize(ref.topLeft);\n                  var bottomRight = grid.normalize(ref.bottomRight);\n                  var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col), new CellRef(rowCount - 2, bottomRight.col));\n\n                  this._copyRange(nextRef, new CellRef(topLeft.row + 1, topLeft.col));\n\n                  new Range(ref, this).clear({\n                    clearAll: true,\n                    keepBorders: true\n                  });\n                }\n\n                this._adjustReferences(\"row\", rowIndex, 1, mergedCells);\n              }, {\n                recalc: true,\n                layout: true,\n                insertRow: {\n                  index: rowIndex\n                },\n                ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n              });\n\n              if (!skipDataSourceInsert) {\n                this.trigger(\"afterInsertRow\", {\n                  index: rowIndex\n                });\n              }\n\n              return this;\n            },\n            isEnabledRow: function (rowIndex) {\n              var ref = new RangeRef(new CellRef(rowIndex, 0), new CellRef(rowIndex, this._grid.columnCount));\n              return new Range(ref, this).enable();\n            },\n            deleteRow: function (rowIndex, skipDataSourceDelete) {\n              if (!this.isEnabledRow(rowIndex)) {\n                return this;\n              }\n\n              if (this.trigger(\"deleteRow\", {\n                index: rowIndex\n              })) {\n                return;\n              }\n\n              this.batch(function () {\n                var grid = this._grid;\n                var columnCount = grid.columnCount;\n                var frozenRows = this.frozenRows();\n\n                if (rowIndex < frozenRows) {\n                  this.frozenRows(frozenRows - 1);\n                }\n\n                var mergedCells = this._mergedCells.slice();\n\n                for (var ci = 0; ci < columnCount; ci++) {\n                  var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n                  new Range(ref, this).clear({\n                    clearAll: true,\n                    keepBorders: true\n                  });\n                  var topLeft = grid.normalize(ref.topLeft);\n                  var bottomRight = grid.normalize(ref.bottomRight);\n                  var nextRef = new RangeRef(new CellRef(topLeft.row + 1, topLeft.col), new CellRef(Infinity, bottomRight.col));\n\n                  this._copyRange(nextRef, topLeft);\n\n                  var nextRefBottomRight = grid.normalize(nextRef.bottomRight);\n                  new Range(new RangeRef(nextRefBottomRight, nextRefBottomRight), this).clear();\n                }\n\n                this._adjustReferences(\"row\", rowIndex, -1, mergedCells);\n\n                this._resizeDeleteRow();\n              }, {\n                recalc: true,\n                layout: true,\n                deleteRow: {\n                  index: rowIndex\n                },\n                ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n              });\n\n              if (!skipDataSourceDelete) {\n                this.trigger(\"afterDeleteRow\", {\n                  index: rowIndex\n                });\n              }\n\n              return this;\n            },\n            insertColumn: function (columnIndex) {\n              if (this.trigger(\"insertColumn\", {\n                index: columnIndex\n              })) {\n                return;\n              }\n\n              this.batch(function () {\n                this._resizeAddColumn();\n\n                var grid = this._grid;\n                var columnCount = grid.columnCount;\n\n                if (columnIndex + 1 == columnCount) {\n                  // we just inserted after the last one, no need to shift data\n                  return;\n                }\n\n                var frozenColumns = this.frozenColumns();\n\n                if (columnIndex < frozenColumns) {\n                  this.frozenColumns(frozenColumns + 1);\n                }\n\n                var mergedCells = this._mergedCells.slice();\n\n                for (var ci = columnCount; ci >= columnIndex; ci--) {\n                  var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n                  new Range(ref, this).clear({\n                    clearAll: true,\n                    keepBorders: true\n                  });\n\n                  if (ci == columnIndex) {\n                    break;\n                  }\n\n                  var topLeft = grid.normalize(ref.topLeft);\n                  var bottomRight = grid.normalize(ref.bottomRight);\n                  var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col - 1), new CellRef(bottomRight.row, bottomRight.col - 1));\n\n                  this._copyRange(nextRef, topLeft);\n                }\n\n                this._adjustReferences(\"col\", columnIndex, 1, mergedCells);\n              }, {\n                recalc: true,\n                layout: true,\n                insertColumn: {\n                  index: columnIndex\n                },\n                ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n              });\n              return this;\n            },\n            isEnabledColumn: function (columnIndex) {\n              var ref = new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, columnIndex));\n              return new Range(ref, this).enable();\n            },\n            deleteColumn: function (columnIndex) {\n              if (!this.isEnabledColumn(columnIndex)) {\n                return this;\n              }\n\n              if (this.trigger(\"deleteColumn\", {\n                index: columnIndex\n              })) {\n                return;\n              }\n\n              this.batch(function () {\n                var grid = this._grid;\n                var columnCount = grid.columnCount;\n                var frozenColumns = this.frozenColumns();\n\n                if (columnIndex < frozenColumns) {\n                  this.frozenColumns(frozenColumns - 1);\n                }\n\n                var mergedCells = this._mergedCells.slice();\n\n                for (var ci = columnIndex; ci < columnCount; ci++) {\n                  var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n                  new Range(ref, this).clear({\n                    clearAll: true,\n                    keepBorders: true\n                  });\n\n                  if (ci == columnCount - 1) {\n                    break;\n                  }\n\n                  var topLeft = grid.normalize(ref.topLeft);\n                  var bottomRight = grid.normalize(ref.bottomRight);\n                  var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col + 1), new CellRef(bottomRight.row, bottomRight.col + 1));\n\n                  this._copyRange(nextRef, topLeft);\n                }\n\n                this._adjustReferences(\"col\", columnIndex, -1, mergedCells);\n\n                this._resizeDeleteColumn();\n              }, {\n                recalc: true,\n                layout: true,\n                deleteColumn: {\n                  index: columnIndex\n                },\n                ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n              });\n              return this;\n            },\n            _filterRow: function (rowIndex) {\n              this._rows.hide(rowIndex);\n\n              this._filteredRows.value(rowIndex, rowIndex, true);\n\n              this.triggerChange({\n                layout: true\n              });\n            },\n            hideRow: function (rowIndex) {\n              if (this.trigger(\"hideRow\", {\n                index: rowIndex\n              })) {\n                return;\n              }\n\n              return this._property(this._rows.hide.bind(this._rows), rowIndex, {\n                layout: true\n              });\n            },\n            unhideRow: function (rowIndex) {\n              if (this.trigger(\"unhideRow\", {\n                index: rowIndex\n              })) {\n                return;\n              }\n\n              return this._property(this._rows.unhide.bind(this._rows), rowIndex, {\n                layout: true\n              });\n            },\n            isHiddenRow: function (rowIndex) {\n              return this._grid._rows.hidden(rowIndex);\n            },\n            isFilteredRow: function (rowIndex) {\n              return this._filteredRows.value(rowIndex);\n            },\n            columnWidth: function (columnIndex, width) {\n              return this._property(this._columns.value.bind(this._columns, columnIndex, columnIndex), width, {\n                layout: true\n              });\n            },\n            rowHeight: function (rowIndex, height) {\n              return this._property(this._rows.value.bind(this._rows, rowIndex, rowIndex), height, {\n                layout: true\n              });\n            },\n            frozenRows: function (value) {\n              return this._field(\"_frozenRows\", value, {\n                layout: true\n              });\n            },\n            frozenColumns: function (value) {\n              return this._field(\"_frozenColumns\", value, {\n                layout: true\n              });\n            },\n            showGridLines: function (value) {\n              return this._field(\"_showGridLines\", value, {\n                layout: true\n              });\n            },\n            gridLinesColor: function (value) {\n              return this._field(\"_gridLinesColor\", value, {\n                layout: true\n              });\n            },\n            _ref: function (row, column, numRows, numColumns) {\n              var ref = null;\n\n              if (row instanceof kendo.spreadsheet.Ref) {\n                return row;\n              }\n\n              if (row instanceof kendo.spreadsheet.Range) {\n                return row._ref.toRangeRef();\n              }\n\n              if (typeof row === \"string\") {\n                ref = kendo.spreadsheet.calc.parseReference(row);\n              } else {\n                if (!numRows) {\n                  numRows = 1;\n                }\n\n                if (!numColumns) {\n                  numColumns = 1;\n                }\n\n                ref = new RangeRef(new CellRef(row, column), new CellRef(row + numRows - 1, column + numColumns - 1));\n              }\n\n              return ref;\n            },\n            range: function (row, column, numRows, numColumns) {\n              return new Range(this._ref(row, column, numRows, numColumns), this);\n            },\n            _getMergedCells: function (range) {\n              var grid = this._grid;\n              var primary = {};\n              var secondary = {};\n              var hasMerged = false;\n              this.forEachMergedCell(range, function (ref) {\n                var topLeft = ref.topLeft;\n                grid.forEach(ref, function (cellRef) {\n                  if (topLeft.eq(cellRef)) {\n                    primary[cellRef.print()] = ref;\n                    hasMerged = true;\n                  } else if (range.contains(cellRef)) {\n                    secondary[cellRef.print()] = topLeft;\n                    hasMerged = true;\n                  }\n                });\n              });\n              return {\n                primary: primary,\n                secondary: secondary,\n                hasMerged: hasMerged\n              };\n            },\n            forEachMergedCell: function (ref, callback) {\n              var selectAll = false;\n\n              if (typeof callback === \"undefined\") {\n                callback = ref;\n                selectAll = true;\n              }\n\n              this._mergedCells.forEach(function (merged) {\n                if (selectAll || merged.intersects(ref)) {\n                  callback(merged);\n                }\n              });\n            },\n            forEachFilterHeader: function (ref, callback) {\n              var selectAll = false;\n\n              if (typeof callback === \"undefined\") {\n                callback = ref;\n                selectAll = true;\n              }\n\n              if (this._filter) {\n                var refs = []; // get refs of all columns\n\n                this._filter.ref.forEachColumn(function (columnRef) {\n                  if (selectAll || columnRef.intersects(ref)) {\n                    refs.push(columnRef.topLeft);\n                  }\n                }); // filter out merged references\n\n\n                this._mergedCells.forEach(function (merged) {\n                  refs = refs.map(function (ref) {\n                    if (merged.intersects(ref)) {\n                      return merged;\n                    }\n\n                    return ref;\n                  });\n                }); // use only unique refs\n\n\n                refs.reduce(function unique(result, element) {\n                  if (result.indexOf(element) < 0) {\n                    result.push(element);\n                  }\n\n                  return result;\n                }, []).forEach(callback);\n              }\n            },\n            forEach: function (ref, callback) {\n              var self = this;\n\n              function forEachRange(ref) {\n                if (!(ref instanceof RangeRef)) {\n                  ref = ref.toRangeRef();\n                }\n\n                var topLeft = self._grid.normalize(ref.topLeft);\n\n                var bottomRight = self._grid.normalize(ref.bottomRight);\n\n                var ci, ri;\n\n                function doIt(value) {\n                  callback(ri++, ci, value);\n                }\n\n                for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                  ri = topLeft.row;\n\n                  var startCellIndex = self._grid.index(ri, ci);\n\n                  var endCellIndex = self._grid.index(bottomRight.row, ci);\n\n                  self._properties.forEach(startCellIndex, endCellIndex, doIt);\n                }\n              }\n\n              if (!(ref instanceof RangeRef)) {\n                ref = self._ref(ref);\n              }\n\n              if (ref instanceof UnionRef) {\n                // _ref() might still return a UnionRef, for instance, if\n                // `ref` happens to be one.  Probably an oversight, but it\n                // turns out to be useful.\n                ref.forEach(forEachRange);\n              } else {\n                forEachRange(ref);\n              }\n            },\n            startResizing: function (initialPosition) {\n              this._initialPosition = initialPosition;\n              this._resizeInProgress = true;\n            },\n            startAutoFill: function () {\n              this._autoFillInProgress = true;\n              var selection = this.select();\n              this._autoFillOrigin = selection;\n              this._autoFillDest = selection;\n              this.triggerChange({\n                selection: true\n              });\n            },\n            updateAutoFill: function (dest, punch, hint, direction) {\n              this._autoFillDest = dest;\n              this._autoFillPunch = punch;\n              this._autoFillHint = hint;\n              this._autoFillDirection = direction;\n              this.triggerChange({\n                selection: true\n              });\n            },\n            autoFillRef: function () {\n              return this._autoFillDest;\n            },\n            autoFillPunch: function () {\n              return this._autoFillPunch;\n            },\n            autoFillInProgress: function () {\n              return this._autoFillInProgress;\n            },\n            resizingInProgress: function () {\n              return this._resizeInProgress;\n            },\n            draggingInProgress: function () {\n              return this._draggingInProgress;\n            },\n            completeResizing: function () {\n              if (this._resizeInProgress) {\n                this._resizeInProgress = false;\n                var hintPosition = this.resizeHintPosition();\n\n                if (this._initialPosition && hintPosition) {\n                  var handlePosition = this.resizeHandlePosition();\n\n                  if (handlePosition.col !== -Infinity) {\n                    this.trigger(\"commandRequest\", {\n                      command: \"ColumnWidthCommand\",\n                      options: {\n                        target: handlePosition.col,\n                        value: this.columnWidth(handlePosition.col) - (this._initialPosition.x - hintPosition.x)\n                      }\n                    });\n                  } else {\n                    this.trigger(\"commandRequest\", {\n                      command: \"RowHeightCommand\",\n                      options: {\n                        target: handlePosition.row,\n                        value: this.rowHeight(handlePosition.row) - (this._initialPosition.y - hintPosition.y)\n                      }\n                    });\n                  }\n                } else {\n                  this.trigger(\"change\", {\n                    resize: true\n                  });\n                }\n              }\n            },\n            _visualRange: function (ref) {\n              var merged = this._mergedCells;\n\n              for (var i = merged.length; --i >= 0;) {\n                if (merged[i].intersects(ref)) {\n                  return this.range(merged[i]);\n                }\n              }\n\n              return this.range(ref);\n            },\n            _renderComment: function (ref) {\n              var comment = null;\n\n              if (ref) {\n                var range = this._visualRange(ref);\n\n                comment = range.comment();\n                ref = range._ref.toRangeRef().topLeft;\n              }\n\n              if (comment) {\n                if (!this._commentRef || !ref.eq(this._commentRef)) {\n                  this._commentRef = ref;\n                  this.trigger(\"change\", {\n                    comment: true\n                  });\n                }\n              } else {\n                if (this._commentRef) {\n                  this._commentRef = null;\n                  this.trigger(\"change\", {\n                    comment: true\n                  });\n                }\n              }\n            },\n            resizeHandlePosition: function () {\n              return this._resizeHandlePosition;\n            },\n            resizeHintPosition: function (location) {\n              if (location !== undefined) {\n                this._resizeHintPosition = location;\n                this.trigger(\"change\", {\n                  resize: true\n                });\n              }\n\n              return this._resizeHintPosition;\n            },\n            removeResizeHandle: function () {\n              if (this._resizeHandlePosition) {\n                this._resizeHintPosition = undefined;\n                this._resizeHandlePosition = undefined;\n                this._initialPosition = undefined;\n                this.trigger(\"change\", {\n                  resize: true\n                });\n              }\n            },\n            positionResizeHandle: function (ref) {\n              this._resizeHandlePosition = ref;\n              this.trigger(\"change\", {\n                resize: true\n              });\n            },\n            startDragging: function (data) {\n              this._draggingInProgress = data;\n            },\n            completeDragging: function () {\n              var drag = this._draggingInProgress;\n\n              if (drag) {\n                this._draggingInProgress = null;\n                var drawing = drag.drawing;\n\n                if (drawing.eq(drag.copy)) {\n                  return;\n                }\n\n                if (drawing.topLeftCell) {\n                  // adjust reference - in case the top-left corner\n                  // was moving, select the cell beneath it.\n                  var box = this.drawingBoundingBox(drawing);\n\n                  var row = this._rows.indexVisible(box.top);\n\n                  var col = this._columns.indexVisible(box.left);\n\n                  var ref = new CellRef(row, col);\n                  var refBox = this.refBoundingBox(ref);\n                  drawing.offsetX = box.left - refBox.left;\n                  drawing.offsetY = box.top - refBox.top;\n                  drawing.topLeftCell = ref;\n                  this.triggerChange({\n                    dragging: true\n                  });\n                }\n\n                this.trigger(\"commandRequest\", {\n                  command: \"DrawingUpdateCommand\",\n                  options: {\n                    sheet: this,\n                    drawing: drawing,\n                    previous: drag.copy\n                  }\n                });\n              }\n            },\n            startSelection: function (view) {\n              if (this.frozenRows() || this.frozenColumns()) {\n                this._currentView = null;\n              } else if (view && view._sheet === this) {\n                this._currentView = view;\n              }\n\n              this._selectionInProgress = true;\n            },\n            completeSelection: function () {\n              if (this._selectionInProgress) {\n                this._selectionInProgress = false;\n                this._resizeHintPosition = undefined;\n                this.trigger(\"change\", {\n                  selection: true\n                });\n              }\n\n              if (this._autoFillInProgress) {\n                this._autoFillInProgress = false;\n                var dest = this._autoFillDest;\n                var origin = this._autoFillOrigin;\n\n                if (this._autoFillPunch) {\n                  // we just clear data here\n                  this.trigger(\"commandRequest\", {\n                    command: \"ClearContentCommand\",\n                    options: {\n                      operatingRange: this.range(this._autoFillPunch)\n                    }\n                  });\n                } else {\n                  if (!dest.eq(origin)) {\n                    this.trigger(\"commandRequest\", {\n                      command: \"AutoFillCommand\",\n                      options: {\n                        operatingRange: this.range(dest),\n                        origin: this.range(origin)\n                      }\n                    });\n                  } else {\n                    this.triggerChange({\n                      selection: true\n                    });\n                  }\n                }\n\n                this._autoFillDest = null;\n                this._autoFillPunch = null;\n                this._autoFillOrigin = null;\n                this.select(dest);\n              }\n            },\n            selectionInProgress: function () {\n              return this._selectionInProgress;\n            },\n            select: function (ref, changeActiveCell) {\n              var selectionState = this._selectionState();\n\n              var expandedRef;\n\n              if (ref) {\n                ref = this._ref(ref);\n                ref = this._grid.normalize(ref);\n                expandedRef = this._grid.isAxis(ref) ? ref : this.unionWithMerged(ref);\n              }\n\n              return selectionState.select(ref, expandedRef, changeActiveCell, this._currentView);\n            },\n            originalSelect: function () {\n              return this._selectionState().originalSelection;\n            },\n            currentSelectionRange: function () {\n              return this._selectionState().currentSelectionRange();\n            },\n            currentOriginalSelectionRange: function () {\n              return this._selectionState().currentOriginalNavigationRange();\n            },\n            currentNavigationRange: function () {\n              return this._selectionState().currentNavigationRange();\n            },\n            nextNavigationRange: function () {\n              return this._selectionState().nextNavigationRange();\n            },\n            previousNavigationRange: function () {\n              return this._selectionState().previousNavigationRange();\n            },\n            selectionRangeIndex: function () {\n              return this._selectionState().selectionRangeIndex;\n            },\n            activeCell: function (ref) {\n              return this._selectionState().activeCell(ref);\n            },\n            originalActiveCell: function () {\n              return this._selectionState().originalActiveCell;\n            },\n            singleCellSelection: function () {\n              return this._selectionState().singleCellSelection();\n            },\n            unionWithMerged: function (ref) {\n              var mergedCells = this._mergedCells;\n              return ref.map(function (ref) {\n                return ref.toRangeRef().union(mergedCells);\n              });\n            },\n            trim: function (ref) {\n              var trims = [];\n              var grid = this._grid;\n\n              this._properties.forEachProperty(function (property) {\n                trims.push(grid.trim(ref, property.list));\n              });\n\n              return this.unionWithMerged(ref.topLeft.toRangeRef().union(trims));\n            },\n            focus: function (ref) {\n              if (ref) {\n                this._focus = ref.toRangeRef();\n              } else {\n                var focus = this._focus;\n                this._focus = null;\n                return focus;\n              }\n            },\n            activeCellSelection: function () {\n              return new Range(this._grid.normalize(this.activeCell()), this);\n            },\n            selection: function () {\n              return new Range(this._grid.normalize(this._selectionState().selection), this);\n            },\n            selectedHeaders: function () {\n              var selection = this.select();\n              var rows = {};\n              var cols = {};\n              var allCols = false;\n              var allRows = false;\n              var maxRow = this._grid.rowCount - 1;\n              var maxCol = this._grid.columnCount - 1;\n              selection.forEach(function (ref) {\n                var i;\n                var rowState = \"partial\";\n                var colState = \"partial\";\n                ref = ref.toRangeRef();\n                var bottomRight = ref.bottomRight;\n                var topLeft = ref.topLeft;\n                var rowSelection = topLeft.col <= 0 && bottomRight.col >= maxCol;\n                var colSelection = topLeft.row <= 0 && bottomRight.row >= maxRow;\n\n                if (colSelection) {\n                  //column selection\n                  allRows = true;\n                  colState = \"full\";\n                }\n\n                if (rowSelection) {\n                  //row selection\n                  allCols = true;\n                  rowState = \"full\";\n                }\n\n                if (!colSelection) {\n                  //column selection\n                  for (i = topLeft.row; i <= bottomRight.row; i++) {\n                    if (rows[i] !== \"full\") {\n                      rows[i] = rowState;\n                    }\n                  }\n                }\n\n                if (!rowSelection) {\n                  for (i = topLeft.col; i <= bottomRight.col; i++) {\n                    if (cols[i] !== \"full\") {\n                      cols[i] = colState;\n                    }\n                  }\n                }\n              });\n              return {\n                rows: rows,\n                cols: cols,\n                allRows: allRows,\n                allCols: allCols,\n                all: allRows && allCols\n              };\n            },\n            isInEditMode: function (isInEdit) {\n              if (isInEdit === undefined) {\n                return this._inEdit;\n              }\n\n              this._inEdit = isInEdit;\n\n              if (isInEdit) {\n                this._editSelection.selection = this._viewSelection.selection.clone();\n                this._editSelection.originalSelection = this._viewSelection.originalSelection.clone();\n                this._editSelection._activeCell = this._viewSelection._activeCell.clone();\n                this._editSelection.originalActiveCell = this._viewSelection.originalActiveCell.clone();\n              }\n            },\n            _setFormulaSelections: function (selection) {\n              this._formulaSelections = (selection || []).slice();\n              this.triggerChange({\n                selection: true\n              });\n            },\n            _viewActiveCell: function () {\n              return this._viewSelection._activeCell.toRangeRef();\n            },\n            toJSON: function () {\n              var positions = {};\n\n              var rows = this._rows.toJSON(\"height\", positions);\n\n              var columns = this._columns.toJSON(\"width\", {});\n\n              var viewSelection = this._viewSelection;\n              var hyperlinks = [];\n              var defaultCellStyle = this._defaultCellStyle || {};\n\n              function clearDefaultStyle(cell) {\n                Object.keys(defaultCellStyle).forEach(function (key) {\n                  if (cell[key] === defaultCellStyle[key]) {\n                    delete cell[key];\n                  }\n                });\n              }\n\n              this.forEach(kendo.spreadsheet.SHEETREF, function (row, col, cell) {\n                clearDefaultStyle(cell);\n\n                if (Object.keys(cell).length === 0) {\n                  return;\n                }\n\n                if (cell.link) {\n                  hyperlinks.push({\n                    ref: kendo.spreadsheet.Ref.display(null, row, col),\n                    target: cell.link\n                  });\n                }\n\n                var position = positions[row];\n\n                if (position === undefined) {\n                  position = rows.length;\n                  rows.push({\n                    index: row\n                  });\n                  positions[row] = position;\n                }\n\n                row = rows[position];\n                cell.index = col;\n\n                if (row.cells === undefined) {\n                  row.cells = [];\n                }\n\n                if (cell.formula) {\n                  // stringify Formula object.\n                  if (cell.formula.arrayFormulaRange) {\n                    cell.formula = {\n                      src: cell.formula.toString(),\n                      ref: cell.formula.arrayFormulaRange.toString()\n                    };\n                  } else {\n                    cell.formula = cell.formula.toString();\n                  }\n                }\n\n                if (cell.validation) {\n                  cell.validation = cell.validation.toJSON();\n                }\n\n                if (cell.color) {\n                  cell.color = kendo.parseColor(cell.color).toCss();\n                }\n\n                if (cell.background) {\n                  cell.background = kendo.parseColor(cell.background).toCss();\n                }\n\n                if (cell.borderTop && cell.borderTop.color) {\n                  cell.borderTop.color = kendo.parseColor(cell.borderTop.color).toCss();\n                }\n\n                if (cell.borderBottom && cell.borderBottom.color) {\n                  cell.borderBottom.color = kendo.parseColor(cell.borderBottom.color).toCss();\n                }\n\n                if (cell.borderRight && cell.borderRight.color) {\n                  cell.borderRight.color = kendo.parseColor(cell.borderRight.color).toCss();\n                }\n\n                if (cell.borderLeft && cell.borderLeft.color) {\n                  cell.borderLeft.color = kendo.parseColor(cell.borderLeft.color).toCss();\n                }\n\n                row.cells.push(cell);\n              });\n              var json = {\n                name: this._name(),\n                rows: rows,\n                columns: columns,\n                selection: viewSelection.selection.toString(),\n                activeCell: viewSelection.activeCell().toString(),\n                frozenRows: this.frozenRows(),\n                frozenColumns: this.frozenColumns(),\n                showGridLines: this.showGridLines(),\n                gridLinesColor: this.gridLinesColor(),\n                mergedCells: this._mergedCells.map(function (ref) {\n                  return ref.toString();\n                }),\n                hyperlinks: hyperlinks,\n                defaultCellStyle: defaultCellStyle,\n                drawings: this._drawings.map(function (dr) {\n                  return dr.toJSON();\n                })\n              };\n\n              if (this._sort) {\n                json.sort = {\n                  ref: this._sort.ref.toString(),\n                  columns: this._sort.columns.map(function (column) {\n                    return {\n                      index: column.index,\n                      ascending: column.ascending\n                    };\n                  })\n                };\n              }\n\n              if (this._filter) {\n                json.filter = {\n                  ref: this._filter.ref.toString(),\n                  columns: this._filter.columns.map(function (column) {\n                    var filter = column.filter.toJSON();\n                    filter.index = column.index;\n                    return filter;\n                  })\n                };\n              }\n\n              return json;\n            },\n            fromJSON: function (json) {\n              this.batch(function () {\n                if (json.name !== undefined) {\n                  this._name(json.name);\n                }\n\n                if (json.frozenColumns !== undefined) {\n                  this.frozenColumns(json.frozenColumns);\n                }\n\n                if (json.frozenRows !== undefined) {\n                  this.frozenRows(json.frozenRows);\n                }\n\n                if (json.columns !== undefined) {\n                  this._columns.fromJSON(\"width\", json.columns);\n                }\n\n                if (json.rows !== undefined) {\n                  this._resizeForJSON(json.rows);\n\n                  this._rows.fromJSON(\"height\", json.rows);\n\n                  for (var ri = 0; ri < json.rows.length; ri++) {\n                    var row = json.rows[ri];\n                    var rowIndex = row.index;\n\n                    if (rowIndex === undefined) {\n                      rowIndex = ri;\n                    }\n\n                    if (row.cells) {\n                      for (var ci = 0; ci < row.cells.length; ci++) {\n                        var cell = row.cells[ci];\n                        var columnIndex = cell.index;\n\n                        if (columnIndex === undefined) {\n                          columnIndex = ci;\n                        }\n\n                        if (cell.formula) {\n                          var isArray = typeof cell.formula != \"string\";\n                          var src = isArray ? cell.formula.src : cell.formula;\n\n                          var formula = this._compileFormula(rowIndex, columnIndex, src);\n\n                          if (isArray) {\n                            formula.setArrayFormulaRange(kendo.spreadsheet.calc.parseReference(cell.formula.ref));\n                          }\n\n                          cell.formula = formula;\n                        }\n\n                        if (cell.validation) {\n                          cell.validation = this._compileValidation(rowIndex, columnIndex, cell.validation);\n                        }\n\n                        this._properties.fromJSON(this._grid.index(rowIndex, columnIndex), cell);\n                      }\n                    }\n                  }\n                }\n\n                if (json.drawings) {\n                  this._drawings = json.drawings.map(Drawing.fromJSON);\n                }\n\n                if (json.selection) {\n                  this._viewSelection.selection = this._viewSelection.originalSelection = this._ref(json.selection);\n                }\n\n                if (json.activeCell) {\n                  var activeCellRef = this._ref(json.activeCell);\n\n                  this._viewSelection._activeCell = activeCellRef.toRangeRef();\n                  this._viewSelection.originalActiveCell = activeCellRef.first();\n                }\n\n                if (json.mergedCells) {\n                  json.mergedCells.forEach(function (ref) {\n                    this.range(ref).merge();\n                  }, this);\n                }\n\n                if (json.sort) {\n                  this._sort = {\n                    ref: this._ref(json.sort.ref),\n                    columns: json.sort.columns.slice(0)\n                  };\n                }\n\n                if (json.filter) {\n                  var ref = json.filter.ref;\n                  var columns = json.filter.columns === undefined ? [] : json.filter.columns;\n\n                  if (!ref) {\n                    kendo.logToConsole(\"Dropping filter for sheet '\" + json.name + \"' due to missing ref\");\n                  } else {\n                    this._filter = {\n                      ref: this._ref(ref),\n                      columns: columns.map(function (column) {\n                        return {\n                          index: column.index,\n                          filter: kendo.spreadsheet.Filter.create(column)\n                        };\n                      })\n                    };\n\n                    this._refreshFilter();\n                  }\n                }\n\n                if (json.showGridLines !== undefined) {\n                  this._showGridLines = json.showGridLines;\n                }\n\n                this._gridLinesColor = json.gridLinesColor;\n              });\n\n              this._rows._refresh();\n\n              this._columns._refresh();\n            },\n            formula: function (ref) {\n              return this._properties.get(\"formula\", this._grid.cellRefIndex(ref));\n            },\n            validation: function (ref) {\n              return this._properties.get(\"validation\", this._grid.cellRefIndex(ref));\n            },\n            // NOTE: resetFormulas should be called first.  We don't do it in this\n            // function because it should be done from the Workbook object for all\n            // sheets.\n            resetFormulas: function () {\n              this._forFormulas(function (formula) {\n                formula.reset();\n              });\n            },\n            resetValidations: function () {\n              this._forValidations(function (validation) {\n                validation.reset();\n              });\n            },\n            recalc: function (context, callback) {\n              var formulas = this._properties.get(\"formula\").values();\n\n              var count = formulas.length,\n                  pending = 0,\n                  i = 0;\n\n              if (!count && callback) {\n                return callback();\n              }\n\n              function next() {\n                pending--;\n\n                if (i == count && !pending) {\n                  callback();\n                }\n              }\n\n              while (i < count) {\n                pending++;\n                formulas[i++].value.exec(context, callback ? next : null);\n              }\n            },\n            revalidate: function (context) {\n              var self = this;\n\n              this._forValidations(function (validation) {\n                var cellRef = new CellRef(validation.row, validation.col);\n                var ref = new RangeRef(cellRef, cellRef);\n                validation.exec(context, self._get(ref, \"value\"), self._get(ref, \"format\"));\n              });\n            },\n            _value: function (row, col, value) {\n              var index = this._grid.index(row, col);\n\n              if (value !== undefined) {\n                this._properties.set(\"value\", index, index, value);\n              } else {\n                return this._properties.get(\"value\", index);\n              }\n            },\n            _validation: function (row, col) {\n              var index = this._grid.index(row, col);\n\n              return this._properties.get(\"validation\", index);\n            },\n            _compileValidation: function (row, col, validation) {\n              if (validation instanceof kendo.spreadsheet.validation.Validation) {\n                // do not alter an existing object.\n                return validation.clone(this._name(), row, col);\n              }\n\n              if (validation.from != null) {\n                validation.from = (validation.from + \"\").replace(/^=/, \"\");\n              }\n\n              if (validation.to != null) {\n                validation.to = (validation.to + \"\").replace(/^=/, \"\");\n              }\n\n              return kendo.spreadsheet.validation.compile(this._name(), row, col, validation);\n            },\n            _compileFormula: function (row, col, f) {\n              f = f.replace(/^=/, \"\");\n              f = kendo.spreadsheet.calc.parseFormula(this._name(), row, col, f);\n              return kendo.spreadsheet.calc.compile(f);\n            },\n            _copyValuesInRange: function (topLeft, bottomRight, value, property) {\n              var ci, start, end;\n\n              for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                start = this._grid.index(topLeft.row, ci);\n                end = this._grid.index(bottomRight.row, ci);\n\n                for (var index = start, row = topLeft.row; index <= end; ++index, ++row) {\n                  // Even if it's the same formula in multiple cells, we\n                  // need to have different Formula objects, hence cloning\n                  // it.  Don't worry, clone() is fast.\n                  value = value.clone(this._name(), row, ci);\n\n                  this._properties.set(property, index, index, value);\n                }\n              }\n\n              return value;\n            },\n            _set: function (ref, name, value) {\n              var topLeft = this._grid.normalize(ref.topLeft);\n\n              var bottomRight = this._grid.normalize(ref.bottomRight);\n\n              var ci, start, end;\n\n              if (typeof value == \"number\") {\n                // Apparently, Excel (and LibreOffice and Google\n                // Sheets) will limit precision to 14 digits; type:\n                // -4.2524999999999995 and you get -4.2525.  The\n                // formula engine already does something similar for\n                // intermediate formula results, but we must do it\n                // here as well for original input values.\n                value = kendo.spreadsheet.calc.runtime.limitPrecision(value);\n              }\n\n              if (value && name == \"formula\") {\n                if (typeof value == \"string\") {\n                  // get Formula object.  we don't care about handling errors\n                  // here since it won't be called interactively.\n                  value = this._compileFormula(topLeft.row, topLeft.col, value);\n                }\n\n                value = this._copyValuesInRange(topLeft, bottomRight, value, \"formula\");\n              } else if (value && name == \"validation\") {\n                value = this._compileValidation(topLeft.row, topLeft.col, value);\n                value = this._copyValuesInRange(topLeft, bottomRight, value, \"validation\");\n              } else {\n                for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                  start = this._grid.index(topLeft.row, ci);\n                  end = this._grid.index(bottomRight.row, ci);\n\n                  this._properties.set(name, start, end, value);\n\n                  if (name == \"formula\") {\n                    // removing a formula, must clear value.\n                    this._properties.set(\"value\", start, end, null);\n                  }\n                }\n              }\n            },\n            _get: function (ref, name) {\n              var topLeft = this._grid.normalize(ref.topLeft);\n\n              var index = this._grid.index(topLeft.row, topLeft.col);\n\n              return this._properties.get(name, index);\n            },\n            batch: function (callback, reason) {\n              var suspended = this.suspendChanges();\n              this.suspendChanges(true);\n              this._valueChanged = false;\n              callback.call(this);\n\n              if (!reason) {\n                reason = {\n                  recalc: true\n                };\n              }\n\n              if (this._valueChanged) {\n                reason.isValue = true;\n              }\n\n              return this.suspendChanges(suspended).triggerChange(reason);\n            },\n            _sortBy: function (ref, columns) {\n              var indices = null;\n              columns.forEach(function (column) {\n                indices = this._sorter.sortBy(ref, column.index, this._properties.get(\"value\"), column.ascending, indices);\n              }, this);\n              this._sort = {\n                ref: ref,\n                columns: columns\n              };\n\n              this._refreshFilter();\n\n              this.forEach(ref, function (row, col, props) {\n                var formula = props.formula;\n\n                if (formula) {\n                  var diff = row - formula.row;\n\n                  if (diff !== 0) {\n                    var start = diff > 0 ? formula.row : formula.row + diff;\n                    formula.adjust(this.name(), \"row\", start, diff);\n                  }\n                }\n              }.bind(this));\n              this.triggerChange({\n                recalc: true\n              });\n            },\n            _refreshFilter: function () {\n              if (this._filter) {\n                this._filterBy(this._filter.ref, this._filter.columns);\n              }\n            },\n            _filterBy: function (ref, columns) {\n              this.batch(function () {\n                for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                  if (this.isFilteredRow(ri)) {\n                    this._filteredRows.value(ri, ri, false);\n\n                    this._rows.unhide(ri);\n                  }\n                }\n\n                columns.forEach(function (column) {\n                  // do not filter header row\n                  var columnRef = ref.resize({\n                    top: 1\n                  }).toColumn(column.index);\n                  var cells = [];\n\n                  if (columnRef === kendo.spreadsheet.NULLREF) {\n                    return;\n                  }\n\n                  this.forEach(columnRef, function (row, col, cell) {\n                    cell.row = row;\n                    cells.push(cell);\n                  });\n                  column.filter.prepare(cells);\n\n                  for (var ci = 0; ci < cells.length; ci++) {\n                    var cell = cells[ci];\n                    var value = column.filter.value(cell);\n\n                    if (column.filter.matches(value) === false) {\n                      this._filterRow(cell.row);\n                    }\n                  }\n                }, this);\n                this._filter = {\n                  ref: ref,\n                  columns: columns\n                };\n              }, {\n                recalc: true,\n                layout: true,\n                filter: true\n              });\n            },\n            filterColumn: function (ref) {\n              var filterRef = this.filter().ref;\n              return ref.toRangeRef().topLeft.col - filterRef.topLeft.col;\n            },\n            filter: function () {\n              return this._filter;\n            },\n            clearFilter: function (spec) {\n              this._clearFilter(spec instanceof Array ? spec : [spec]);\n            },\n            _clearFilter: function (indices) {\n              if (this._filter) {\n                this.batch(function () {\n                  this._filter.columns = this._filter.columns.filter(function (column) {\n                    return indices.indexOf(column.index) < 0;\n                  });\n\n                  this._refreshFilter();\n                }, {\n                  recalc: true,\n                  layout: true,\n                  filter: true\n                });\n              }\n            },\n            getAxisState: function () {\n              return {\n                rows: this._rows.getState(),\n                columns: this._columns.getState()\n              };\n            },\n            setAxisState: function (state) {\n              this._rows.setState(state.rows);\n\n              this._columns.setState(state.columns);\n\n              this.triggerChange({\n                layout: true\n              });\n            },\n            getState: function () {\n              return {\n                rows: this._rows.getState(),\n                columns: this._columns.getState(),\n                mergedCells: this._mergedCells.map(function (cell) {\n                  return cell.clone();\n                }),\n                properties: this._properties.getState()\n              };\n            },\n            setState: function (state) {\n              this._rows.setState(state.rows);\n\n              this._columns.setState(state.columns);\n\n              this._mergedCells = state.mergedCells;\n\n              this._properties.setState(state.properties);\n\n              this.triggerChange(kendo.spreadsheet.ALL_REASONS);\n            },\n            _merge: function (ref) {\n              var mergedCells = this._mergedCells;\n              var sheet = this;\n              var mergedRef;\n              this.batch(function () {\n                mergedRef = ref.map(function (ref) {\n                  if (ref instanceof kendo.spreadsheet.CellRef) {\n                    return ref;\n                  }\n\n                  var currentRef = ref.toRangeRef().union(mergedCells, function (ref) {\n                    mergedCells.splice(mergedCells.indexOf(ref), 1);\n                  });\n                  var range = new Range(currentRef, sheet);\n\n                  var formula = range._get(\"formula\");\n\n                  var value = range.value();\n                  var format = range.format();\n                  var background = range.background();\n                  range.value(null);\n                  range.format(null);\n                  range.background(null);\n                  var topLeft = new Range(currentRef.collapse(), sheet);\n\n                  if (formula) {\n                    topLeft._set(\"formula\", formula);\n                  } else {\n                    topLeft.value(value);\n                  }\n\n                  topLeft.format(format);\n                  topLeft.background(background);\n                  mergedCells.push(currentRef);\n                  return currentRef;\n                });\n                var viewSelection = sheet._viewSelection;\n                viewSelection.selection = sheet.unionWithMerged(viewSelection.originalSelection);\n                viewSelection._activeCell = sheet.unionWithMerged(viewSelection.originalActiveCell);\n              }, {\n                activeCell: true,\n                selection: true\n              });\n              return mergedRef;\n            },\n            _useCultureDecimals: function () {\n              return this._workbook && this._workbook.options.useCultureDecimals;\n            },\n            withCultureDecimals: function (f) {\n              var dot = \".\";\n\n              if (this._useCultureDecimals()) {\n                dot = kendo.culture().numberFormat[\".\"];\n              }\n\n              return kendo.spreadsheet.calc.withDecimalSeparator(dot, f);\n            },\n            drawingBoundingBox: function (drawing) {\n              var left = drawing.offsetX;\n              var top = drawing.offsetY;\n\n              if (drawing.topLeftCell) {\n                // offsets are relative to cell\n                left += this._columns.sum(0, drawing.topLeftCell.col - 1);\n                top += this._rows.sum(0, drawing.topLeftCell.row - 1);\n              }\n\n              return new kendo.spreadsheet.Rectangle(left, top, drawing.width, drawing.height);\n            },\n            refBoundingBox: function (ref) {\n              return this._grid.rectangle(ref.toRangeRef());\n            },\n            addDrawing: function (drw, activate) {\n              if (!(drw instanceof Drawing)) {\n                drw = new Drawing(drw);\n              }\n\n              this._drawings.push(drw);\n\n              if (activate) {\n                this._activeDrawing = drw;\n              }\n\n              this.triggerChange({\n                layout: true\n              });\n              return drw;\n            },\n            removeDrawing: function (drawing) {\n              var pos = this._drawings.indexOf(drawing);\n\n              if (pos >= 0) {\n                this._drawings.splice(pos, 1);\n\n                this.triggerChange({\n                  layout: true\n                });\n              }\n            },\n            usesImage: function (img) {\n              for (var i = this._drawings.length; --i >= 0;) {\n                if (this._drawings[i].image === img) {\n                  return true;\n                }\n              }\n\n              return false;\n            },\n            isMerged: function (ref) {\n              var merged = this._mergedCells;\n\n              for (var i = merged.length; --i >= 0;) {\n                if (merged[i].eq(ref)) {\n                  return true;\n                }\n              }\n\n              return false;\n            }\n          });\n          var Drawing = kendo.Class.extend({\n            init: function Drawing(args) {\n              this.reset(args);\n            },\n            toJSON: function () {\n              return {\n                topLeftCell: this.topLeftCell.toString(),\n                offsetX: this.offsetX,\n                offsetY: this.offsetY,\n                width: this.width,\n                height: this.height,\n                image: this.image,\n                opacity: this.opacity\n              };\n            },\n            clone: function () {\n              return new Drawing(this);\n            },\n            reset: function (dr) {\n              var anchor = dr.topLeftCell;\n\n              if (typeof anchor == \"string\") {\n                anchor = kendo.spreadsheet.calc.parseReference(anchor);\n              }\n\n              this.topLeftCell = anchor;\n              this.offsetX = dr.offsetX || 0;\n              this.offsetY = dr.offsetY || 0;\n              this.width = dr.width;\n              this.height = dr.height;\n              this.image = dr.image;\n              this.opacity = dr.opacity != null ? dr.opacity : 1;\n            },\n            eq: function (dr) {\n              return (!this.topLeftCell && !dr.topLeftCell || this.topLeftCell && dr.topLeftCell && this.topLeftCell.eq(dr.topLeftCell)) && this.offsetX === dr.offsetX && this.offsetY === dr.offsetY && this.width === dr.width && this.height === dr.height && this.image === dr.image && this.opacity === dr.opacity;\n            }\n          });\n\n          Drawing.fromJSON = function (args) {\n            return new Drawing(args);\n          };\n\n          kendo.spreadsheet.Sheet = Sheet;\n          kendo.spreadsheet.Drawing = Drawing;\n        })(kendo);\n      }, __webpack_require__.amdD);\n      /***/\n\n    },\n\n    /***/\n    97757:\n    /***/\n    function (module) {\n      \"use strict\";\n\n      module.exports = require(\"../kendo.color\");\n      /***/\n    },\n\n    /***/\n    54752:\n    /***/\n    function (module) {\n      \"use strict\";\n\n      module.exports = require(\"../kendo.core\");\n      /***/\n    },\n\n    /***/\n    81200:\n    /***/\n    function (module) {\n      \"use strict\";\n\n      module.exports = require(\"./references\");\n      /***/\n    },\n\n    /***/\n    22360:\n    /***/\n    function (module) {\n      \"use strict\";\n\n      module.exports = require(\"./runtime\");\n      /***/\n    },\n\n    /***/\n    26232:\n    /***/\n    function (module) {\n      \"use strict\";\n\n      module.exports = require(\"./validation\");\n      /***/\n    }\n    /******/\n\n  };\n  /************************************************************************/\n\n  /******/\n  // The module cache\n\n  /******/\n\n  var __webpack_module_cache__ = {};\n  /******/\n\n  /******/\n  // The require function\n\n  /******/\n\n  function __webpack_require__(moduleId) {\n    /******/\n    // Check if module is in cache\n\n    /******/\n    var cachedModule = __webpack_module_cache__[moduleId];\n    /******/\n\n    if (cachedModule !== undefined) {\n      /******/\n      return cachedModule.exports;\n      /******/\n    }\n    /******/\n    // Create a new module (and put it into the cache)\n\n    /******/\n\n\n    var module = __webpack_module_cache__[moduleId] = {\n      /******/\n      // no module.id needed\n\n      /******/\n      // no module.loaded needed\n\n      /******/\n      exports: {}\n      /******/\n\n    };\n    /******/\n\n    /******/\n    // Execute the module function\n\n    /******/\n\n    __webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n    /******/\n\n    /******/\n    // Return the exports of the module\n\n    /******/\n\n\n    return module.exports;\n    /******/\n  }\n  /******/\n\n  /************************************************************************/\n\n  /******/\n\n  /* webpack/runtime/amd define */\n\n  /******/\n\n\n  !function () {\n    /******/\n    __webpack_require__.amdD = function () {\n      /******/\n      throw new Error('define cannot be used indirect');\n      /******/\n    };\n    /******/\n\n  }();\n  /******/\n\n  /************************************************************************/\n\n  /******/\n\n  /******/\n  // startup\n\n  /******/\n  // Load entry module and return exports\n\n  /******/\n  // This entry module used 'module' so it can't be inlined\n\n  /******/\n\n  var __webpack_exports__ = __webpack_require__(26929);\n  /******/\n\n\n  module.exports = __webpack_exports__;\n  /******/\n\n  /******/\n})();","map":{"version":3,"names":["__webpack_modules__","module","exports","__webpack_require__","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","f","define","apply","undefined","kendo","RangeRef","spreadsheet","UnionRef","CellRef","Range","MODIFIED_FORMULAS","Selection","Class","extend","init","sheet","_sheet","selection","FIRSTREF","toRangeRef","originalSelection","_activeCell","originalActiveCell","currentSelectionRange","rangeAt","selectionRangeIndex","currentOriginalNavigationRange","currentNavigationRange","singleCellSelection","_sheetRef","nextNavigationRange","nextRangeIndex","previousNavigationRange","previousRangeIndex","activeCell","ref","first","unionWithMerged","focus","triggerChange","select","expanded","changeActiveCell","view","eq","triggerSelect","isCell","forEachMergedCell","merged","topLeft","lastRange","panes","i","pane","rows","cols","visible","newRef","length","_currentView","values","columns","start","end","intersect","NULLREF","size","Sheet","Observable","prototype","call","_reinit","arguments","events","rowCount","columnCount","rowHeight","columnWidth","headerHeight","headerWidth","defaultCellStyle","_defaultCellStyle","background","color","fontFamily","fontSize","italic","bold","underline","wrap","verticalAlign","textAlign","_rows","Axis","_columns","_filteredRows","RangeList","_mergedCells","_frozenRows","_frozenColumns","_suspendChanges","_filter","_showGridLines","_gridLinesColor","_grid","Grid","normalize","SHEETREF","_properties","PropertyBag","_sorter","Sorter","sortable","_viewSelection","_editSelection","_formulaSelections","_drawings","resize","newRows","newCols","Math","max","oldRows","_count","oldCols","range","clear","_resize","value","layout","_resizeAddRow","count","_resizeAddColumn","_resizeDeleteRow","_resizeDeleteColumn","_resizeForJSON","colCount","ri","row","index","cells","ci","cell","_selectionState","_inEdit","navigator","_navigator","SheetNavigator","axisManager","_axisManager","AxisManager","_name","_sheetName","name","_property","accessor","reason","_field","suspendChanges","trigger","isValue","_valueChanged","setDataSource","dataSource","dataSourceBinder","destroy","SheetDataSourceBinder","hideColumn","columnIndex","hide","bind","unhideColumn","unhide","isHiddenColumn","hidden","_copyRange","sourceRangeRef","targetRef","grid","nextRefTopLeft","nextRefBottomRight","bottomRight","nextIndex","col","nextBottomIndex","targetIndex","copy","_saveModifiedFormulas","array","callback","save","ret","_restoreModifiedFormulas","wb","_workbook","forEach","sheetByName","calc","runtime","Formula","cellRefIndex","set","validation","Validation","_adjustReferences","operation","delta","mergedCells","reduce","a","adjust","push","affectedSheet","_sheets","_forFormulas","formula","prev","_forValidations","adjustNames","axis","drawing","topLeftCell","props","formulas","get","n","v","insertRow","rowIndex","skipDataSourceInsert","batch","frozenRows","slice","nextRef","clearAll","keepBorders","recalc","Infinity","isEnabledRow","enable","deleteRow","skipDataSourceDelete","insertColumn","frozenColumns","isEnabledColumn","deleteColumn","_filterRow","hideRow","unhideRow","isHiddenRow","isFilteredRow","width","height","showGridLines","gridLinesColor","_ref","column","numRows","numColumns","Ref","parseReference","_getMergedCells","primary","secondary","hasMerged","cellRef","print","contains","selectAll","intersects","forEachFilterHeader","refs","forEachColumn","columnRef","map","unique","result","element","indexOf","self","forEachRange","doIt","startCellIndex","endCellIndex","startResizing","initialPosition","_initialPosition","_resizeInProgress","startAutoFill","_autoFillInProgress","_autoFillOrigin","_autoFillDest","updateAutoFill","dest","punch","hint","direction","_autoFillPunch","_autoFillHint","_autoFillDirection","autoFillRef","autoFillPunch","autoFillInProgress","resizingInProgress","draggingInProgress","_draggingInProgress","completeResizing","hintPosition","resizeHintPosition","handlePosition","resizeHandlePosition","command","options","target","x","y","_visualRange","_renderComment","comment","_commentRef","_resizeHandlePosition","location","_resizeHintPosition","removeResizeHandle","positionResizeHandle","startDragging","data","completeDragging","drag","box","drawingBoundingBox","indexVisible","top","left","refBox","refBoundingBox","offsetX","offsetY","dragging","previous","startSelection","_selectionInProgress","completeSelection","origin","operatingRange","selectionInProgress","selectionState","expandedRef","isAxis","originalSelect","currentOriginalSelectionRange","union","trim","trims","forEachProperty","property","list","_focus","activeCellSelection","selectedHeaders","allCols","allRows","maxRow","maxCol","rowState","colState","rowSelection","colSelection","all","isInEditMode","isInEdit","clone","_setFormulaSelections","_viewActiveCell","toJSON","positions","viewSelection","hyperlinks","clearDefaultStyle","Object","keys","key","link","display","position","arrayFormulaRange","src","toString","parseColor","toCss","borderTop","borderBottom","borderRight","borderLeft","json","drawings","dr","_sort","sort","ascending","filter","fromJSON","isArray","_compileFormula","setArrayFormulaRange","_compileValidation","Drawing","activeCellRef","merge","logToConsole","Filter","create","_refreshFilter","_refresh","resetFormulas","reset","resetValidations","context","pending","next","exec","revalidate","_get","_value","_validation","from","replace","to","compile","parseFormula","_copyValuesInRange","_set","limitPrecision","suspended","_sortBy","indices","sortBy","diff","_filterBy","toColumn","prepare","matches","filterColumn","filterRef","clearFilter","spec","_clearFilter","Array","getAxisState","getState","setAxisState","state","setState","properties","ALL_REASONS","_merge","mergedRef","currentRef","splice","format","collapse","_useCultureDecimals","useCultureDecimals","withCultureDecimals","dot","culture","numberFormat","withDecimalSeparator","sum","Rectangle","rectangle","addDrawing","drw","activate","_activeDrawing","removeDrawing","pos","usesImage","img","image","isMerged","args","opacity","anchor","amdD","require","__webpack_module_cache__","moduleId","cachedModule","Error","__webpack_exports__"],"sources":["C:/Users/abodean/restapi-nodejs/client/app-router/node_modules/@progress/kendo-ui/js/spreadsheet/sheet.js"],"sourcesContent":["/******/ (function() { // webpackBootstrap\n/******/ \tvar __webpack_modules__ = ({\n\n/***/ 26929:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function(f, define){\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [ __webpack_require__(54752), __webpack_require__(97757), __webpack_require__(22360), __webpack_require__(26232), __webpack_require__(81200) ], __WEBPACK_AMD_DEFINE_FACTORY__ = (f),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n})(function(){\n\n(function(kendo) {\n\n\n\n    var RangeRef = kendo.spreadsheet.RangeRef;\n    var UnionRef = kendo.spreadsheet.UnionRef;\n    var CellRef = kendo.spreadsheet.CellRef;\n    var Range = kendo.spreadsheet.Range;\n\n    // This is a “dynamic variable” (see Greenspun's 10th rule).  It's\n    // bound to an array via sheet._saveModifiedFormulas (which see)\n    // while the callback runs.  The goal is to enable external code\n    // to get a list of formulas or validations that have been\n    // adjusted as an effect of an insert/delete row/column operation,\n    // to be able to undo it.\n    //\n    // The reason why simply saving the state via sheet.getState() or\n    // range.getState() won't suffice is that an insert or delete\n    // operation can have far-reaching effects, like adjusting\n    // formulas from another sheet.\n    var MODIFIED_FORMULAS;\n\n    var Selection = kendo.Class.extend({\n        init: function(sheet) {\n            this._sheet = sheet;\n            this.selection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n            this.originalSelection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n            this._activeCell = kendo.spreadsheet.FIRSTREF.toRangeRef();\n            this.originalActiveCell = kendo.spreadsheet.FIRSTREF;\n        },\n\n        currentSelectionRange: function() {\n            return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n        },\n\n        currentOriginalNavigationRange: function() {\n            return this.originalSelection.rangeAt(this.selectionRangeIndex).toRangeRef();\n        },\n\n        currentNavigationRange: function() {\n            if (this.singleCellSelection()) {\n                return this._sheet._sheetRef;\n            } else {\n                return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            }\n        },\n\n        nextNavigationRange: function() {\n            if (!this.singleCellSelection()) {\n                this.selectionRangeIndex = this.selection.nextRangeIndex(this.selectionRangeIndex);\n            }\n\n            return this.currentNavigationRange();\n        },\n\n        previousNavigationRange: function() {\n            if (!this.singleCellSelection()) {\n                this.selectionRangeIndex = this.selection.previousRangeIndex(this.selectionRangeIndex);\n            }\n\n            return this.currentNavigationRange();\n        },\n\n        activeCell: function(ref) {\n            if (ref) {\n                this.originalActiveCell = ref.first();\n                this._activeCell = this._sheet.unionWithMerged(ref.toRangeRef());\n                this._sheet.focus(ref);\n                this._sheet.triggerChange({ activeCell: true, selection: true });\n            }\n\n            return this._activeCell;\n        },\n\n        select: function(ref, expanded, changeActiveCell, view) {\n            if (ref) {\n                if (ref.eq(this.originalSelection)) {\n                    return;\n                }\n\n                this._sheet.triggerSelect(new Range(ref, this._sheet));\n\n                this.originalSelection = ref;\n\n                this.selection = expanded;\n\n                if (changeActiveCell !== false) {\n                    if (ref.isCell()) {\n                        // when selecting part of a merged cell, i.e. A1:B2 is merged and select(B2)\n                        // is requested, mark A1 as the actually active cell.\n                        // https://github.com/telerik/kendo/issues/7698\n                        this._sheet.forEachMergedCell(ref, function(merged){\n                            ref = merged.topLeft;\n                        });\n                        this.activeCell(ref);\n                    } else {\n                        ref = this.selection.lastRange();\n                        if (view && view._sheet === this._sheet && view.panes[0]) {\n                            // we should intersect this ref with the range that's currently on\n                            // screen, so that the view doesn't scroll (that is, keep the activeCell\n                            // visible) - https://github.com/telerik/kendo-ui-core/issues/5182 —\n                            // XXX: fiddling with View internals here is probably bad practice, but\n                            // this whole thing is a mess already, so it can be forgiven. :-/\n                            var panes = view.panes;\n                            var i, pane, rows, cols, visible, newRef;\n\n                            for (i = 0; i < panes.length; i++) {\n                                pane = panes[i];\n                                if (!pane._currentView) {\n                                    continue;\n                                }\n                                rows = pane._currentView.rows.values;\n                                cols = pane._currentView.columns.values;\n\n                                visible = new RangeRef(\n                                    new CellRef(rows.start, cols.start),\n                                    new CellRef(rows.end, cols.end)\n                                );\n\n                                newRef = ref.intersect(visible);\n\n                                if (newRef !== kendo.spreadsheet.NULLREF) {\n                                    break;\n                                }\n                            }\n\n                            if (newRef && newRef !== kendo.spreadsheet.NULLREF) {\n                                ref = newRef;\n                            }\n                        }\n                        this.activeCell(ref.first());\n                    }\n\n                    this.selectionRangeIndex = this.selection.size() - 1;\n                } else {\n                    this._sheet.triggerChange({ selection: true });\n                }\n            }\n\n            return this.selection;\n        },\n\n        singleCellSelection: function() {\n            return this._activeCell.eq(this.selection);\n        }\n    });\n\n    var Sheet = kendo.Observable.extend({\n        init: function() {\n            kendo.Observable.prototype.init.call(this);\n            this._reinit.apply(this, arguments);\n        },\n\n\n        events: [\n            \"changing\",\n            \"commandRequest\",\n            \"afterInsertRow\",\n            \"afterDeleteRow\",\n            \"insertRow\",\n            \"insertColumn\",\n            \"deleteRow\",\n            \"deleteColumn\",\n            \"hideRow\",\n            \"hideColumn\",\n            \"unhideRow\",\n            \"unhideColumn\",\n            \"select\",\n            \"dataBinding\",\n            \"dataBound\",\n            \"progress\"\n        ],\n\n        _reinit: function(rowCount, columnCount, rowHeight, columnWidth, headerHeight, headerWidth, defaultCellStyle) {\n            defaultCellStyle = defaultCellStyle || {};\n\n            this._defaultCellStyle = {\n                background: defaultCellStyle.background,\n                color: defaultCellStyle.color,\n                fontFamily: defaultCellStyle.fontFamily,\n                fontSize: defaultCellStyle.fontSize,\n                italic: defaultCellStyle.italic,\n                bold: defaultCellStyle.bold,\n                underline: defaultCellStyle.underline,\n                wrap: defaultCellStyle.wrap,\n                verticalAlign: defaultCellStyle.verticalAlign,\n                textAlign: defaultCellStyle.textAlign\n            };\n\n            this._rows = new kendo.spreadsheet.Axis(rowCount, rowHeight);\n            this._columns = new kendo.spreadsheet.Axis(columnCount, columnWidth);\n            this._filteredRows = new kendo.spreadsheet.RangeList(0, rowCount - 1, false);\n            this._mergedCells = [];\n            this._frozenRows = 0;\n            this._frozenColumns = 0;\n            this._suspendChanges = false;\n            this._filter = null;\n            this._showGridLines = true;\n            this._gridLinesColor = null;\n            this._grid = new kendo.spreadsheet.Grid(this._rows, this._columns, rowCount, columnCount, headerHeight, headerWidth);\n            this._sheetRef = this._grid.normalize(kendo.spreadsheet.SHEETREF);\n            this._properties = new kendo.spreadsheet.PropertyBag(rowCount, columnCount, this._defaultCellStyle);\n            this._sorter = new kendo.spreadsheet.Sorter(this._grid, this._properties.sortable());\n\n            this._viewSelection = new Selection(this);\n\n            this._editSelection = new Selection(this);\n\n            this._formulaSelections = [];\n            this._drawings = [];\n        },\n\n        resize: function(newRows, newCols) {\n            newRows = Math.max(newRows, 1);\n            newCols = Math.max(newCols, 1);\n            var oldRows = this._rows._count;\n            var oldCols = this._columns._count;\n            if (newRows < oldRows) {\n                this.range(newRows, 0, oldRows - newRows, oldCols).clear();\n            }\n            if (newCols < oldCols) {\n                this.range(0, newCols, oldRows, oldCols - newCols).clear();\n            }\n            this._rows._resize(newRows);\n            this._columns._resize(newCols);\n            this._grid._resize(newRows, newCols);\n            this._properties._resize(newRows, newCols);\n            this._sheetRef = this._grid.normalize(kendo.spreadsheet.SHEETREF);\n            if (newRows > oldRows) {\n                this.range(oldRows, 0, newRows - oldRows, newCols).clear();\n                this._filteredRows.value(oldRows, newRows - 1, false);\n            }\n            if (newCols > oldCols) {\n                this.range(0, oldCols, newRows, newCols - oldCols).clear();\n            }\n            this.triggerChange({ layout: true });\n        },\n\n        _resizeAddRow: function(count) {\n            this.resize(this._rows._count + (count || 1), this._columns._count);\n        },\n\n        _resizeAddColumn: function(count) {\n            this.resize(this._rows._count, this._columns._count + (count || 1));\n        },\n\n        _resizeDeleteRow: function(count) {\n            this._resizeAddRow(-(count || 1));\n        },\n\n        _resizeDeleteColumn: function(count) {\n            this._resizeAddColumn(-(count || 1));\n        },\n\n        _resizeForJSON: function(rows) {\n            var rowCount = rows.length, colCount = 0;\n            for (var ri = 0; ri < rows.length; ++ri) {\n                var row = rows[ri];\n                if (row.index != null) {\n                    rowCount = Math.max(rowCount, row.index + 1);\n                }\n                if (row.cells) {\n                    colCount = Math.max(colCount, row.cells.length);\n                    for (var ci = 0; ci < row.cells.length; ++ci) {\n                        var cell = row.cells[ci];\n                        if (cell.index != null) {\n                            colCount = Math.max(colCount, cell.index + 1);\n                        }\n                    }\n                }\n            }\n            this.resize(Math.max(rowCount, this._rows._count),\n                        Math.max(colCount, this._columns._count));\n        },\n\n        _selectionState: function() {\n            return this._inEdit ? this._editSelection : this._viewSelection;\n        },\n\n        navigator: function() {\n            if(!this._navigator) {\n                 this._navigator = new kendo.spreadsheet.SheetNavigator(this);\n            }\n            return this._navigator;\n        },\n\n        axisManager: function() {\n            if(!this._axisManager) {\n                 this._axisManager = new kendo.spreadsheet.AxisManager(this);\n            }\n\n            return this._axisManager;\n        },\n\n        _name: function(value) {\n            if (!value) {\n                return this._sheetName;\n            }\n\n            this._sheetName = value;\n\n            return this;\n        },\n\n        name: function() {\n            return this._name();\n        },\n\n        _property: function(accessor, value, reason) {\n            if (value === undefined) {\n                return accessor();\n            } else {\n                accessor(value);\n\n                return this.triggerChange(reason);\n            }\n        },\n\n        _field: function(name, value, reason) {\n            if (value === undefined) {\n                return this[name];\n            } else {\n                this[name] = value;\n\n                return this.triggerChange(reason);\n            }\n        },\n\n        suspendChanges: function(value) {\n            if (value === undefined) {\n                return this._suspendChanges;\n            }\n\n            this._suspendChanges = value;\n\n            return this;\n        },\n\n        triggerChange: function(reason) {\n            if (!this._suspendChanges) {\n                this.trigger(\"change\", reason);\n            } else if (reason && reason.isValue) {\n                this._valueChanged = true;\n            }\n            return this;\n        },\n\n        triggerSelect: function(range) {\n            this.trigger(\"select\", { range: range });\n        },\n\n        setDataSource: function(dataSource, columns) {\n            if (this.dataSourceBinder) {\n                this.dataSourceBinder.destroy();\n            }\n\n            this.dataSourceBinder = new kendo.spreadsheet.SheetDataSourceBinder({\n                dataSource: dataSource,\n                sheet: this,\n                columns: columns\n            });\n\n            this.dataSource = this.dataSourceBinder.dataSource;\n        },\n\n        hideColumn: function(columnIndex) {\n            if (this.trigger(\"hideColumn\", { index: columnIndex })) {\n                return;\n            }\n\n            return this._property(this._columns.hide.bind(this._columns), columnIndex, { layout: true });\n        },\n\n        unhideColumn: function(columnIndex) {\n            if (this.trigger(\"unhideColumn\", { index: columnIndex })) {\n                return;\n            }\n\n            return this._property(this._columns.unhide.bind(this._columns), columnIndex, { layout: true });\n        },\n\n        isHiddenColumn: function(columnIndex) {\n            return this._grid._columns.hidden(columnIndex);\n        },\n\n        _copyRange: function(sourceRangeRef, targetRef) {\n            var grid = this._grid;\n            var rowCount = grid.rowCount;\n\n            var nextRefTopLeft = grid.normalize(sourceRangeRef.topLeft);\n            var nextRefBottomRight = grid.normalize(sourceRangeRef.bottomRight);\n\n            var nextIndex = nextRefTopLeft.col * rowCount + nextRefTopLeft.row;\n            var nextBottomIndex = nextRefBottomRight.col * rowCount + nextRefBottomRight.row;\n\n            var targetIndex = targetRef.col * rowCount + targetRef.row;\n\n            this._properties.copy(nextIndex, nextBottomIndex, targetIndex);\n        },\n\n        _saveModifiedFormulas: function(array, callback) {\n            var save = MODIFIED_FORMULAS;\n            MODIFIED_FORMULAS = array;\n            var ret = callback();\n            MODIFIED_FORMULAS = save;\n            return ret;\n        },\n\n        _restoreModifiedFormulas: function(array) {\n            var wb = this._workbook;\n            array.forEach(function(f){\n                var sheet = wb.sheetByName(f.sheet), index;\n                if (f instanceof kendo.spreadsheet.calc.runtime.Formula) {\n                    index = sheet._grid.cellRefIndex(f); // f has row, col\n                    sheet._properties.set(\"formula\", index, index, f);\n                }\n                if (f instanceof kendo.spreadsheet.validation.Validation) {\n                    index = sheet._grid.cellRefIndex(f); // f has row, col\n                    sheet._properties.set(\"validation\", index, index, f);\n                }\n            });\n        },\n\n        _adjustReferences: function(operation, start, delta, mergedCells) {\n            this._mergedCells = mergedCells.reduce(function(a, ref){\n                ref = ref.adjust(null, null, null, null, operation == \"row\", start, delta);\n                if (ref instanceof RangeRef) {\n                    a.push(ref);\n                }\n                return a;\n            }, []);\n            if (this._workbook) {\n                var affectedSheet = this._name();\n                this._workbook._sheets.forEach(function(sheet){\n                    sheet._forFormulas(function(formula){\n                        var prev = formula.adjust(affectedSheet, operation, start, delta);\n                        if (prev && MODIFIED_FORMULAS) {\n                            // if formula.adjust returns non-null,\n                            // that means the formula was indeed\n                            // modified and the returned value is a\n                            // copy of the previous Formula, which we\n                            // can use for undoing the operation.\n                            MODIFIED_FORMULAS.push(prev);\n                        }\n                    });\n\n                    sheet._forValidations(function(validation){\n                        var prev = validation.adjust(affectedSheet, operation, start, delta);\n                        if (prev && MODIFIED_FORMULAS) {\n                            MODIFIED_FORMULAS.push(prev);\n                        }\n                    });\n                });\n                this._workbook.adjustNames(affectedSheet, operation == \"row\", start, delta);\n            }\n            var selection = this.select();\n            selection = selection.adjust(null, null, null, null, operation == \"row\", start, delta);\n            if (selection !== kendo.spreadsheet.NULLREF) {\n                this.select(selection);\n            }\n            // adjust column widths or row heights and hidden attribute\n            var axis = operation == \"col\" ? this._columns : this._rows;\n            axis.adjust(start, delta);\n\n            if (operation == \"row\") {\n                if (delta < 0) {\n                    this._filteredRows.copy(start - delta, this._rows._count - 1, start);\n                } else {\n                    this._filteredRows.copy(start, this._rows._count, start + delta);\n                    this._filteredRows.value(start, start + delta - 1, false);\n                }\n            }\n\n            // adjust drawing anchor cells\n            this._drawings.forEach(function(drawing){\n                if (drawing.topLeftCell) {\n                    drawing.topLeftCell = drawing.topLeftCell.adjust(null, null, null, null,\n                                                                     operation == \"row\", start, delta);\n                }\n            });\n        },\n\n        _forFormulas: function(callback) {\n            var props = this._properties;\n            var formulas = props.get(\"formula\").values();\n            var n = formulas.length;\n            formulas.forEach(function(f, i){\n                callback.call(this, f.value, i, n);\n            }, this);\n        },\n\n        _forValidations: function(callback) {\n            var props = this._properties;\n            props.get(\"validation\").values().forEach(function(v){\n                callback.call(this, v.value);\n            }, this);\n        },\n\n        insertRow: function(rowIndex, skipDataSourceInsert) {\n            if (this.trigger(\"insertRow\", { index: rowIndex })) {\n                return;\n            }\n\n            this.batch(function() {\n                this._resizeAddRow();\n\n                var grid = this._grid;\n                var columnCount = grid.columnCount;\n                var rowCount = grid.rowCount;\n\n                if (rowIndex + 1 == rowCount) {\n                    // we just inserted after the last one, no need to shift data\n                    return;\n                }\n\n                var frozenRows = this.frozenRows();\n\n                if (rowIndex < frozenRows) {\n                    this.frozenRows(frozenRows + 1);\n                }\n\n                var mergedCells = this._mergedCells.slice();\n\n                for (var ci = 0; ci < columnCount; ci++) {\n                    var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n\n                    var topLeft = grid.normalize(ref.topLeft);\n                    var bottomRight = grid.normalize(ref.bottomRight);\n\n                    var nextRef = new RangeRef(\n                        new CellRef(topLeft.row, topLeft.col),\n                        new CellRef(rowCount - 2, bottomRight.col)\n                    );\n\n                    this._copyRange(nextRef, new CellRef(topLeft.row + 1, topLeft.col));\n\n                    new Range(ref, this).clear({ clearAll: true, keepBorders: true });\n                }\n\n                this._adjustReferences(\"row\", rowIndex, 1, mergedCells);\n            }, {\n                recalc: true,\n                layout: true,\n                insertRow: { index: rowIndex },\n                ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n            });\n\n            if (!skipDataSourceInsert) {\n                this.trigger(\"afterInsertRow\", { index: rowIndex });\n            }\n\n            return this;\n        },\n\n        isEnabledRow: function(rowIndex) {\n            var ref = new RangeRef(new CellRef(rowIndex, 0), new CellRef(rowIndex, this._grid.columnCount));\n            return new Range(ref, this).enable();\n        },\n\n        deleteRow: function(rowIndex, skipDataSourceDelete) {\n            if (!this.isEnabledRow(rowIndex)) {\n                return this;\n            }\n\n            if (this.trigger(\"deleteRow\", { index: rowIndex })) {\n                return;\n            }\n\n            this.batch(function() {\n                var grid = this._grid;\n                var columnCount = grid.columnCount;\n\n                var frozenRows = this.frozenRows();\n                if (rowIndex < frozenRows) {\n                    this.frozenRows(frozenRows - 1);\n                }\n\n                var mergedCells = this._mergedCells.slice();\n\n                for (var ci = 0; ci < columnCount; ci++) {\n                    var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n\n                    new Range(ref, this).clear({ clearAll: true, keepBorders: true });\n\n                    var topLeft = grid.normalize(ref.topLeft);\n                    var bottomRight = grid.normalize(ref.bottomRight);\n\n                    var nextRef = new RangeRef(\n                        new CellRef(topLeft.row + 1, topLeft.col),\n                        new CellRef(Infinity, bottomRight.col)\n                    );\n\n                    this._copyRange(nextRef, topLeft);\n\n                    var nextRefBottomRight = grid.normalize(nextRef.bottomRight);\n\n                    new Range(new RangeRef(nextRefBottomRight, nextRefBottomRight), this).clear();\n                }\n\n                this._adjustReferences(\"row\", rowIndex, -1, mergedCells);\n\n                this._resizeDeleteRow();\n            }, {\n                recalc: true,\n                layout: true,\n                deleteRow: { index: rowIndex },\n                ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n            });\n\n            if (!skipDataSourceDelete) {\n                this.trigger(\"afterDeleteRow\", { index: rowIndex });\n            }\n\n            return this;\n        },\n\n        insertColumn: function(columnIndex) {\n            if (this.trigger(\"insertColumn\", { index: columnIndex })) {\n                return;\n            }\n\n            this.batch(function() {\n                this._resizeAddColumn();\n\n                var grid = this._grid;\n                var columnCount = grid.columnCount;\n\n                if (columnIndex + 1 == columnCount) {\n                    // we just inserted after the last one, no need to shift data\n                    return;\n                }\n\n                var frozenColumns = this.frozenColumns();\n\n                if (columnIndex < frozenColumns) {\n                    this.frozenColumns(frozenColumns + 1);\n                }\n\n                var mergedCells = this._mergedCells.slice();\n\n                for (var ci = columnCount; ci >= columnIndex; ci--) {\n                    var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n\n                    new Range(ref, this).clear({ clearAll: true, keepBorders: true });\n\n                    if (ci == columnIndex) {\n                        break;\n                    }\n\n                    var topLeft = grid.normalize(ref.topLeft);\n                    var bottomRight = grid.normalize(ref.bottomRight);\n\n                    var nextRef = new RangeRef(\n                        new CellRef(topLeft.row, topLeft.col - 1),\n                        new CellRef(bottomRight.row, bottomRight.col - 1)\n                    );\n\n                    this._copyRange(nextRef, topLeft);\n                }\n\n                this._adjustReferences(\"col\", columnIndex, 1, mergedCells);\n            }, {\n                recalc: true,\n                layout: true,\n                insertColumn: { index: columnIndex },\n                ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n            });\n\n            return this;\n        },\n\n        isEnabledColumn: function(columnIndex) {\n            var ref = new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, columnIndex));\n            return new Range(ref, this).enable();\n        },\n\n        deleteColumn: function(columnIndex) {\n            if (!this.isEnabledColumn(columnIndex)) {\n                return this;\n            }\n\n            if (this.trigger(\"deleteColumn\", { index: columnIndex })) {\n                return;\n            }\n\n            this.batch(function() {\n                var grid = this._grid;\n                var columnCount = grid.columnCount;\n\n                var frozenColumns = this.frozenColumns();\n\n                if (columnIndex < frozenColumns) {\n                    this.frozenColumns(frozenColumns - 1);\n                }\n\n                var mergedCells = this._mergedCells.slice();\n\n                for (var ci = columnIndex; ci < columnCount; ci++) {\n                    var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n\n                    new Range(ref, this).clear({ clearAll: true, keepBorders: true });\n\n                    if (ci == columnCount - 1) {\n                        break;\n                    }\n\n                    var topLeft = grid.normalize(ref.topLeft);\n                    var bottomRight = grid.normalize(ref.bottomRight);\n\n                    var nextRef = new RangeRef(\n                        new CellRef(topLeft.row, topLeft.col + 1),\n                        new CellRef(bottomRight.row, bottomRight.col + 1)\n                    );\n\n                    this._copyRange(nextRef, topLeft);\n                }\n\n                this._adjustReferences(\"col\", columnIndex, -1, mergedCells);\n\n                this._resizeDeleteColumn();\n            }, {\n                recalc: true,\n                layout: true,\n                deleteColumn: { index: columnIndex },\n                ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n            });\n\n            return this;\n        },\n\n        _filterRow: function(rowIndex) {\n            this._rows.hide(rowIndex);\n            this._filteredRows.value(rowIndex, rowIndex, true);\n            this.triggerChange({ layout: true });\n        },\n\n        hideRow: function(rowIndex) {\n            if (this.trigger(\"hideRow\", { index: rowIndex })) {\n                return;\n            }\n            return this._property(this._rows.hide.bind(this._rows), rowIndex, { layout: true });\n        },\n\n        unhideRow: function(rowIndex) {\n            if (this.trigger(\"unhideRow\", { index: rowIndex })) {\n                return;\n            }\n            return this._property(this._rows.unhide.bind(this._rows), rowIndex, { layout: true });\n        },\n\n        isHiddenRow: function(rowIndex) {\n            return this._grid._rows.hidden(rowIndex);\n        },\n\n        isFilteredRow: function(rowIndex) {\n            return this._filteredRows.value(rowIndex);\n        },\n\n        columnWidth: function(columnIndex, width) {\n            return this._property(this._columns.value.bind(this._columns, columnIndex, columnIndex), width, { layout: true });\n        },\n\n        rowHeight: function(rowIndex, height) {\n            return this._property(this._rows.value.bind(this._rows, rowIndex, rowIndex), height, { layout: true });\n        },\n\n        frozenRows: function(value) {\n            return this._field(\"_frozenRows\", value, { layout: true });\n        },\n\n        frozenColumns: function(value) {\n            return this._field(\"_frozenColumns\", value, { layout: true });\n        },\n\n        showGridLines: function(value) {\n            return this._field(\"_showGridLines\", value, { layout: true });\n        },\n\n        gridLinesColor: function(value) {\n            return this._field(\"_gridLinesColor\", value, { layout: true });\n        },\n\n        _ref: function(row, column, numRows, numColumns) {\n            var ref = null;\n\n            if (row instanceof kendo.spreadsheet.Ref) {\n                return row;\n            }\n\n            if (row instanceof kendo.spreadsheet.Range) {\n                return row._ref.toRangeRef();\n            }\n\n            if (typeof row === \"string\") {\n                ref = kendo.spreadsheet.calc.parseReference(row);\n            } else {\n                if (!numRows) {\n                    numRows = 1;\n                }\n\n                if (!numColumns) {\n                    numColumns = 1;\n                }\n                ref = new RangeRef(new CellRef(row, column), new CellRef(row + numRows - 1, column + numColumns - 1));\n            }\n\n            return ref;\n        },\n\n        range: function(row, column, numRows, numColumns) {\n            return new Range(this._ref(row, column, numRows, numColumns), this);\n        },\n\n        _getMergedCells: function(range) {\n            var grid = this._grid;\n            var primary = {};\n            var secondary = {};\n            var hasMerged = false;\n\n            this.forEachMergedCell(range, function(ref) {\n                var topLeft = ref.topLeft;\n                grid.forEach(ref, function(cellRef) {\n                    if (topLeft.eq(cellRef)) {\n                        primary[cellRef.print()] = ref;\n                        hasMerged = true;\n                    } else if (range.contains(cellRef)) {\n                        secondary[cellRef.print()] = topLeft;\n                        hasMerged = true;\n                    }\n                });\n            });\n\n            return { primary: primary, secondary: secondary, hasMerged: hasMerged };\n        },\n\n        forEachMergedCell: function(ref, callback) {\n            var selectAll = false;\n\n            if (typeof callback === \"undefined\") {\n                callback = ref;\n                selectAll = true;\n            }\n\n            this._mergedCells.forEach(function(merged) {\n                if (selectAll || merged.intersects(ref)) {\n                    callback(merged);\n                }\n            });\n        },\n\n        forEachFilterHeader: function(ref, callback) {\n            var selectAll = false;\n\n            if (typeof callback === \"undefined\") {\n                callback = ref;\n                selectAll = true;\n            }\n\n            if (this._filter) {\n                var refs = [];\n\n                // get refs of all columns\n                this._filter.ref.forEachColumn(function(columnRef) {\n                    if (selectAll || columnRef.intersects(ref)) {\n                        refs.push(columnRef.topLeft);\n                    }\n                });\n\n                // filter out merged references\n                this._mergedCells.forEach(function(merged) {\n                    refs = refs.map(function(ref) {\n                        if (merged.intersects(ref)) {\n                            return merged;\n                        }\n\n                        return ref;\n                    });\n                });\n\n                // use only unique refs\n                refs.reduce(function unique(result, element) {\n                    if (result.indexOf(element) < 0) {\n                        result.push(element);\n                    }\n\n                    return result;\n                }, []).forEach(callback);\n            }\n        },\n\n        forEach: function(ref, callback) {\n            var self = this;\n            function forEachRange(ref) {\n                if (!(ref instanceof RangeRef)) {\n                    ref = ref.toRangeRef();\n                }\n                var topLeft = self._grid.normalize(ref.topLeft);\n                var bottomRight = self._grid.normalize(ref.bottomRight);\n                var ci, ri;\n\n                function doIt(value) {\n                    callback(ri++, ci, value);\n                }\n\n                for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    ri = topLeft.row;\n                    var startCellIndex = self._grid.index(ri, ci);\n                    var endCellIndex = self._grid.index(bottomRight.row, ci);\n                    self._properties.forEach(startCellIndex, endCellIndex, doIt);\n                }\n            }\n\n            if (!(ref instanceof RangeRef)) {\n                ref = self._ref(ref);\n            }\n\n            if (ref instanceof UnionRef) {\n                // _ref() might still return a UnionRef, for instance, if\n                // `ref` happens to be one.  Probably an oversight, but it\n                // turns out to be useful.\n                ref.forEach(forEachRange);\n            } else {\n                forEachRange(ref);\n            }\n        },\n\n        startResizing: function(initialPosition) {\n            this._initialPosition = initialPosition;\n            this._resizeInProgress = true;\n        },\n\n        startAutoFill: function() {\n            this._autoFillInProgress = true;\n            var selection = this.select();\n            this._autoFillOrigin = selection;\n            this._autoFillDest = selection;\n            this.triggerChange({ selection: true });\n        },\n\n        updateAutoFill: function(dest, punch, hint, direction) {\n            this._autoFillDest = dest;\n            this._autoFillPunch = punch;\n            this._autoFillHint = hint;\n            this._autoFillDirection = direction;\n            this.triggerChange({ selection: true });\n        },\n\n        autoFillRef: function() {\n            return this._autoFillDest;\n        },\n\n        autoFillPunch: function() {\n            return this._autoFillPunch;\n        },\n\n        autoFillInProgress: function() {\n            return this._autoFillInProgress;\n        },\n\n        resizingInProgress: function() {\n            return this._resizeInProgress;\n        },\n\n        draggingInProgress: function() {\n            return this._draggingInProgress;\n        },\n\n        completeResizing: function() {\n            if (this._resizeInProgress) {\n                this._resizeInProgress = false;\n                var hintPosition = this.resizeHintPosition();\n\n                if (this._initialPosition && hintPosition) {\n                    var handlePosition = this.resizeHandlePosition();\n                    if (handlePosition.col !== -Infinity) {\n                        this.trigger(\"commandRequest\", {\n                            command: \"ColumnWidthCommand\",\n                            options: {\n                                target: handlePosition.col,\n                                value: this.columnWidth(handlePosition.col) - (this._initialPosition.x - hintPosition.x)\n                            }\n                        });\n                    } else {\n                        this.trigger(\"commandRequest\", {\n                            command: \"RowHeightCommand\",\n                            options: {\n                                target: handlePosition.row,\n                                value: this.rowHeight(handlePosition.row) - (this._initialPosition.y - hintPosition.y)\n                            }\n                        });\n                    }\n                } else {\n                    this.trigger(\"change\", { resize: true });\n                }\n            }\n        },\n\n        _visualRange: function(ref) {\n            var merged = this._mergedCells;\n            for (var i = merged.length; --i >= 0;) {\n                if (merged[i].intersects(ref)) {\n                    return this.range(merged[i]);\n                }\n            }\n            return this.range(ref);\n        },\n\n        _renderComment: function(ref) {\n            var comment = null;\n            if (ref) {\n                var range = this._visualRange(ref);\n                comment = range.comment();\n                ref = range._ref.toRangeRef().topLeft;\n            }\n            if (comment) {\n                if (!this._commentRef || !ref.eq(this._commentRef)) {\n                    this._commentRef = ref;\n                    this.trigger(\"change\", { comment: true });\n                }\n            } else {\n                if (this._commentRef) {\n                    this._commentRef = null;\n                    this.trigger(\"change\", { comment: true });\n                }\n            }\n        },\n\n        resizeHandlePosition: function() {\n            return this._resizeHandlePosition;\n        },\n\n        resizeHintPosition: function(location) {\n            if (location !== undefined) {\n                this._resizeHintPosition = location;\n                this.trigger(\"change\", { resize: true });\n            }\n            return this._resizeHintPosition;\n        },\n\n        removeResizeHandle: function() {\n            if (this._resizeHandlePosition) {\n                this._resizeHintPosition = undefined;\n                this._resizeHandlePosition = undefined;\n                this._initialPosition = undefined;\n                this.trigger(\"change\", { resize: true });\n            }\n        },\n\n        positionResizeHandle: function(ref) {\n            this._resizeHandlePosition = ref;\n            this.trigger(\"change\", { resize: true });\n        },\n\n        startDragging: function(data) {\n            this._draggingInProgress = data;\n        },\n\n        completeDragging: function() {\n            var drag = this._draggingInProgress;\n            if (drag) {\n                this._draggingInProgress = null;\n                var drawing = drag.drawing;\n                if (drawing.eq(drag.copy)) {\n                    return;\n                }\n                if (drawing.topLeftCell) {\n                    // adjust reference - in case the top-left corner\n                    // was moving, select the cell beneath it.\n                    var box = this.drawingBoundingBox(drawing);\n                    var row = this._rows.indexVisible(box.top);\n                    var col = this._columns.indexVisible(box.left);\n                    var ref = new CellRef(row, col);\n                    var refBox = this.refBoundingBox(ref);\n                    drawing.offsetX = box.left - refBox.left;\n                    drawing.offsetY = box.top - refBox.top;\n                    drawing.topLeftCell = ref;\n                    this.triggerChange({ dragging: true });\n                }\n                this.trigger(\"commandRequest\", {\n                    command: \"DrawingUpdateCommand\",\n                    options: {\n                        sheet    : this,\n                        drawing  : drawing,\n                        previous : drag.copy\n                    }\n                });\n            }\n        },\n\n        startSelection: function(view) {\n            if (this.frozenRows() || this.frozenColumns()) {\n                this._currentView = null;\n            } else if (view && view._sheet === this) {\n                this._currentView = view;\n            }\n            this._selectionInProgress = true;\n        },\n\n        completeSelection: function() {\n            if (this._selectionInProgress) {\n                this._selectionInProgress = false;\n                this._resizeHintPosition = undefined;\n                this.trigger(\"change\", { selection: true });\n            }\n            if (this._autoFillInProgress) {\n                this._autoFillInProgress = false;\n                var dest = this._autoFillDest;\n                var origin = this._autoFillOrigin;\n\n                if (this._autoFillPunch) { // we just clear data here\n                    this.trigger(\"commandRequest\", {\n                        command: \"ClearContentCommand\", options: { operatingRange: this.range(this._autoFillPunch) }\n                    });\n                } else {\n                    if (!dest.eq(origin)) {\n                        this.trigger(\"commandRequest\", {\n                            command: \"AutoFillCommand\", options: { operatingRange: this.range(dest), origin: this.range(origin) }\n                        });\n                    } else {\n                        this.triggerChange({ selection: true });\n                    }\n                }\n\n                this._autoFillDest = null;\n                this._autoFillPunch = null;\n                this._autoFillOrigin = null;\n\n                this.select(dest);\n            }\n        },\n\n        selectionInProgress: function() {\n            return this._selectionInProgress;\n        },\n\n        select: function(ref, changeActiveCell) {\n            var selectionState = this._selectionState();\n\n            var expandedRef;\n\n            if (ref) {\n                ref = this._ref(ref);\n                ref = this._grid.normalize(ref);\n                expandedRef = this._grid.isAxis(ref) ? ref : this.unionWithMerged(ref);\n            }\n\n            return selectionState.select(ref, expandedRef, changeActiveCell, this._currentView);\n        },\n\n        originalSelect: function() {\n            return this._selectionState().originalSelection;\n        },\n\n        currentSelectionRange: function() {\n            return this._selectionState().currentSelectionRange();\n        },\n\n        currentOriginalSelectionRange: function() {\n            return this._selectionState().currentOriginalNavigationRange();\n        },\n\n        currentNavigationRange: function() {\n            return this._selectionState().currentNavigationRange();\n        },\n\n        nextNavigationRange: function() {\n            return this._selectionState().nextNavigationRange();\n        },\n\n        previousNavigationRange: function() {\n            return this._selectionState().previousNavigationRange();\n        },\n\n        selectionRangeIndex: function() {\n            return this._selectionState().selectionRangeIndex;\n        },\n\n        activeCell: function(ref) {\n            return this._selectionState().activeCell(ref);\n        },\n\n        originalActiveCell: function() {\n            return this._selectionState().originalActiveCell;\n        },\n\n        singleCellSelection: function() {\n            return this._selectionState().singleCellSelection();\n        },\n\n        unionWithMerged: function(ref) {\n            var mergedCells = this._mergedCells;\n\n            return ref.map(function(ref) {\n                return ref.toRangeRef().union(mergedCells);\n            });\n        },\n\n        trim: function(ref) {\n            var trims = [];\n            var grid = this._grid;\n            this._properties.forEachProperty(function(property) {\n                trims.push(grid.trim(ref, property.list));\n            });\n            return this.unionWithMerged(ref.topLeft.toRangeRef().union(trims));\n        },\n\n        focus: function(ref) {\n            if (ref) {\n                this._focus = ref.toRangeRef();\n            } else {\n                var focus = this._focus;\n                this._focus = null;\n                return focus;\n            }\n        },\n\n        activeCellSelection: function() {\n            return new Range(this._grid.normalize(this.activeCell()), this);\n        },\n\n        selection: function() {\n            return new Range(this._grid.normalize(this._selectionState().selection), this);\n        },\n\n        selectedHeaders: function() {\n            var selection = this.select();\n\n            var rows = {};\n            var cols = {};\n            var allCols = false;\n            var allRows = false;\n            var maxRow = this._grid.rowCount - 1;\n            var maxCol = this._grid.columnCount - 1;\n\n            selection.forEach(function(ref) {\n                var i;\n                var rowState = \"partial\";\n                var colState = \"partial\";\n                ref = ref.toRangeRef();\n\n                var bottomRight = ref.bottomRight;\n                var topLeft = ref.topLeft;\n\n                var rowSelection = topLeft.col <= 0 && bottomRight.col >= maxCol;\n                var colSelection = topLeft.row <= 0 && bottomRight.row >= maxRow;\n\n                if (colSelection) { //column selection\n                    allRows = true;\n                    colState = \"full\";\n                }\n\n                if (rowSelection) { //row selection\n                    allCols = true;\n                    rowState = \"full\";\n                }\n\n                if (!colSelection) { //column selection\n                    for (i = topLeft.row; i <= bottomRight.row; i++) {\n                        if (rows[i] !== \"full\") {\n                            rows[i] = rowState;\n                        }\n                    }\n                }\n\n                if (!rowSelection) {\n                    for (i = topLeft.col; i <= bottomRight.col; i++) {\n                        if (cols[i] !== \"full\") {\n                            cols[i] = colState;\n                        }\n                    }\n                }\n            });\n\n            return {\n                rows: rows,\n                cols: cols,\n                allRows: allRows,\n                allCols: allCols,\n                all: allRows && allCols\n            };\n        },\n\n        isInEditMode: function(isInEdit) {\n            if (isInEdit === undefined) {\n                return this._inEdit;\n            }\n\n            this._inEdit = isInEdit;\n\n            if (isInEdit) {\n                this._editSelection.selection = this._viewSelection.selection.clone();\n                this._editSelection.originalSelection = this._viewSelection.originalSelection.clone();\n                this._editSelection._activeCell = this._viewSelection._activeCell.clone();\n                this._editSelection.originalActiveCell = this._viewSelection.originalActiveCell.clone();\n            }\n        },\n\n        _setFormulaSelections: function(selection) {\n            this._formulaSelections = (selection || []).slice();\n            this.triggerChange({ selection: true });\n        },\n\n        _viewActiveCell: function() {\n            return this._viewSelection._activeCell.toRangeRef();\n        },\n\n        toJSON: function() {\n            var positions = {};\n\n            var rows = this._rows.toJSON(\"height\", positions);\n            var columns = this._columns.toJSON(\"width\", {});\n            var viewSelection = this._viewSelection;\n            var hyperlinks = [];\n            var defaultCellStyle = this._defaultCellStyle || {};\n\n            function clearDefaultStyle(cell) {\n                Object.keys(defaultCellStyle).forEach(function(key){\n                    if (cell[key] === defaultCellStyle[key]) {\n                        delete cell[key];\n                    }\n                });\n            }\n\n            this.forEach(kendo.spreadsheet.SHEETREF, function(row, col, cell) {\n                clearDefaultStyle(cell);\n\n                if (Object.keys(cell).length === 0) {\n                    return;\n                }\n\n                if (cell.link) {\n                    hyperlinks.push({\n                        ref    : kendo.spreadsheet.Ref.display(null, row, col),\n                        target : cell.link\n                    });\n                }\n\n                var position = positions[row];\n\n                if (position === undefined) {\n                    position = rows.length;\n                    rows.push({ index: row });\n                    positions[row] = position;\n                }\n\n                row = rows[position];\n\n                cell.index = col;\n\n                if (row.cells === undefined) {\n                    row.cells = [];\n                }\n\n                if (cell.formula) {\n                    // stringify Formula object.\n                    if (cell.formula.arrayFormulaRange) {\n                        cell.formula = {\n                            src: cell.formula.toString(),\n                            ref: cell.formula.arrayFormulaRange.toString()\n                        };\n                    } else {\n                        cell.formula = cell.formula.toString();\n                    }\n                }\n\n                if (cell.validation) {\n                    cell.validation = cell.validation.toJSON();\n                }\n\n                if (cell.color) {\n                    cell.color = kendo.parseColor(cell.color).toCss();\n                }\n\n                if (cell.background) {\n                    cell.background = kendo.parseColor(cell.background).toCss();\n                }\n\n                if (cell.borderTop && cell.borderTop.color) {\n                    cell.borderTop.color = kendo.parseColor(cell.borderTop.color).toCss();\n                }\n\n                if (cell.borderBottom && cell.borderBottom.color) {\n                    cell.borderBottom.color = kendo.parseColor(cell.borderBottom.color).toCss();\n                }\n\n                if (cell.borderRight && cell.borderRight.color) {\n                    cell.borderRight.color = kendo.parseColor(cell.borderRight.color).toCss();\n                }\n\n                if (cell.borderLeft && cell.borderLeft.color) {\n                    cell.borderLeft.color = kendo.parseColor(cell.borderLeft.color).toCss();\n                }\n\n                row.cells.push(cell);\n            });\n\n            var json = {\n                name: this._name(),\n                rows: rows,\n                columns: columns,\n                selection: viewSelection.selection.toString(),\n                activeCell: viewSelection.activeCell().toString(),\n                frozenRows: this.frozenRows(),\n                frozenColumns: this.frozenColumns(),\n                showGridLines: this.showGridLines(),\n                gridLinesColor: this.gridLinesColor(),\n                mergedCells: this._mergedCells.map(function(ref) {\n                    return ref.toString();\n                }),\n                hyperlinks: hyperlinks,\n                defaultCellStyle: defaultCellStyle,\n                drawings: this._drawings.map(function(dr){\n                    return dr.toJSON();\n                })\n            };\n\n            if (this._sort) {\n               json.sort = {\n                   ref: this._sort.ref.toString(),\n                   columns: this._sort.columns.map(function(column) {\n                       return {\n                           index: column.index,\n                           ascending: column.ascending\n                       };\n                   })\n               };\n            }\n\n            if (this._filter) {\n               json.filter = {\n                   ref: this._filter.ref.toString(),\n                   columns: this._filter.columns.map(function(column) {\n                        var filter = column.filter.toJSON();\n                        filter.index = column.index;\n                        return filter;\n                   })\n               };\n            }\n\n            return json;\n        },\n\n        fromJSON: function(json) {\n            this.batch(function() {\n                if (json.name !== undefined) {\n                    this._name(json.name);\n                }\n\n                if (json.frozenColumns !== undefined) {\n                    this.frozenColumns(json.frozenColumns);\n                }\n\n                if (json.frozenRows !== undefined) {\n                    this.frozenRows(json.frozenRows);\n                }\n\n                if (json.columns !== undefined) {\n                    this._columns.fromJSON(\"width\", json.columns);\n                }\n\n                if (json.rows !== undefined) {\n                    this._resizeForJSON(json.rows);\n                    this._rows.fromJSON(\"height\", json.rows);\n\n                    for (var ri = 0; ri < json.rows.length; ri++) {\n                        var row = json.rows[ri];\n                        var rowIndex = row.index;\n\n                        if (rowIndex === undefined) {\n                            rowIndex = ri;\n                        }\n\n                        if (row.cells) {\n                            for (var ci = 0; ci < row.cells.length; ci++) {\n                                var cell = row.cells[ci];\n                                var columnIndex = cell.index;\n\n                                if (columnIndex === undefined) {\n                                    columnIndex = ci;\n                                }\n\n                                if (cell.formula) {\n                                    var isArray = typeof cell.formula != \"string\";\n                                    var src = isArray ? cell.formula.src : cell.formula;\n                                    var formula = this._compileFormula(rowIndex, columnIndex, src);\n                                    if (isArray) {\n                                        formula.setArrayFormulaRange(\n                                            kendo.spreadsheet.calc.parseReference(cell.formula.ref));\n                                    }\n                                    cell.formula = formula;\n                                }\n\n                                if (cell.validation) {\n                                    cell.validation = this._compileValidation(rowIndex, columnIndex, cell.validation);\n                                }\n\n                                this._properties.fromJSON(this._grid.index(rowIndex, columnIndex), cell);\n                            }\n                        }\n                    }\n                }\n\n                if (json.drawings) {\n                    this._drawings = json.drawings.map(Drawing.fromJSON);\n                }\n\n                if (json.selection) {\n                    this._viewSelection.selection =\n                        this._viewSelection.originalSelection = this._ref(json.selection);\n                }\n\n                if (json.activeCell) {\n                    var activeCellRef = this._ref(json.activeCell);\n\n                    this._viewSelection._activeCell = activeCellRef.toRangeRef();\n                    this._viewSelection.originalActiveCell = activeCellRef.first();\n                }\n\n\n                if (json.mergedCells) {\n                    json.mergedCells.forEach(function(ref) {\n                       this.range(ref).merge();\n                    }, this);\n                }\n\n                if (json.sort) {\n                    this._sort = {\n                        ref: this._ref(json.sort.ref),\n                        columns: json.sort.columns.slice(0)\n                    };\n                }\n\n                if (json.filter) {\n                    var ref = json.filter.ref;\n                    var columns = json.filter.columns  === undefined ? [] : json.filter.columns;\n\n                    if (!ref) {\n                        kendo.logToConsole(\"Dropping filter for sheet '\" + json.name + \"' due to missing ref\");\n                    } else {\n                        this._filter = {\n                            ref: this._ref(ref),\n                            columns: columns.map(function(column) {\n                                return {\n                                    index: column.index,\n                                    filter: kendo.spreadsheet.Filter.create(column)\n                                };\n                            })\n                        };\n\n                        this._refreshFilter();\n                    }\n                }\n\n                if (json.showGridLines !== undefined) {\n                    this._showGridLines = json.showGridLines;\n                }\n\n                this._gridLinesColor = json.gridLinesColor;\n            });\n\n            this._rows._refresh();\n            this._columns._refresh();\n        },\n\n        formula: function(ref) {\n            return this._properties.get(\"formula\", this._grid.cellRefIndex(ref));\n        },\n\n        validation: function(ref) {\n            return this._properties.get(\"validation\", this._grid.cellRefIndex(ref));\n        },\n\n        // NOTE: resetFormulas should be called first.  We don't do it in this\n        // function because it should be done from the Workbook object for all\n        // sheets.\n        resetFormulas: function() {\n            this._forFormulas(function(formula){\n                formula.reset();\n            });\n        },\n\n        resetValidations: function() {\n            this._forValidations(function(validation){\n                validation.reset();\n            });\n        },\n\n        recalc: function(context, callback) {\n            var formulas = this._properties.get(\"formula\").values();\n            var count = formulas.length, pending = 0, i = 0;\n            if (!count && callback) {\n                return callback();\n            }\n            function next() {\n                pending--;\n                if (i == count && !pending) {\n                    callback();\n                }\n            }\n            while (i < count) {\n                pending++;\n                formulas[i++].value.exec(context, callback ? next : null);\n            }\n        },\n\n        revalidate: function(context) {\n            var self = this;\n            this._forValidations(function(validation){\n                var cellRef = new CellRef(validation.row, validation.col);\n                var ref =  new RangeRef(cellRef, cellRef);\n                validation.exec(context, self._get(ref, \"value\"), self._get(ref, \"format\"));\n            });\n        },\n\n        _value: function(row, col, value) {\n            var index = this._grid.index(row, col);\n\n            if (value !== undefined) {\n                this._properties.set(\"value\", index, index, value);\n            } else {\n                return this._properties.get(\"value\", index);\n            }\n        },\n\n        _validation: function(row, col) {\n            var index = this._grid.index(row, col);\n\n            return this._properties.get(\"validation\", index);\n        },\n\n        _compileValidation: function(row, col, validation) {\n            if (validation instanceof kendo.spreadsheet.validation.Validation) {\n                // do not alter an existing object.\n                return validation.clone(this._name(), row, col);\n            }\n\n            if (validation.from != null) {\n                validation.from = (validation.from + \"\").replace(/^=/, \"\");\n            }\n\n            if (validation.to != null) {\n                validation.to = (validation.to + \"\").replace(/^=/, \"\");\n            }\n\n            return kendo.spreadsheet.validation.compile(this._name(), row, col, validation);\n        },\n\n        _compileFormula: function(row, col, f) {\n            f = f.replace(/^=/, \"\");\n            f = kendo.spreadsheet.calc.parseFormula(this._name(), row, col, f);\n            return kendo.spreadsheet.calc.compile(f);\n        },\n\n        _copyValuesInRange: function (topLeft, bottomRight, value, property) {\n            var ci, start, end;\n\n            for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                start = this._grid.index(topLeft.row, ci);\n                end = this._grid.index(bottomRight.row, ci);\n                for (var index = start, row = topLeft.row; index <= end; ++index, ++row) {\n                    // Even if it's the same formula in multiple cells, we\n                    // need to have different Formula objects, hence cloning\n                    // it.  Don't worry, clone() is fast.\n                    value = value.clone(this._name(), row, ci);\n                    this._properties.set(property, index, index, value);\n                }\n            }\n            return value;\n        },\n\n        _set: function(ref, name, value) {\n            var topLeft = this._grid.normalize(ref.topLeft);\n            var bottomRight = this._grid.normalize(ref.bottomRight);\n            var ci, start, end;\n\n            if (typeof value == \"number\") {\n                // Apparently, Excel (and LibreOffice and Google\n                // Sheets) will limit precision to 14 digits; type:\n                // -4.2524999999999995 and you get -4.2525.  The\n                // formula engine already does something similar for\n                // intermediate formula results, but we must do it\n                // here as well for original input values.\n                value = kendo.spreadsheet.calc.runtime.limitPrecision(value);\n            }\n\n            if (value && name == \"formula\") {\n                if (typeof value == \"string\") {\n                    // get Formula object.  we don't care about handling errors\n                    // here since it won't be called interactively.\n                    value = this._compileFormula(topLeft.row, topLeft.col, value);\n                }\n\n                value = this._copyValuesInRange(topLeft, bottomRight, value, \"formula\");\n\n            } else if (value && name == \"validation\") {\n                value = this._compileValidation(topLeft.row, topLeft.col, value);\n                value = this._copyValuesInRange(topLeft, bottomRight, value, \"validation\");\n\n            } else {\n                for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    start = this._grid.index(topLeft.row, ci);\n                    end = this._grid.index(bottomRight.row, ci);\n                    this._properties.set(name, start, end, value);\n                    if (name == \"formula\") {\n                        // removing a formula, must clear value.\n                        this._properties.set(\"value\", start, end, null);\n                    }\n                }\n            }\n        },\n\n        _get: function(ref, name) {\n            var topLeft = this._grid.normalize(ref.topLeft);\n\n            var index = this._grid.index(topLeft.row, topLeft.col);\n\n            return this._properties.get(name, index);\n        },\n\n        batch: function(callback, reason) {\n            var suspended = this.suspendChanges();\n\n            this.suspendChanges(true);\n            this._valueChanged = false;\n\n            callback.call(this);\n\n            if (!reason) {\n                reason = { recalc: true };\n            }\n            if (this._valueChanged) {\n                reason.isValue = true;\n            }\n\n            return this.suspendChanges(suspended).triggerChange(reason);\n        },\n\n        _sortBy: function(ref, columns) {\n            var indices = null;\n\n            columns.forEach(function(column) {\n                indices = this._sorter.sortBy(ref, column.index, this._properties.get(\"value\"), column.ascending, indices);\n            }, this);\n\n            this._sort = {\n                ref: ref,\n                columns: columns\n            };\n\n            this._refreshFilter();\n\n            this.forEach(ref, function(row, col, props) {\n                var formula = props.formula;\n                if (formula) {\n                    var diff = row - formula.row;\n                    if (diff !== 0) {\n                        var start = diff > 0 ? formula.row : formula.row + diff;\n                        formula.adjust(this.name(), \"row\", start, diff);\n                    }\n                }\n            }.bind(this));\n\n            this.triggerChange({ recalc: true });\n        },\n\n        _refreshFilter: function() {\n            if (this._filter) {\n                this._filterBy(this._filter.ref, this._filter.columns);\n            }\n        },\n\n        _filterBy: function(ref, columns) {\n            this.batch(function() {\n                for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                    if (this.isFilteredRow(ri)) {\n                        this._filteredRows.value(ri, ri, false);\n                        this._rows.unhide(ri);\n                    }\n                }\n\n                columns.forEach(function(column) {\n                    // do not filter header row\n                    var columnRef = ref.resize({ top: 1 }).toColumn(column.index);\n\n                    var cells = [];\n\n                    if (columnRef === kendo.spreadsheet.NULLREF) {\n                        return;\n                    }\n\n                    this.forEach(columnRef, function(row, col, cell) {\n                        cell.row = row;\n                        cells.push(cell);\n                    });\n\n                    column.filter.prepare(cells);\n\n                    for (var ci = 0; ci < cells.length; ci++) {\n                        var cell = cells[ci];\n                        var value = column.filter.value(cell);\n\n                        if (column.filter.matches(value) === false) {\n                            this._filterRow(cell.row);\n                        }\n                    }\n                }, this);\n\n                this._filter = {\n                    ref: ref,\n                    columns: columns\n                };\n            }, { recalc: true, layout: true, filter: true });\n        },\n\n        filterColumn: function(ref) {\n            var filterRef = this.filter().ref;\n            return ref.toRangeRef().topLeft.col - filterRef.topLeft.col;\n        },\n\n        filter: function() {\n            return this._filter;\n        },\n\n        clearFilter: function(spec) {\n            this._clearFilter(spec instanceof Array ? spec : [spec]);\n        },\n\n        _clearFilter: function(indices) {\n            if (this._filter) {\n                this.batch(function() {\n                    this._filter.columns = this._filter.columns.filter(function(column) {\n                        return indices.indexOf(column.index) < 0;\n                    });\n\n                    this._refreshFilter();\n                }, { recalc: true, layout: true, filter: true });\n            }\n        },\n\n        getAxisState: function() {\n            return {\n                rows: this._rows.getState(),\n                columns: this._columns.getState()\n            };\n        },\n\n        setAxisState: function(state) {\n            this._rows.setState(state.rows);\n            this._columns.setState(state.columns);\n            this.triggerChange({ layout: true });\n        },\n\n        getState: function() {\n            return {\n                rows: this._rows.getState(),\n                columns: this._columns.getState(),\n                mergedCells: this._mergedCells.map(function(cell) { return cell.clone(); }),\n                properties: this._properties.getState()\n            };\n        },\n\n        setState: function(state) {\n            this._rows.setState(state.rows);\n            this._columns.setState(state.columns);\n            this._mergedCells = state.mergedCells;\n            this._properties.setState(state.properties);\n            this.triggerChange(kendo.spreadsheet.ALL_REASONS);\n        },\n\n        _merge: function(ref) {\n            var mergedCells = this._mergedCells;\n\n            var sheet = this;\n            var mergedRef;\n            this.batch(function() {\n                mergedRef = ref.map(function(ref) {\n                    if (ref instanceof kendo.spreadsheet.CellRef) {\n                        return ref;\n                    }\n\n                    var currentRef = ref.toRangeRef().union(mergedCells, function(ref) {\n                        mergedCells.splice(mergedCells.indexOf(ref), 1);\n                    });\n\n                    var range = new Range(currentRef, sheet);\n                    var formula = range._get(\"formula\");\n                    var value = range.value();\n                    var format = range.format();\n                    var background = range.background();\n\n                    range.value(null);\n                    range.format(null);\n                    range.background(null);\n\n                    var topLeft = new Range(currentRef.collapse(), sheet);\n\n                    if (formula) {\n                        topLeft._set(\"formula\", formula);\n                    } else {\n                        topLeft.value(value);\n                    }\n                    topLeft.format(format);\n                    topLeft.background(background);\n\n                    mergedCells.push(currentRef);\n                    return currentRef;\n                });\n\n                var viewSelection = sheet._viewSelection;\n\n                viewSelection.selection = sheet.unionWithMerged(viewSelection.originalSelection);\n                viewSelection._activeCell = sheet.unionWithMerged(viewSelection.originalActiveCell);\n            }, { activeCell: true, selection: true });\n\n            return mergedRef;\n        },\n\n        _useCultureDecimals: function() {\n            return this._workbook && this._workbook.options.useCultureDecimals;\n        },\n\n        withCultureDecimals: function(f) {\n            var dot = \".\";\n            if (this._useCultureDecimals()) {\n                dot = kendo.culture().numberFormat[\".\"];\n            }\n            return kendo.spreadsheet.calc.withDecimalSeparator(dot, f);\n        },\n\n        drawingBoundingBox: function(drawing) {\n            var left = drawing.offsetX;\n            var top = drawing.offsetY;\n            if (drawing.topLeftCell) {\n                // offsets are relative to cell\n                left += this._columns.sum(0, drawing.topLeftCell.col - 1);\n                top += this._rows.sum(0, drawing.topLeftCell.row - 1);\n            }\n            return new kendo.spreadsheet.Rectangle(left, top, drawing.width, drawing.height);\n        },\n\n        refBoundingBox: function(ref) {\n            return this._grid.rectangle(ref.toRangeRef());\n        },\n\n        addDrawing: function(drw, activate) {\n            if (!(drw instanceof Drawing)) {\n                drw = new Drawing(drw);\n            }\n            this._drawings.push(drw);\n            if (activate) {\n                this._activeDrawing = drw;\n            }\n            this.triggerChange({ layout: true });\n            return drw;\n        },\n\n        removeDrawing: function(drawing) {\n            var pos = this._drawings.indexOf(drawing);\n            if (pos >= 0) {\n                this._drawings.splice(pos, 1);\n                this.triggerChange({ layout: true });\n            }\n        },\n\n        usesImage: function(img) {\n            for (var i = this._drawings.length; --i >= 0;) {\n                if (this._drawings[i].image === img) {\n                    return true;\n                }\n            }\n            return false;\n        },\n\n        isMerged: function(ref) {\n            var merged = this._mergedCells;\n            for (var i = merged.length; --i >= 0;) {\n                if (merged[i].eq(ref)) {\n                    return true;\n                }\n            }\n            return false;\n        }\n    });\n\n    var Drawing = kendo.Class.extend({\n        init: function Drawing(args) {\n            this.reset(args);\n        },\n\n        toJSON: function() {\n            return {\n                topLeftCell: this.topLeftCell.toString(),\n                offsetX: this.offsetX,\n                offsetY: this.offsetY,\n                width: this.width,\n                height: this.height,\n                image: this.image,\n                opacity: this.opacity\n            };\n        },\n\n        clone: function() {\n            return new Drawing(this);\n        },\n\n        reset: function(dr) {\n            var anchor = dr.topLeftCell;\n            if (typeof anchor == \"string\") {\n                anchor = kendo.spreadsheet.calc.parseReference(anchor);\n            }\n            this.topLeftCell = anchor;\n            this.offsetX = dr.offsetX || 0;\n            this.offsetY = dr.offsetY || 0;\n            this.width = dr.width;\n            this.height = dr.height;\n            this.image = dr.image;\n            this.opacity = dr.opacity != null ? dr.opacity : 1;\n        },\n\n        eq: function(dr) {\n            return ((!this.topLeftCell && !dr.topLeftCell)\n                    || (this.topLeftCell && dr.topLeftCell\n                        && this.topLeftCell.eq(dr.topLeftCell)))\n                && this.offsetX === dr.offsetX\n                && this.offsetY === dr.offsetY\n                && this.width === dr.width\n                && this.height === dr.height\n                && this.image === dr.image\n                && this.opacity === dr.opacity;\n        }\n    });\n\n    Drawing.fromJSON = function(args) {\n        return new Drawing(args);\n    };\n\n    kendo.spreadsheet.Sheet = Sheet;\n    kendo.spreadsheet.Drawing = Drawing;\n})(kendo);\n\n}, __webpack_require__.amdD);\n\n\n/***/ }),\n\n/***/ 97757:\n/***/ (function(module) {\n\n\"use strict\";\nmodule.exports = require(\"../kendo.color\");\n\n/***/ }),\n\n/***/ 54752:\n/***/ (function(module) {\n\n\"use strict\";\nmodule.exports = require(\"../kendo.core\");\n\n/***/ }),\n\n/***/ 81200:\n/***/ (function(module) {\n\n\"use strict\";\nmodule.exports = require(\"./references\");\n\n/***/ }),\n\n/***/ 22360:\n/***/ (function(module) {\n\n\"use strict\";\nmodule.exports = require(\"./runtime\");\n\n/***/ }),\n\n/***/ 26232:\n/***/ (function(module) {\n\n\"use strict\";\nmodule.exports = require(\"./validation\");\n\n/***/ })\n\n/******/ \t});\n/************************************************************************/\n/******/ \t// The module cache\n/******/ \tvar __webpack_module_cache__ = {};\n/******/ \t\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/ \t\t// Check if module is in cache\n/******/ \t\tvar cachedModule = __webpack_module_cache__[moduleId];\n/******/ \t\tif (cachedModule !== undefined) {\n/******/ \t\t\treturn cachedModule.exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = __webpack_module_cache__[moduleId] = {\n/******/ \t\t\t// no module.id needed\n/******/ \t\t\t// no module.loaded needed\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/ \t\n/******/ \t\t// Execute the module function\n/******/ \t\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n/******/ \t\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/ \t\n/************************************************************************/\n/******/ \t/* webpack/runtime/amd define */\n/******/ \t!function() {\n/******/ \t\t__webpack_require__.amdD = function () {\n/******/ \t\t\tthrow new Error('define cannot be used indirect');\n/******/ \t\t};\n/******/ \t}();\n/******/ \t\n/************************************************************************/\n/******/ \t\n/******/ \t// startup\n/******/ \t// Load entry module and return exports\n/******/ \t// This entry module used 'module' so it can't be inlined\n/******/ \tvar __webpack_exports__ = __webpack_require__(26929);\n/******/ \tmodule.exports = __webpack_exports__;\n/******/ \t\n/******/ })()\n;"],"mappings":"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"},"metadata":{},"sourceType":"script"}
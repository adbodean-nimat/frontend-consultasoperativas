!function(){var e,i={39268:function(e,t,i){var r;i=[i(54752),i(70867),i(16784),i(67539)],void 0===(t="function"==typeof(r=function(){var _=window.kendo,c=_.jQuery,u=_.spreadsheet.CellRef,s=".",a=7,d=20,l="Error",f={view:"k-spreadsheet-view",fixedContainer:"k-spreadsheet-fixed-container",editContainer:"k-spreadsheet-edit-container",scroller:"k-spreadsheet-scroller",viewSize:"k-spreadsheet-view-size",clipboard:"k-spreadsheet-clipboard",cellEditor:"k-spreadsheet-cell-editor",barEditor:"k-spreadsheet-editor",topCorner:"k-spreadsheet-top-corner",filterHeadersWrapper:"k-filter-wrapper",filterRange:"k-filter-range",filterButton:"k-spreadsheet-filter",filterButtonSelected:"k-selected",horizontalResize:"k-horizontal-resize",verticalResize:"k-vertical-resize",icon:"k-icon",iconFilterDefault:"k-i-arrow-60-down",sheetsBar:"k-spreadsheet-sheets-bar",sheetsBarActive:"k-spreadsheet-sheets-bar-active",sheetsBarInactive:"k-spreadsheet-sheets-bar-inactive",cellContextMenu:"k-spreadsheet-cell-context-menu",rowHeaderContextMenu:"k-spreadsheet-row-header-context-menu",colHeaderContextMenu:"k-spreadsheet-col-header-context-menu",drawingContextMenu:"k-spreadsheet-drawing-context-menu"};function e(e){var t=window.getSelection();t.removeAllRanges();var i=document.createRange();i.selectNodeContents(e);t.addRange(i)}function m(e,t){var i=e.trs[t].children;return i[i.length-2]}function v(e,t){var i=e.trs[t-1];var r=e.trs[t].children.length-1;if(i&&r>=0)return i.children[r]}function w(e){return(e.size||1)+"px solid "+(e.color||"#000")}function C(e){if(!/:\/\//.test(e))e="http://"+e;return e}function k(h,r,e,c){function u(e){var t=r.link;if(!t)if(typeof r.value=="object")t=r.value.link;if(t){var i={textDecoration:"none"};if(r.color)i.color=r.color;if(r.underline)i.textDecoration="underline";return _.dom.element("a",{href:C(t),style:i,target:"_blank"},e?[e]:[])}return e}var f=r.value!=null||r.validation!=null&&!r.validation.value||r.background||r.merged||r.comment;if(!e&&!f)return;var t={};var i=r.background;if(i){var s=i;if(c){s=_.parseColor(s).toHSV();s.v*=.9;s=s.toCssRgba()}s=w({color:s});t.outline=s}if(i)t.backgroundColor=i;if(r.color)t.color=r.color;if(r.fontFamily)t.fontFamily=r.fontFamily;if(r.underline)t.textDecoration="underline";if(r.italic)t.fontStyle="italic";if(r.textAlign)t.textAlign=r.textAlign;if(r.bold)t.fontWeight="bold";if(r.fontSize)t.fontSize=r.fontSize+"px";if(r.wrap===true){t.whiteSpace="pre-wrap";t.overflowWrap="break-word";t.wordWrap="break-word"}else{t.whiteSpace="pre";t.overflowWrap="normal";t.wordWrap="normal"}t.left=r.left+1+"px";t.top=r.top+1+"px";t.width=r.width-1+"px";t.height=r.height-1+"px";var n=r.value,a=typeof n,o=r.format;if(!o&&a=="number"&&n!=Math.floor(n))o="0.##############";if(o&&n!=null){n=_.spreadsheet.formatting.format(n,o);if(n.__dataType)a=n.__dataType}else if(n!==null&&n!==undefined)if(r.html)n=_.dom.html(n);else n=_.dom.text(n);if(!t.textAlign)switch(a){case"number":case"date":case"percent":case"currency":t.textAlign="right";break;case"boolean":t.textAlign="center";break}_.spreadsheet.draw.applyIndent(r,t);var l=[b.cell];if(e)l.push(e);if(r.enable===false)l.push("k-disabled");if(r.merged)l.push("k-spreadsheet-merged-cell");if(r.comment)l.push("k-spreadsheet-has-comment");var p=r.verticalAlign||"bottom";if(p&&n)n=_.dom.element("div",{className:"k-vertical-align-"+p},[u(n)]);else n=u(n);var m=n?[n]:[];var d={style:t};var v=r.validation;if(v&&!v.value){m.push(_.dom.element("span",{className:"k-dirty"}));l.push("k-dirty-cell");d.title=v.message}d.className=l.join(" ");var g=_.dom.element("div",d,m);h.push(g);return g}function h(e,t,i){var r={};if(i.background)r.backgroundColor=i.background;if(i.color)r.color=i.color;if(i.fontFamily)r.fontFamily=i.fontFamily;if(i.underline)r.textDecoration="underline";if(i.italic)r.fontStyle="italic";if(i.textAlign)r.textAlign=i.textAlign;if(i.verticalAlign)r.verticalAlign=i.verticalAlign==="center"?"middle":i.verticalAlign;if(i.bold)r.fontWeight="bold";if(i.fontSize)r.fontSize=i.fontSize+"px";if(i.wrap===true)r.whiteSpace="pre-wrap";if(i.borderRight)r.borderRight=w(i.borderRight);else if(i.background)r.borderRightColor=i.background;if(i.borderBottom)r.borderBottom=w(i.borderBottom);else if(i.background)r.borderBottomColor=i.background;var s=i.value,n=typeof s,a=i.format;if(!a&&n=="number"&&s!=Math.floor(s))a="0.##############";if(a&&s!=null){s=_.spreadsheet.formatting.format(s,a);if(s.__dataType)n=s.__dataType}if(!r.textAlign)switch(n){case"number":case"date":case"percent":case"currency":r.textAlign="right";break;case"boolean":r.textAlign="center";break}var o=null;if(i.enable===false)o="k-disabled";var h=e.addCell(t,s,r,o,i.validation);var l,d;if(i.borderLeft){d=m(e,t);l=w(i.borderLeft);if(d&&l)d.attr.style.borderRight=l}else if(i.background)r.borderLeftColor=i.background;if(i.borderTop){d=v(e,t);l=w(i.borderTop);if(d&&l)d.attr.style.borderBottom=l}else if(i.background)r.borderTopColor=i.background;return h}_.spreadsheet.messages.view={nameBox:"Name Box",errors:{openUnsupported:"Unsupported format. Please select an .xlsx file.",shiftingNonblankCells:"Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet.",insertColumnWhenRowIsSelected:"Cannot insert column when all columns are selected.",insertRowWhenColumnIsSelected:"Cannot insert row when all rows are selected.",filterRangeContainingMerges:"Cannot create a filter within a range containing merges",sortRangeContainingMerges:"Cannot sort a range containing merges",cantSortMultipleSelection:"Cannot sort multiple selection",cantSortNullRef:"Cannot sort empty selection",cantSortMixedCells:"Cannot sort range containing cells of mixed shapes",validationError:"The value that you entered violates the validation rules set on the cell.",cannotModifyDisabled:"Cannot modify disabled cells.",insertRowBelowLastRow:"Cannot insert row below the last row.",insertColAfterLastCol:"Cannot insert column to the right of the last column."},tabs:{home:"Home",insert:"Insert",data:"Data"}},_.spreadsheet.messages.menus={cut:"Cut",copy:"Copy",paste:"Paste",merge:"Merge",unmerge:"Unmerge",delete:"Delete",hide:"Hide",unhide:"Unhide",bringToFront:"Bring to front",sendToBack:"Send to back"};var n=_.Class.extend({init:function(){this.cols=[];this.trs=[];this._height=0;this._width=0},addColumn:function(e){this._width+=e;var t=_.dom.element("col",{style:{width:e+"px"}});t.visible=e>0;this.cols.push(t)},addRow:function(e){var t=null;t={style:{height:e+"px"}};this._height+=e;var i=_.dom.element("tr",t);i.visible=e>0;this.trs.push(i)},addCell:function(e,t,i,r,s){if(t===null||t===undefined)t="";if(!(t instanceof _.dom.Node))t=_.dom.text(t);var n=[t];var a={style:i};if(s&&!s.value){n.push(_.dom.element("span",{className:"k-dirty"}));r=(r||"")+(r?" ":"")+"k-dirty-cell";a.title=s.message}if(r)a.className=r;var o=_.dom.element("td",a,n);this.trs[e].children.push(o);return o},toDomTree:function(e,t,i){this.trs=this.trs.filter(function(e){return e.visible});var r=0;this.cols=this.cols.filter(function(e,t){if(!e.visible){this.trs.forEach(function(e){e.children.splice(t-r,1)});r++}return e.visible},this);return _.dom.element("table",{style:{left:e+"px",top:t+"px",height:this._height+"px",width:this._width+"px"},className:i,role:"presentation"},[_.dom.element("colgroup",null,this.cols),_.dom.element("tbody",null,this.trs)])}}),t='<ul class="#=classNames.cellContextMenu#">'+"<li data-action=cut>#: messages.cut #</li>"+"<li data-action=copy>#: messages.copy #</li>"+"<li data-action=paste>#: messages.paste #</li>"+'<li class="k-separator"></li>'+"<li data-action=merge>#: messages.merge #</li>"+"<li data-action=unmerge>#: messages.unmerge #</li>"+"</ul>",i='<ul class="#=classNames.rowHeaderContextMenu#">'+"<li data-action=cut>#: messages.cut #</li>"+"<li data-action=copy>#: messages.copy #</li>"+"<li data-action=paste>#: messages.paste #</li>"+'<li class="k-separator"></li>'+'<li data-action="delete-row">#: messages.delete #</li>'+'<li data-action="hide-row">#: messages.hide #</li>'+'<li data-action="unhide-row">#: messages.unhide #</li>'+"</ul>",r='<ul class="#=classNames.colHeaderContextMenu#">'+"<li data-action=cut>#: messages.cut #</li>"+"<li data-action=copy>#: messages.copy #</li>"+"<li data-action=paste>#: messages.paste #</li>"+'<li class="k-separator"></li>'+'<li data-action="delete-column">#: messages.delete #</li>'+'<li data-action="hide-column">#: messages.hide #</li>'+'<li data-action="unhide-column">#: messages.unhide #</li>'+"</ul>",o='<ul class="#=classNames.drawingContextMenu#">'+'<li data-action="bring-to-front">#: messages.bringToFront #</li>'+'<li data-action="send-to-back">#: messages.sendToBack #</li>'+'<li class="k-separator"></li>'+'<li data-action="delete-drawing">#: messages.delete #</li>'+"</ul>",g=(_.spreadsheet.ContextMenu=_.ui.ContextMenu,_.template('<div class="#=classNames.view#"><div class="#=classNames.fixedContainer#"></div><div class="#=classNames.scroller#"><div class="#=classNames.viewSize#"></div></div>'+'<div tabindex="0" class="#=classNames.clipboard#" contenteditable=true></div><div class="#=classNames.cellEditor#"></div></div><div class="#=classNames.sheetsBar#"></div>'+t+i+r+o));function y(e,t,i){return e>=t&&e<=i}var p=_.Class.extend({init:function(e,t){var i=p.classNames;this.element=e;this.options=c.extend(true,{messages:_.spreadsheet.messages.view},this.options,t);this._chrome();this._dialogs=[];e.append(g({classNames:i,messages:_.spreadsheet.messages.menus}));this._formulaInput();this.wrapper=e.find(s+i.view);this.container=e.find(s+i.fixedContainer)[0];this.scroller=e.find(s+i.scroller)[0];this.clipboard=e.find(s+i.clipboard);this.viewSize=c(this.scroller.firstChild);this.tree=new _.dom.Tree(this.container);this.clipboardContents=new _.dom.Tree(this.clipboard[0]);this.editor=new _.spreadsheet.SheetEditor(this);this._sheetsbar();var r={target:e,animation:false,showOn:"never"};this.cellContextMenu=new _.spreadsheet.ContextMenu(e.find(s+i.cellContextMenu),r);this.colHeaderContextMenu=new _.spreadsheet.ContextMenu(e.find(s+i.colHeaderContextMenu),r);this.rowHeaderContextMenu=new _.spreadsheet.ContextMenu(e.find(s+i.rowHeaderContextMenu),r);this.drawingContextMenu=new _.spreadsheet.ContextMenu(e.find(s+i.drawingContextMenu),r)},enableClipboard:function(e){this.isClipboardDeactivated=!e;if(e)this.clipboard.attr("contenteditable",e);else this.clipboard.removeAttr("contenteditable")},_resize:function(){var e=c(this.formulaBar.element).parents(".k-spreadsheet-action-bar");var t=_._outerHeight;var i=this.tabstrip?t(this.tabstrip.element):0;var r=e?t(e):0;var s=this.sheetsbar?t(this.sheetsbar.element):0;this.wrapper.height(this.element.height()-(i+r+s));if(this.tabstrip)this.tabstrip.quickAccessAdjust()},_chrome:function(){var e=c("<div class='k-spreadsheet-action-bar' />").prependTo(this.element);var t=c("<div class='k-spreadsheet-name-editor' />").appendTo(e);this.nameEditor=new _.spreadsheet.NameEditor(t,this.options);var i=c("<div />").appendTo(e);this.formulaBar=new _.spreadsheet.FormulaBar(i);if(this.options.toolbar)this._tabstrip()},_formulaInput:function(){var e=this.element.find(s+p.classNames.cellEditor);this.formulaInput=new _.spreadsheet.FormulaInput(e,{autoScale:true})},_sheetsbar:function(){if(this.options.sheetsbar){var e=c.extend(true,{openDialog:this.openDialog.bind(this)},this.options.sheetsbar);this.sheetsbar=new _.spreadsheet.SheetsBar(this.element.find(s+p.classNames.sheetsBar),e)}},_tabstrip:function(){var e=this.options.messages.tabs;var t=c.extend(true,{home:true,insert:true,data:true},this.options.toolbar);var i=[];if(this.tabstrip){this.tabstrip.destroy();this.element.children(".k-tabstrip").remove()}for(var r in t)if(t[r]===true||t[r]instanceof Array)i.push({id:r,text:e[r],content:""});this.tabstrip=new _.spreadsheet.TabStrip(c("<div />").prependTo(this.element),{animation:false,dataTextField:"text",dataContentField:"content",dataSource:i,toolbarOptions:t,view:this});this.tabstrip.select(0)},_executeCommand:function(e){this._sheet.trigger("commandRequest",e)},workbook:function(e){this._workbook=e;e._view=this;this.nameEditor._workbook=e},sheet:function(e){this._sheet=e},activeCellRectangle:function(){return this.cellRectangle(this._sheet._viewActiveCell())},_rectangle:function(e,t){return e._grid.boundingRectangle(t.toRangeRef())},isColumnResizer:function(t,e,i){t-=this._sheet._grid._headerWidth;if(!e._grid.columns.frozen)t+=this.scroller.scrollLeft;i=this._sheet._grid._columns.locate(0,i,function(e){return Math.abs(t-e)<=a/2});return i!==null&&!this._sheet.isHiddenColumn(i)?i:null},isRowResizer:function(t,e,i){t-=this._sheet._grid._headerHeight;if(!e._grid.rows.frozen)t+=this.scroller.scrollTop;i=this._sheet._grid._rows.locate(0,i,function(e){return Math.abs(t-e)<=a/2});return i!==null&&!this._sheet.isHiddenRow(i)?i:null},isFilterIcon:function(r,s,n,e){var a=this;var t=n._grid;var i=t.rows.frozen?0:a.scroller.scrollTop;var o=t.columns.frozen?0:a.scroller.scrollLeft;r-=a._sheet._grid._headerWidth-o;s-=a._sheet._grid._headerHeight-i;return _.util.withExit(function(i){a._sheet.forEachFilterHeader(e,function(e){var t=a._rectangle(n,e);if(n.filterIconRect(t).intersects(r,s))i(true)})})},isAutoFill:function(e,t,i){var r=this._sheet.select();if(r.size>1)return false;e-=this._sheet._grid._headerWidth;t-=this._sheet._grid._headerHeight;if(!i._grid.columns.frozen)e+=this.scroller.scrollLeft;if(!i._grid.rows.frozen)t+=this.scroller.scrollTop;var s=this._rectangle(i,r);return Math.abs(s.right-e)<8&&Math.abs(s.bottom-t)<8},isEditButton:function(e,t,i){var r=this._sheet.activeCellCustomEditor();if(r){var s=this.activeCellRectangle();if(t>=s.top&&t<=s.bottom)return i._editorInLastColumn?e<s.left&&e>=s.left-d:e>s.right&&e<=s.right+d}},drawingAt:function(e,t,i){e-=this._sheet._grid._headerWidth;t-=this._sheet._grid._headerHeight;if(!i._grid.columns.frozen)e+=this.scroller.scrollLeft;if(!i._grid.rows.frozen)t+=this.scroller.scrollTop;var r=this._sheet;var s=this._sheet._drawings;for(var n=s.length;--n>=0;){var a=s[n];var o=r.drawingBoundingBox(a);if(o.intersects(e,t))return{drawing:a,drx:o.left-e,dry:o.top-t}}},objectAt:function(e,t,h){var i=this._sheet._grid;var r,s;if(e<0||t<0||e>this.scroller.clientWidth||t>this.scroller.clientHeight)r={type:"outside"};else if(e<i._headerWidth&&t<i._headerHeight)r={type:"topcorner"};else{s=this.paneAt(e,t);if(!s)r={type:"outside"};else{if(!h){var n=this.drawingAt(e,t,s);if(n)return{type:"drawing",drawing:n.drawing,drx:n.drx,dry:n.dry,pane:s,startX:e,startY:t}}var a=s._grid.rows.indexVisible(t,this.scroller.scrollTop);var o=s._grid.columns.indexVisible(e,this.scroller.scrollLeft);var l="cell";var d=new u(a,o);var c=this._sheet.selectionInProgress();if(this.isAutoFill(e,t,s))l="autofill";else if(this.isFilterIcon(e,t,s,d))l="filtericon";else if(!c&&e<i._headerWidth){l="rowheader";if((a=this.isRowResizer(t,s,a))!==null){d=new u(a,-Infinity);l="rowresizehandle"}}else if(!c&&t<i._headerHeight){l="columnheader";if((o=this.isColumnResizer(e,s,o))!==null){d=new u(-Infinity,o);l="columnresizehandle"}}else if(this.isEditButton(e,t,s))l="editor";r={type:l,ref:d}}}r.pane=s;r.x=e;r.y=t;return r},paneAt:function(r,s){return this.panes.filter(function e(t){var i=t._grid;return y(s,i.top,i.bottom)&&y(r,i.left,i.right)})[0]},containingPane:function(t){return this.panes.filter(function(e){if(e._grid.contains(t))return true;return false})[0]},cellRectangle:function(e){var t=this.containingPane(e)._grid;var i=this._sheet._grid.rectangle(e);return i.offset(t.headerWidth-(t.columns.frozen?0:this.scroller.scrollLeft),t.headerHeight-(t.rows.frozen?0:this.scroller.scrollTop))},refresh:function(e){var t=this._sheet;if(this.tabstrip)this.tabstrip.refreshTools(t.range(t.activeCell()));if(e.sheetSelection&&this.sheetsbar)this.sheetsbar.renderSheets(this._workbook.sheets(),this._workbook.sheetIndex(this._sheet));this._resize();this.viewSize[0].style.height=t._grid.totalHeight()+"px";this.viewSize[0].style.width=t._grid.totalWidth()+"px";if(e.layout){var i=t.frozenColumns();var r=t.frozenRows();this.panes=[this._pane(r,i)];if(i>0)this.panes.push(this._pane(r,0,null,i));if(r>0)this.panes.push(this._pane(0,i,r,null));if(r>0&&i>0)this.panes.push(this._pane(0,0,r,i))}if(e.filter)this._destroyFilterMenu();if(e.activeCell)this._focus=t.activeCell().toRangeRef()},createFilterMenu:function(e){this._destroyFilterMenu();var t=this._sheet;var i=t.filter().ref;var r=new _.spreadsheet.Range(i,t);var s=c("<div />").appendTo(this.element);var n={column:e,range:r};var a=new _.spreadsheet.FilterMenu(s,n);this._filterMenu=a;return a},selectClipboardContents:function(){if(!this.isClipboardDeactivated){this.clipboard.focus();e(this.clipboard[0])}},scrollIntoView:function(e){var t=false;var i=this.containingPane(e)._grid;var r=i.scrollBoundaries(e);var s=this.scroller;var n=i.rows.frozen?0:s.scrollTop;var a=i.columns.frozen?0:s.scrollLeft;if(r.top<n){t=true;s.scrollTop=r.scrollTop}if(r.bottom>n){t=true;s.scrollTop=r.scrollBottom}if(r.left<a){t=true;s.scrollLeft=r.scrollLeft}if(r.right>a){t=true;s.scrollLeft=r.scrollRight}return t},_destroyDialog:function(){this._dialogs.pop()},openCustomEditor:function(){var i=this;var e=i._sheet.activeCell().first();var t=i._sheet.activeCellCustomEditor();var r=i._sheet.range(e);t.edit({range:r,rect:i.activeCellRectangle(),view:this,validation:this._sheet.validation(e),callback:function(e,t){i._executeCommand({command:"EditCommand",options:{operatingRange:r,editRange:r,property:t?"input":"value",value:e}})}})},openDialog:function(r,s){var n=this._sheet;return n.withCultureDecimals(function(){var e=_.spreadsheet.dialogs.create(r,s);if(e){e.bind("action",this._executeCommand.bind(this));e.bind("deactivate",this._destroyDialog.bind(this));this._dialogs.push(e);var t=n.activeCell();var i=new _.spreadsheet.Range(t,n);e.open(i);return e}}.bind(this))},showError:function(e,i){var t=this._dialogs;var r=this.options.messages.errors;var s=false;if(t.length>0)t.forEach(function(e){if(e.options&&e.options.title===l)s=true});if(s)return;var n=function(t){var e=t.sender.dialog().element;e.find(".k-button").first().trigger("focus");e.find(".k-button, input").on("keydown",function(e){if(e.keyCode==_.keys.ESC)t.sender.close()})};var a=function(e){var t=e.sender;this.selectClipboardContents();if(t._retry&&i)i()}.bind(this);if(_.spreadsheet.dialogs.registered(e.type)){var o={close:a};if(e.type==="validationError")o=c.extend(o,{title:e.title||"Error",text:e.body?e.body:r[e.type],activate:n});this.openDialog(e.type,o)}else this.openDialog("message",{title:e.title||"Error",text:e.body?e.body:r[e.type],activate:n,close:a})},destroy:function(){this._dialogs.forEach(function(e){e.destroy()});if(this.cellContextMenu)this.cellContextMenu.destroy();this.rowHeaderContextMenu.destroy();this.colHeaderContextMenu.destroy();this.drawingContextMenu.destroy();this.cellContextMenu=this.rowHeaderContextMenu=this.colHeaderContextMenu=this.drawingContextMenu=null;if(this.tabstrip){this.tabstrip.destroy();this.tabstrip=null}this._destroyFilterMenu()},_destroyFilterMenu:function(){if(this._filterMenu){this._filterMenu.destroy();this._filterMenu=undefined;this._filterMenuColumn=undefined}},render:function(e){if(!this.element.is(":visible"))return;var t=this._sheet;var i=t.focus();var r=_.support.scrollbar();var s=this.wrapper[0].clientWidth-r;var n=this.wrapper[0].clientHeight-r;if(i&&this.scrollIntoView(i))return;var a=!t.resizingInProgress()?"none":t.resizeHandlePosition().col===-Infinity?"column":"row";this.wrapper.toggleClass(f.editContainer,this.editor.isActive()).toggleClass(f.horizontalResize,a=="row").toggleClass(f.verticalResize,a=="column");var o=t._grid;var l=[];var d={scroller:this.scroller,toplevelElements:l,contentWidth:s,contentHeight:n};this.panes.forEach(function(e){l.push(e.render(d))});var h=_.dom.element("div",{style:{width:o._headerWidth+"px",height:o._headerHeight+"px"},className:p.classNames.topCorner});l.push(h);if(t.resizeHandlePosition()&&t.resizeHintPosition())l.push(this.renderResizeHint());this.tree.render(l);c(this.container).css({width:s,height:n});if(this.editor.isActive())this.editor.toggleTooltip(this.activeCellRectangle());else if(!(e.resize||e.comment||t.selectionInProgress()||t.resizingInProgress()||t.draggingInProgress()||t.isInEditMode()))this.renderClipboardContents()},renderResizeHint:function(){var e=this._sheet;var t=e.resizeHandlePosition();var i=t.col!==-Infinity;var r;if(i)r={height:this.scroller.clientHeight+"px",width:a+"px",left:e.resizeHintPosition().x+"px",top:"0px"};else r={height:a+"px",width:this.scroller.clientWidth+"px",top:e.resizeHintPosition().y+"px",left:"0px"};var s=x.classNames;return _.dom.element("div",{className:s.resizeHint+(!i?" "+s.resizeHintVertical:""),style:r},[_.dom.element("div",{className:s.resizeHintHandle}),_.dom.element("div",{className:s.resizeHintMarker})])},renderClipboardContents:function(){var e=this._sheet;var t=e._grid;var a=t.normalize(e.select().toRangeRef());var i=this._workbook.clipboard().canCopy();if(i.canCopy===false&&i.multiSelection){this.clipboardContents.render([]);this.selectClipboardContents();return}a=e.trim(a);var o=new n;var r=t.rangeDimensions(a);r.rows.forEach(function(e){o.addRow(e)});r.columns.forEach(function(e){o.addColumn(e)});var s=e._getMergedCells(a);var l=s.primary;var d=s.secondary;e.forEach(a,function(e,t,i){var r=new u(e,t).print();if(!d[r]){var s=h(o,e-a.topLeft.row,i);var n=l[r];if(n){s.attr.colspan=n.width();s.attr.rowspan=n.height()}}});if(_.support.browser.msie)this.clipboard.empty();this.clipboardContents.render([o.toDomTree(0,0,"kendo-clipboard-"+this._workbook.clipboard()._uid)]);this.selectClipboardContents()},_pane:function(e,t,i,r){var s=new x(this._sheet,this._sheet._grid.pane({row:e,column:t,rowCount:i,columnCount:r}));s.refresh(this.scroller.clientWidth,this.scroller.clientHeight);return s}}),b={cell:"k-spreadsheet-cell",vaxis:"k-spreadsheet-vaxis",haxis:"k-spreadsheet-haxis",vborder:"k-spreadsheet-vborder",hborder:"k-spreadsheet-hborder",rowHeader:"k-spreadsheet-row-header",columnHeader:"k-spreadsheet-column-header",pane:"k-spreadsheet-pane",data:"k-spreadsheet-data",mergedCell:"k-spreadsheet-merged-cell",mergedCellsWrapper:"k-merged-cells-wrapper",activeCell:"k-spreadsheet-active-cell",selection:"k-spreadsheet-selection",selectionWrapper:"k-selection-wrapper",autoFillWrapper:"k-auto-fill-wrapper",single:"k-single",top:"k-top",right:"k-right",bottom:"k-bottom",left:"k-left",resizeHandle:"k-resize-handle",columnResizeHandle:"k-column-resize-handle",rowResizeHandle:"k-row-resize-handle",resizeHint:"k-resize-hint",resizeHintHandle:"k-resize-hint-handle",resizeHintMarker:"k-resize-hint-marker",resizeHintVertical:"k-resize-hint-vertical",selectionHighlight:"k-spreadsheet-selection-highlight",series:["k-series-a","k-series-b","k-series-c","k-series-d","k-series-e","k-series-f"]},x=_.Class.extend({init:function(e,t){this._sheet=e;this._grid=t},refresh:function(e,t){this._grid.refresh(e,t)},isVisible:function(e,t,i){return this._grid.view(e,t).ref.intersects(i)},render:function(e){var t=e.scroller;var i=t.scrollLeft;var r=t.scrollTop;if(r<0)r=0;if(i<0)i=0;var s=x.classNames;var n=this._sheet;var a=this._grid;var o=a.view(i,r);this._currentView=o;this._currentRect=this._rectangle(o.ref);this._selectedHeaders=n.selectedHeaders();var l=[];l.push(this.renderData(e));if(!n._activeDrawing)l.push(this.renderSelection(t));l.push(this.renderAutoFill());l.push(this.renderEditorSelection());l.push(this.renderFilterHeaders());if(a.hasRowHeader){var h=_.dom.element("div",{className:s.rowHeader,style:{width:a.headerWidth+"px",top:o.rowOffset+"px"}});l.push(h);n.forEach(o.ref.leftColumn(),function(e){if(!n.isHiddenRow(e)){var t=e+1,i=n.rowHeight(e);h.children.push(_.dom.element("div",{className:this.headerClassName(e,"row"),style:{width:a.headerWidth+"px",height:i+"px"}},[_.dom.element("div",{className:"k-vertical-align-center"},[_.dom.text(t+"")])]))}}.bind(this))}if(a.hasColumnHeader){var c=_.dom.element("div",{className:s.columnHeader,style:{top:"0px",left:o.columnOffset+"px",width:this._currentRect.width+"px",height:a.headerHeight+"px"}});l.push(c);var u=0;n.forEach(o.ref.topRow(),function(e,t){if(!n.isHiddenColumn(t)){var i=_.spreadsheet.Ref.display(null,Infinity,t),r=n.columnWidth(t);c.children.push(_.dom.element("div",{className:this.headerClassName(t,"col"),style:{position:"absolute",left:u+"px",width:r+"px",height:a.headerHeight+"px"}},[_.dom.element("div",{className:"k-vertical-align-center"},[_.dom.text(i+"")])]));u+=r}}.bind(this))}if(n.resizeHandlePosition()&&(a.hasColumnHeader||a.hasRowHeader))if(!n.resizeHintPosition())this.renderResizeHandle(l);var d=[s.pane];if(a.hasColumnHeader)d.push(s.top);if(a.hasRowHeader)d.push(s.left);return _.dom.element("div",{style:a.style,className:d.join(" ")},l)},headerClassName:function(e,t){var i=this._selectedHeaders;var r;var s;if(t==="row"){r=i.rows[e];s=i.allRows}else{r=i.cols[e];s=i.allCols}var n=r||(i.all?"full":s?"partial":"none");if(n)n="k-selection-"+n;return n},renderData:function(d){var h=this._sheet;var c=this._currentView;var u=_.dom.element("div",{className:x.classNames.data,style:{position:"relative",left:c.columnOffset+"px",top:c.rowOffset+"px"}});var t=this._currentRect;var e=_.spreadsheet.draw.doLayout(h,c.ref,{forScreen:true}),i;var f=this._grid;var p=h._showGridLines;if(p){i=null;e.xCoords.forEach(function(e){if(e!==i){i=e;u.children.push(_.dom.element("div",{className:b.vaxis,style:{left:e+"px",height:t.height+"px",borderColor:h.gridLinesColor()}}))}});i=null;e.yCoords.forEach(function(e){if(e!==i){i=e;u.children.push(_.dom.element("div",{className:b.haxis,style:{top:e+"px",width:t.width+"px",borderColor:h.gridLinesColor()}}))}})}var m=_.spreadsheet.draw.Borders();var v=h.activeCell().toRangeRef();var g=v.topLeft;e.cells.forEach(function(e){var t=null;var i=e.row+c.ref.topLeft.row;var r=e.col+c.ref.topLeft.col;if(h._activeDrawing){var s=h._activeDrawing.topLeftCell;if(s&&s.row==i&&s.col==r)t="k-spreadsheet-drawing-anchor-cell"}else if(i==g.row&&r==g.col){t=[x.classNames.activeCell].concat(this._activeFormulaColor(),this._directionClasses(v));if(h.singleCellSelection())t.push(x.classNames.single);t=t.join(" ")}m.add(e);k(u.children,e,t,p);if(e.comment&&h._commentRef&&i==h._commentRef.row&&r==h._commentRef.col){var n=4;var a=e.right+f.left+c.columnOffset+n;var o={top:e.top+f.top+c.rowOffset+"px"};if(a+200>d.contentWidth)o.right=d.contentWidth-f.left-e.left-c.columnOffset+n+"px";else o.left=a+"px";var l=_.dom.element("div",{className:"k-tooltip k-spreadsheet-cell-comment",style:o},[_.dom.text(e.comment)]);d.toplevelElements.push(l)}},this);m.vert.forEach(function(e){e.forEach(function(e){if(!e.rendered){e.rendered=true;var t={left:e.x+"px",top:e.top+"px",height:e.bottom-e.top+1+"px",borderWidth:e.size+"px",borderColor:e.color};if(e.size!=1)t.transform="translateX(-"+(e.size-1)/2+"px)";u.children.push(_.dom.element("div",{className:b.vborder,style:t}))}})});m.horiz.forEach(function(e){e.forEach(function(e){if(!e.rendered){e.rendered=true;var t={top:e.y+"px",left:e.left+"px",width:e.right-e.left+"px",borderWidth:e.size+"px",borderColor:e.color};if(e.size!=1)t.transform="translateY(-"+(e.size-1)/2+"px)";u.children.push(_.dom.element("div",{className:b.hborder,style:t}))}})});this.renderDrawings(e,u.children);return u},renderDrawings:function(e,s){var n=this._sheet;var a=n._workbook;e.drawings.forEach(function(e){var t=e.drawing;var i=e.box;var r=i.toDiv("k-spreadsheet-drawing");if(t.image)r.children.push(_.dom.element("div",{className:"k-spreadsheet-drawing-image",style:{backgroundImage:"url('"+a.imageUrl(t.image)+"')",opacity:t.opacity}}));if(t===n._activeDrawing){r.attr.className+=" k-spreadsheet-active-drawing";z(r.children)}s.push(r)})},renderResizeHandle:function(e){var t=this._sheet;var i=t.resizeHandlePosition();var r=this._rectangle(i);var s=[x.classNames.resizeHandle];var n;if(i.col!==-Infinity){if(this._grid.rows._start>0)return;n={height:this._grid.headerHeight+"px",width:a+"px",left:r.right-a/2+"px",top:"0px"};s.push(f.horizontalResize)}else{if(this._grid.columns._start>0)return;n={height:a+"px",width:this._grid.headerWidth+"px",top:r.bottom-a/2+"px",left:"0px"};s.push(f.verticalResize)}e.push(_.dom.element("div",{className:s.join(" "),style:n}))},filterIconRect:function(e){var t=16;var i=3;return new _.spreadsheet.Rectangle(e.right-t-i,e.top+i,t,t)},renderFilterHeaders:function(){var e=this._sheet;var n=[];var a=p.classNames;var o=e.filter();function l(e){return _.dom.element("span",{className:a.icon+" "+e})}function d(e,t,i){var r={left:t.left+"px",top:t.top+"px"};var s=o&&o.columns.some(function(e){return e.index===i});var n=e.filterButton;if(s)n+=" "+e.filterButtonSelected;var a=_.dom.element("span",{className:n,style:r},[l(e.iconFilterDefault)]);return a}if(o)this._addDiv(n,o.ref,a.filterRange);e.forEachFilterHeader(this._currentView.ref,function(e){var t=this._rectangle(e);var i=this.filterIconRect(t);var r=this._sheet.filterColumn(e);var s=d(a,i,r);n.push(s)}.bind(this));return _.dom.element("div",{className:a.filterHeadersWrapper},n)},renderEditorSelection:function(){var i=x.classNames;var e=this._sheet;var r=[];e._formulaSelections.forEach(function(e){var t=e.ref;if(t===_.spreadsheet.NULLREF)return;this._addDiv(r,t,i.selectionHighlight+" "+e.colorClass)}.bind(this));return _.dom.element("div",{className:i.selectionWrapper},r)},renderSelection:function(e){var t=x.classNames;var i=[];var r=[t.selection];var s=this._sheet;var n=s.activeCell().toRangeRef();var a=s.select();r=r.concat(this._activeFormulaColor());if(a.size()===1)r.push("k-single-selection");if(this._sheet.autoFillPunch())r.push("k-dim-auto-fill-handle");a.forEach(function(e){if(e!==_.spreadsheet.NULLREF)this._addDiv(i,e,r.join(" "))}.bind(this));this._renderCustomEditorButton(i,n,e);return _.dom.element("div",{className:t.selectionWrapper},i)},renderAutoFill:function(){var e=[];if(this._sheet.autoFillInProgress()){var t=this._sheet.autoFillRef();var i=this._sheet.autoFillPunch();var r=this._sheet._autoFillDirection;this._addDiv(e,t,"k-auto-fill");if(i)this._addDiv(e,i,"k-auto-fill-punch");else if(r!==undefined){var s,n;switch(r){case 0:s=t.bottomRight;n="k-auto-fill-br-hint";break;case 1:s=t.bottomRight;n="k-auto-fill-br-hint";break;case 2:s=new u(t.topLeft.row,t.bottomRight.col);n="k-auto-fill-tr-hint";break;case 3:s=new u(t.bottomRight.row,t.topLeft.col);n="k-auto-fill-bl-hint";break}var a=this._addDiv(e,s,n);if(a){var o=_.dom.element("span",{className:"k-tooltip"},[_.dom.text(this._sheet._autoFillHint)]);a.children.push(o)}}}return _.dom.element("div",{className:x.classNames.autoFillWrapper},e)},_addDiv:function(e,t,i){var r=this._currentView,s;if(r.ref.intersects(t)){s=this._rectangle(t).resize(1,1).toDiv(i);e.push(s)}return s},_renderCustomEditorButton:function(a,e,o){var l=this;var t=l._sheet;var i=l._currentView;var d=l._grid.columns._axis._count;var h=t.activeCellCustomEditor();if(h&&i.ref.intersects(e)){var c=l._rectangle(e);t.forEach(e.collapse(),function(e,t,i){i.left=c.left;i.top=c.top;i.width=c.width;i.height=c.height;var r="k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-spreadsheet-editor-button";var s=t==d-1||l._buttonOutOfVisiblePane(e,t,o);if(s)r+=" k-spreadsheet-last-column";l._editorInLastColumn=s;var n=_.dom.element("div",{className:r,style:{left:i.left+(s?0:i.width)+"px",top:i.top+"px",height:i.height+"px"}});if(h.icon)n.children.push(_.dom.element("span",{className:"k-icon "+h.icon}));a.push(n)})}},_activeFormulaColor:function(){var e;var t=[];if(this._sheet.isInEditMode()){e=this._sheet._formulaSelections.filter(function(e){return e.active&&e.type=="ref"})[0];if(e)t.push(e.colorClass)}return t},_directionClasses:function(e){var t=[];var i=x.classNames;var r=this._currentView.ref;if(!e.move(0,-1).intersects(r))t.push(i.left);if(!e.move(-1,0).intersects(r))t.push(i.top);if(!e.move(0,1).intersects(r))t.push(i.right);if(!e.move(1,0).intersects(r))t.push(i.bottom);return t},_rectangle:function(e){return this._grid.boundingRectangle(e.toRangeRef()).offset(-this._currentView.mergedCellLeft,-this._currentView.mergedCellTop)},_buttonOutOfVisiblePane:function(e,t,i){var r=this;var s=r._grid;var n=r._sheet;var a=n.range(e,t)._ref;var o=s.scrollBoundaries(a);var l=s.columns.frozen?0:i.scrollLeft;if(o.right+d>l||t+1===n.frozenColumns())return true}});function z(t){["N","NE","E","SE","S","SW","W","NW"].forEach(function(e){t.push(_.dom.element("div",{className:"k-spreadsheet-drawing-handle "+e,"data-direction":e}))})}_.spreadsheet.View=p,_.spreadsheet.Pane=x,_.spreadsheet.drawCell=k,c.extend(true,p,{classNames:f}),c.extend(true,x,{classNames:b})})?r.apply(t,i):r)||(e.exports=t)},54752:function(e){"use strict";e.exports=require("../kendo.core")},70867:function(e){"use strict";e.exports=require("../kendo.menu")},67539:function(e){"use strict";e.exports=require("../util/main")},16784:function(e){"use strict";e.exports=require("./sheetsbar")}},r={};function s(e){var t=r[e];return void 0!==t||(t=r[e]={exports:{}},i[e](t,t.exports,s)),t.exports}s.amdD=function(){throw Error("define cannot be used indirect")},e=s(39268),module.exports=e}();
!function(){var e,t={95523:function(e,r,t){var n;t=[t(54752)],void 0===(r="function"==typeof(n=function(){var e=kendo.spreadsheet,b=e.CellRef,y=e.RangeRef,C=e.UnionRef,E=e.NameRef,F=e.Ref,r=kendo.Class.extend({init:function(e){this.workbook=e},getRefCells:function(e,r,f,c,h,d){var t,n,o,a;if(e instanceof b){t=this.workbook.sheetByName(e.sheet);if(!t||!e.valid())return[{value:new kendo.spreadsheet.calc.runtime.CalcError("REF")}];n=t.formula(e);o=t.range(e.row,e.col).value();if(d||n!=null||o!=null)return[{formula:n,value:o,row:e.row,col:e.col,sheet:e.sheet,hidden:r?t.columnWidth(e.col)===0||t.rowHeight(e.row)===0:false}];else return[]}if(e instanceof y){a=this.workbook.sheetIndex(e.sheet);var v=[],i=a;if(e.endSheet){i=this.workbook.sheetIndex(e.endSheet);if(a>i){var m=a;a=i;i=m}}if(a<0||i<0||!e.valid())return[{value:new kendo.spreadsheet.calc.runtime.CalcError("REF")}];while(a<=i){t=this.workbook.sheetByIndex(a++);var k=t._grid.normalize(e.topLeft);var p=t._grid.normalize(e.bottomRight);var g=t._grid.cellRefIndex(k);var w=t._grid.cellRefIndex(p);var x=t._properties.iterator("value",g,w);for(var l=k.col;l<=p.col;++l)for(var s=k.row;s<=p.row;++s){var R=t._grid.index(s,l);n=t._properties.get("formula",R);o=x.at(R);if(d||n!=null||o!=null)v.push({formula:n,value:o,row:s,col:l,sheet:t.name(),hidden:r?t.columnWidth(l)===0||t.rowHeight(s)===0:false})}}return v}if(e instanceof C){var _=[];for(a=0;a<e.refs.length;++a)_=_.concat(this.getRefCells(e.refs[a],r,f,c,h));return _}if(e instanceof E){var u=this.nameValue(e,f,c,h);if(u instanceof F)return this.getRefCells(u,r,f,c,h);return[{value:u==null?new kendo.spreadsheet.calc.runtime.CalcError("NAME"):u}]}return[]},isMerged:function(e){var r=this.workbook.sheetByName(e.sheet);return r.isMerged(e)},nameValue:function(e,r,t,n){var o;if(e.hasSheet())o=this.workbook.nameValue(this._displayString(e.print()));else{e=e.clone().setSheet(r,true);o=this.workbook.nameValue(this._displayString(e.print()));if(o==null)o=this.workbook.nameValue(this._displayString(e.name))}if(o instanceof F)o=o.absolute(t,n);return o},getData:function(e,r,t,n,o){var a=e instanceof b;if(e instanceof E)a=this.workbook.nameValue(e.name)instanceof b;var i=this.getRefCells(e,false,r,t,n,o).map(function(e){var r=e.value;if(r instanceof kendo.spreadsheet.calc.runtime.Formula)r=r.value;return r});return a?i[0]:i},onFormula:function(e){var a=this.workbook.sheetByName(e.sheet);var r=e.row,t=e.col,i=e.value;var n=a.formula({row:r,col:t});if(n!==e)return false;var o=e.arrayFormulaRange;if(o){var l,s;var u=i.width;var f=i.height;a.forEach(o,function(e,r){if(l===undefined){l=e;s=r}var t=e-l;var n=r-s;var o;if(t<f&&n<u)o=i.get(t,n);else o=new kendo.spreadsheet.calc.runtime.CalcError("N/A");a._value(e,r,o)})}else{if(i instanceof F){i=this.getData(i,e.sheet,r,t);if(Array.isArray(i))i=i[0];if(i===undefined)i=null}if(i instanceof kendo.spreadsheet.calc.runtime.Matrix)i=i.get(0,0);a._value(r,t,i)}clearTimeout(a._formulaContextRefresh);a._formulaContextRefresh=setTimeout(function(){a.batch(function(){},{layout:true})},50);return true},_displayString:function(e){if(/^[a-z_][a-z0-9_]*$/i.test(e))return e;return"'"+e.replace(/\x27/g,"\\'")+"'"}}),t=r.extend({onFormula:function(){return true}});e.FormulaContext=r,e.ValidationFormulaContext=t})?n.apply(r,t):n)||(e.exports=r)},54752:function(e){"use strict";e.exports=require("../kendo.core")}},n={};function o(e){var r=n[e];return void 0!==r||(r=n[e]={exports:{}},t[e](r,r.exports,o)),r.exports}o.amdD=function(){throw Error("define cannot be used indirect")},e=o(95523),module.exports=e}();
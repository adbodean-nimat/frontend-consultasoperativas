!function(){var e,r={3509:function(e,t,r){var i;r=[r(54752),r(70686)],void 0===(t="function"==typeof(i=function(){var x=kendo,g=x.spreadsheet.RangeRef,R=x.spreadsheet.CellRef,t=x.Class.extend({init:function(i,o,e,s){this.rangeGetter=e;this.prevLeft=function(e){var t=s(this.range(e));var r=this.range(o.prevVisible(t.topLeft[i]));return s(r).topLeft[i]};this.nextRight=function(e){var t=s(this.range(e));var r=this.range(o.nextVisible(t.bottomRight[i]));return s(r).bottomRight[i]};this.nextLeft=function(e){var t=s(this.range(e));return o.nextVisible(t.bottomRight[i])};this.prevRight=function(e){var t=s(this.range(e));return o.prevVisible(t.topLeft[i])}},boundary:function(e,t){this.top=e;this.bottom=t},range:function(e){return this.rangeGetter(e,this.top,this.bottom)}}),e=x.Class.extend({init:function(e){this._sheet=e;this.autoFillCalculator=new x.spreadsheet.AutoFillCalculator(e._grid);this.colEdge=new t("col",this._sheet._grid._columns,this.columnRange.bind(this),this.union.bind(this));this.rowEdge=new t("row",this._sheet._grid._rows,this.rowRange.bind(this),this.union.bind(this))},height:function(e){this._viewPortHeight=e},union:function(e){return this._sheet.unionWithMerged(e)},columnRange:function(e,t,r){return this._sheet._ref(t,e,r-t,1)},rowRange:function(e,t,r){return this._sheet._ref(e,t,1,r-t)},selectionIncludesMergedCells:function(){return this._sheet.select().contains(this._sheet._mergedCells)},setSelectionValue:function(e){var t=this._sheet.selection();setTimeout(function(){t.value(e())})},selectAll:function(){this._sheet.select(this._sheet._sheetRef)},select:function(e,t,r){e=this.refForMode(e,t);if(r)e=this._sheet.select().concat(e);this._sheet.select(e)},refForMode:function(e,t){var r=this._sheet._grid;switch(t){case"range":e=r.normalize(e);break;case"row":e=r.rowRef(e.row);break;case"column":e=r.colRef(e.col);break;case"sheet":e=this._sheet._sheetRef;break}return e},startSelection:function(e,t,r,i,o){if(t=="autofill")this._sheet.startAutoFill();else if(i&&t=="range"){var s=new g(this._sheet.activeCell().first(),e);this._sheet.select(s,false,false);this._sheet.startSelection(o)}else{this._sheet.startSelection(o);this.select(e,t,r)}},completeSelection:function(){this._sheet.completeSelection()},selectForContextMenu:function(e,t){var r=this._sheet;r._activeDrawing=null;if(!r.select().contains(this.refForMode(e,t)))this.select(e,t)},selectDrawingForContextMenu:function(e){var t=this._sheet;t._activeDrawing=e;t.triggerChange({selection:true})},modifySelection:function(h){var f=this.determineDirection(h);var e=this._sheet;var t=this._viewPortHeight;var r=e._grid._rows;var i=e._grid._columns;var u=e.currentOriginalSelectionRange();var o=e.select().toRangeRef();var s=e.activeCell();var a=u.topLeft.clone();var n=u.bottomRight.clone();var l=new R(n.row,a.col);var c;this.colEdge.boundary(o.topLeft.row,o.bottomRight.row);this.rowEdge.boundary(o.topLeft.col,o.bottomRight.col);switch(f){case"expand-left":a.col=this.colEdge.prevLeft(a.col);c=a;break;case"shrink-right":a.col=this.colEdge.nextLeft(a.col);c=a;break;case"expand-right":n.col=this.colEdge.nextRight(n.col);c=n;break;case"shrink-left":n.col=this.colEdge.prevRight(n.col);c=n;break;case"expand-up":a.row=this.rowEdge.prevLeft(a.row);c=a;break;case"shrink-down":a.row=this.rowEdge.nextLeft(a.row);c=a;break;case"expand-down":n.row=this.rowEdge.nextRight(n.row);c=n;break;case"shrink-up":n.row=this.rowEdge.prevRight(n.row);c=n;break;case"expand-page-up":a.row=r.prevPage(a.row,t);break;case"shrink-page-up":n.row=r.prevPage(n.row,t);break;case"expand-page-down":n.row=r.nextPage(n.row,t);break;case"shrink-page-down":a.row=r.nextPage(a.row,t);break;case"first-col":a.col=i.firstVisible();n.col=s.bottomRight.col;c=a;break;case"last-col":n.col=i.lastVisible();a.col=s.topLeft.col;c=n;break;case"first-row":a.row=r.firstVisible();n.row=s.bottomRight.row;c=a;break;case"last-row":n.row=r.lastVisible();a.row=s.topLeft.row;c=n;break;case"last":n.row=r.lastVisible();n.col=i.lastVisible();a=s.topLeft;c=n;break;case"first":a.row=r.firstVisible();a.col=i.firstVisible();n=s.bottomRight;c=a;break;case"expand-word-right":n.col=i.nextUntil(n.col,v(e,n,true));c=n;break;case"shrink-word-right":a.col=i.nextUntil(l.col,v(e,l,true));c=a;break;case"expand-word-left":a.col=i.prevUntil(l.col,v(e,l,true));c=a;break;case"shrink-word-left":n.col=i.prevUntil(n.col,v(e,n,true));c=n;break;case"expand-word-up":a.row=r.prevUntil(a.row,v(e,a,false));c=a;break;case"shrink-word-up":n.row=r.prevUntil(n.row,v(e,n,false));c=n;break;case"expand-word-down":n.row=r.nextUntil(n.row,v(e,n,false));c=n;break;case"shrink-word-down":a.row=r.nextUntil(a.row,v(e,a,false));c=a;break}var w=new g(a,n);if(!this.union(w).intersects(s)){this.modifySelection(f.replace("shrink","expand"));return}if(c)e.focus(c);this.updateCurrentSelectionRange(w)},moveActiveCell:function(e){var t=this._sheet;var r=t.activeCell();var i=r.topLeft;var o=r.bottomRight;var s=t.originalActiveCell();var a=t._grid._rows;var n=t._grid._columns;var l=s.row;var c=s.col;switch(e){case"left":c=n.prevVisible(i.col);break;case"up":l=a.prevVisible(i.row);break;case"right":c=n.nextVisible(o.col);break;case"down":l=a.nextVisible(o.row);break;case"first-col":c=n.firstVisible();break;case"last-col":c=n.lastVisible();break;case"first-row":l=a.firstVisible();break;case"last-row":l=a.lastVisible();break;case"last":l=a.lastVisible();c=n.lastVisible();break;case"first":l=a.firstVisible();c=n.firstVisible();break;case"next-page":l=a.nextPage(o.row,this._viewPortHeight);break;case"prev-page":l=a.prevPage(o.row,this._viewPortHeight);break;case"word-right":c=n.nextUntil(c,v(t,o,true));break;case"word-left":c=n.prevUntil(c,v(t,o,true));break;case"word-up":l=a.prevUntil(l,v(t,o,false));break;case"word-down":l=a.nextUntil(l,v(t,o,false));break}t.select(new R(l,c))},navigateInSelection:function(h){var e=this._sheet;var f=e.activeCell();var u=f.topLeft;var w=e.originalActiveCell();var t=e._grid._rows;var r=e._grid._columns;var i=w.row;var o=w.col;var g=false;var v=false;var s,a;var n=u.col;var d=u.row;var l;function b(e){s=e.topLeft;a=e.bottomRight}b(e.currentNavigationRange());var p=false;var k=false;while(!p&&!k){var c=new R(i,o);var _=e.singleCellSelection();if(_){g=s.eq(c)&&e._sheetRef.topLeft.eq(c);v=a.eq(c)&&e._sheetRef.bottomRight.eq(c);if(!g)g=r.firstVisible()===o&&t.firstVisible()===i;if(!v)v=r.lastVisible()===o&&t.lastVisible()===i}switch(h){case"next":if(v){k=true;x.focusNextElement()}else if(a.eq(c)){b(e.nextNavigationRange());i=s.row;o=s.col}else{o=r.nextVisible(n);if(o==n||o>a.col){o=s.col;l=t.nextVisible(i);if(l==i||l>a.row)i=s.row;else i=l}}break;case"previous":if(g){k=true;this._sheet._workbook._view.element.find(".k-spreadsheet-name-editor .k-input-inner").trigger("focus")}else if(s.eq(c)){b(e.previousNavigationRange());i=a.row;o=a.col}else{o=r.prevVisible(n);if(o==n||o<s.col){o=a.col;l=t.prevVisible(i);if(l==i||l<s.row)i=a.row;else i=l}}break;case"lower":if(a.eq(c)){b(e.nextNavigationRange());i=s.row;o=s.col}else{i=t.nextVisible(d);if(i==d||i>a.row){i=s.row;l=r.nextVisible(o);if(l==o||l>a.col)o=s.col;else o=l}}break;case"upper":if(s.eq(c)){b(e.previousNavigationRange());i=a.row;o=a.col}else{i=t.prevVisible(d);if(i==d||i<s.row){i=a.row;l=r.prevVisible(o);if(l==o||l<s.col)o=a.col;else o=l}}break;default:throw new Error("Unknown entry navigation: "+h)}p=!this.shouldSkip(i,o);n=o;d=i}if(p)if(e.singleCellSelection())e.select(new R(i,o));else e.activeCell(new R(i,o))},extendSelection:function(e,t){var r=this._sheet;var i=r._grid;if(t==="autofill"){this.resizeAutoFill(e);return}if(t==="range")e=i.normalize(e);else if(t==="row")e=i.rowRef(e.row).bottomRight;else if(t==="column")e=i.colRef(e.col).bottomRight;var o=r.originalActiveCell().toRangeRef();this.updateCurrentSelectionRange(new g(o.topLeft,e))},shouldSkip:function(e,t){if(this._sheet.isHiddenRow(e)||this._sheet.isHiddenColumn(t))return true;var r=new R(e,t);var i=false;this._sheet.forEachMergedCell(function(e){if(e.intersects(r)&&!e.collapse().eq(r))i=true});return i},resizeAutoFill:function(e){var t=this._sheet;var r=t.select();var i=t._autoFillOrigin;var o=this.autoFillCalculator.autoFillDest(r,e);var s=this.punch(r,o);var a,n;if(!s){var l=t.range(o)._previewFillFrom(t.range(i));if(l){n=l.direction;a=l.hint}}t.updateAutoFill(o,s,a,n)},determineDirection:function(e){var t=this._sheet.currentSelectionRange();var r=this._sheet.activeCell();var i=r.topLeft.col==t.topLeft.col;var o=r.bottomRight.col==t.bottomRight.col;var s=r.topLeft.row==t.topLeft.row;var a=r.bottomRight.row==t.bottomRight.row;switch(e){case"left":e=o?"expand-left":"shrink-left";break;case"right":e=i?"expand-right":"shrink-right";break;case"up":e=a?"expand-up":"shrink-up";break;case"down":e=s?"expand-down":"shrink-down";break;case"prev-page":e=a?"expand-page-up":"shrink-page-up";break;case"next-page":e=s?"expand-page-down":"shrink-page-down";break;case"word-left":e=o?"expand-word-left":"shrink-word-left";break;case"word-right":e=i?"expand-word-right":"shrink-word-right";break;case"word-up":e=a?"expand-word-up":"shrink-word-up";break;case"word-down":e=s?"expand-word-down":"shrink-word-down";break}return e},updateCurrentSelectionRange:function(e){var t=this._sheet;t.select(t.originalSelect().replaceAt(t.selectionRangeIndex(),e),false)},punch:function(e,t){var r;if(t.topLeft.eq(e.topLeft))if(t.bottomRight.row<e.bottomRight.row){var i=this.rowEdge.nextRight(t.bottomRight.row);r=new g(new R(i,e.topLeft.col),e.bottomRight)}else if(t.bottomRight.col<e.bottomRight.col){var o=this.colEdge.nextRight(t.bottomRight.col);r=new g(new R(e.topLeft.row,o),e.bottomRight)}return r}});function v(o,s,a){var n=o.range(s).value();return function(e,t,r){if(r)return true;var i=(a?o.range(s.row,e):o.range(e,s.col)).value();if(n===null)return i===null?false:e;else if(!t&&i===null){n=null;return false}else return i===null}}x.spreadsheet.SheetNavigator=e})?i.apply(t,r):i)||(e.exports=t)},54752:function(e){"use strict";e.exports=require("../kendo.core")},70686:function(e){"use strict";e.exports=require("./autofillcalculator")}},i={};function o(e){var t=i[e];return void 0!==t||(t=i[e]={exports:{}},r[e](t,t.exports,o)),t.exports}o.amdD=function(){throw Error("define cannot be used indirect")},e=o(3509),module.exports=e}();
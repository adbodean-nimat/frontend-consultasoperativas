!function(){var e,i={26929:function(e,t,i){var r;i=[i(54752),i(97757),i(22360),i(26232),i(81200)],void 0===(t="function"==typeof(r=function(){var d=kendo,f=d.spreadsheet.RangeRef,i=d.spreadsheet.UnionRef,c=d.spreadsheet.CellRef,g=d.spreadsheet.Range,l,a=d.Class.extend({init:function(e){this._sheet=e;this.selection=d.spreadsheet.FIRSTREF.toRangeRef();this.originalSelection=d.spreadsheet.FIRSTREF.toRangeRef();this._activeCell=d.spreadsheet.FIRSTREF.toRangeRef();this.originalActiveCell=d.spreadsheet.FIRSTREF},currentSelectionRange:function(){return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef()},currentOriginalNavigationRange:function(){return this.originalSelection.rangeAt(this.selectionRangeIndex).toRangeRef()},currentNavigationRange:function(){if(this.singleCellSelection())return this._sheet._sheetRef;else return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef()},nextNavigationRange:function(){if(!this.singleCellSelection())this.selectionRangeIndex=this.selection.nextRangeIndex(this.selectionRangeIndex);return this.currentNavigationRange()},previousNavigationRange:function(){if(!this.singleCellSelection())this.selectionRangeIndex=this.selection.previousRangeIndex(this.selectionRangeIndex);return this.currentNavigationRange()},activeCell:function(e){if(e){this.originalActiveCell=e.first();this._activeCell=this._sheet.unionWithMerged(e.toRangeRef());this._sheet.focus(e);this._sheet.triggerChange({activeCell:true,selection:true})}return this._activeCell},select:function(t,e,h,i){if(t){if(t.eq(this.originalSelection))return;this._sheet.triggerSelect(new g(t,this._sheet));this.originalSelection=t;this.selection=e;if(h!==false){if(t.isCell()){this._sheet.forEachMergedCell(t,function(e){t=e.topLeft});this.activeCell(t)}else{t=this.selection.lastRange();if(i&&i._sheet===this._sheet&&i.panes[0]){var r=i.panes;var n,s,o,l,a,u;for(n=0;n<r.length;n++){s=r[n];if(!s._currentView)continue;o=s._currentView.rows.values;l=s._currentView.columns.values;a=new f(new c(o.start,l.start),new c(o.end,l.end));u=t.intersect(a);if(u!==d.spreadsheet.NULLREF)break}if(u&&u!==d.spreadsheet.NULLREF)t=u}this.activeCell(t.first())}this.selectionRangeIndex=this.selection.size()-1}else this._sheet.triggerChange({selection:true})}return this.selection},singleCellSelection:function(){return this._activeCell.eq(this.selection)}}),e=d.Observable.extend({init:function(){d.Observable.prototype.init.call(this);this._reinit.apply(this,arguments)},events:["changing","commandRequest","afterInsertRow","afterDeleteRow","insertRow","insertColumn","deleteRow","deleteColumn","hideRow","hideColumn","unhideRow","unhideColumn","select","dataBinding","dataBound","progress"],_reinit:function(e,t,i,r,n,s,o){o=o||{};this._defaultCellStyle={background:o.background,color:o.color,fontFamily:o.fontFamily,fontSize:o.fontSize,italic:o.italic,bold:o.bold,underline:o.underline,wrap:o.wrap,verticalAlign:o.verticalAlign,textAlign:o.textAlign};this._rows=new d.spreadsheet.Axis(e,i);this._columns=new d.spreadsheet.Axis(t,r);this._filteredRows=new d.spreadsheet.RangeList(0,e-1,false);this._mergedCells=[];this._frozenRows=0;this._frozenColumns=0;this._suspendChanges=false;this._filter=null;this._showGridLines=true;this._gridLinesColor=null;this._grid=new d.spreadsheet.Grid(this._rows,this._columns,e,t,n,s);this._sheetRef=this._grid.normalize(d.spreadsheet.SHEETREF);this._properties=new d.spreadsheet.PropertyBag(e,t,this._defaultCellStyle);this._sorter=new d.spreadsheet.Sorter(this._grid,this._properties.sortable());this._viewSelection=new a(this);this._editSelection=new a(this);this._formulaSelections=[];this._drawings=[]},resize:function(e,t){e=Math.max(e,1);t=Math.max(t,1);var i=this._rows._count;var r=this._columns._count;if(e<i)this.range(e,0,i-e,r).clear();if(t<r)this.range(0,t,i,r-t).clear();this._rows._resize(e);this._columns._resize(t);this._grid._resize(e,t);this._properties._resize(e,t);this._sheetRef=this._grid.normalize(d.spreadsheet.SHEETREF);if(e>i){this.range(i,0,e-i,t).clear();this._filteredRows.value(i,e-1,false)}if(t>r)this.range(0,r,e,t-r).clear();this.triggerChange({layout:true})},_resizeAddRow:function(e){this.resize(this._rows._count+(e||1),this._columns._count)},_resizeAddColumn:function(e){this.resize(this._rows._count,this._columns._count+(e||1))},_resizeDeleteRow:function(e){this._resizeAddRow(-(e||1))},_resizeDeleteColumn:function(e){this._resizeAddColumn(-(e||1))},_resizeForJSON:function(e){var t=e.length,i=0;for(var r=0;r<e.length;++r){var n=e[r];if(n.index!=null)t=Math.max(t,n.index+1);if(n.cells){i=Math.max(i,n.cells.length);for(var s=0;s<n.cells.length;++s){var o=n.cells[s];if(o.index!=null)i=Math.max(i,o.index+1)}}}this.resize(Math.max(t,this._rows._count),Math.max(i,this._columns._count))},_selectionState:function(){return this._inEdit?this._editSelection:this._viewSelection},navigator:function(){if(!this._navigator)this._navigator=new d.spreadsheet.SheetNavigator(this);return this._navigator},axisManager:function(){if(!this._axisManager)this._axisManager=new d.spreadsheet.AxisManager(this);return this._axisManager},_name:function(e){if(!e)return this._sheetName;this._sheetName=e;return this},name:function(){return this._name()},_property:function(e,t,i){if(t===undefined)return e();else{e(t);return this.triggerChange(i)}},_field:function(e,t,i){if(t===undefined)return this[e];else{this[e]=t;return this.triggerChange(i)}},suspendChanges:function(e){if(e===undefined)return this._suspendChanges;this._suspendChanges=e;return this},triggerChange:function(e){if(!this._suspendChanges)this.trigger("change",e);else if(e&&e.isValue)this._valueChanged=true;return this},triggerSelect:function(e){this.trigger("select",{range:e})},setDataSource:function(e,t){if(this.dataSourceBinder)this.dataSourceBinder.destroy();this.dataSourceBinder=new d.spreadsheet.SheetDataSourceBinder({dataSource:e,sheet:this,columns:t});this.dataSource=this.dataSourceBinder.dataSource},hideColumn:function(e){if(this.trigger("hideColumn",{index:e}))return;return this._property(this._columns.hide.bind(this._columns),e,{layout:true})},unhideColumn:function(e){if(this.trigger("unhideColumn",{index:e}))return;return this._property(this._columns.unhide.bind(this._columns),e,{layout:true})},isHiddenColumn:function(e){return this._grid._columns.hidden(e)},_copyRange:function(e,t){var i=this._grid;var r=i.rowCount;var n=i.normalize(e.topLeft);var s=i.normalize(e.bottomRight);var o=n.col*r+n.row;var l=s.col*r+s.row;var a=t.col*r+t.row;this._properties.copy(o,l,a)},_saveModifiedFormulas:function(e,t){var i=l;l=e;var r=t();l=i;return r},_restoreModifiedFormulas:function(e){var r=this._workbook;e.forEach(function(e){var t=r.sheetByName(e.sheet),i;if(e instanceof d.spreadsheet.calc.runtime.Formula){i=t._grid.cellRefIndex(e);t._properties.set("formula",i,i,e)}if(e instanceof d.spreadsheet.validation.Validation){i=t._grid.cellRefIndex(e);t._properties.set("validation",i,i,e)}})},_adjustReferences:function(i,r,n,e){this._mergedCells=e.reduce(function(e,t){t=t.adjust(null,null,null,null,i=="row",r,n);if(t instanceof f)e.push(t);return e},[]);if(this._workbook){var s=this._name();this._workbook._sheets.forEach(function(e){e._forFormulas(function(e){var t=e.adjust(s,i,r,n);if(t&&l)l.push(t)});e._forValidations(function(e){var t=e.adjust(s,i,r,n);if(t&&l)l.push(t)})});this._workbook.adjustNames(s,i=="row",r,n)}var t=this.select();t=t.adjust(null,null,null,null,i=="row",r,n);if(t!==d.spreadsheet.NULLREF)this.select(t);var o=i=="col"?this._columns:this._rows;o.adjust(r,n);if(i=="row")if(n<0)this._filteredRows.copy(r-n,this._rows._count-1,r);else{this._filteredRows.copy(r,this._rows._count,r+n);this._filteredRows.value(r,r+n-1,false)}this._drawings.forEach(function(e){if(e.topLeftCell)e.topLeftCell=e.topLeftCell.adjust(null,null,null,null,i=="row",r,n)})},_forFormulas:function(i){var e=this._properties;var t=e.get("formula").values();var r=t.length;t.forEach(function(e,t){i.call(this,e.value,t,r)},this)},_forValidations:function(t){var e=this._properties;e.get("validation").values().forEach(function(e){t.call(this,e.value)},this)},insertRow:function(h,e){if(this.trigger("insertRow",{index:h}))return;this.batch(function(){this._resizeAddRow();var e=this._grid;var t=e.columnCount;var i=e.rowCount;if(h+1==i)return;var r=this.frozenRows();if(h<r)this.frozenRows(r+1);var n=this._mergedCells.slice();for(var s=0;s<t;s++){var o=new f(new c(h,s),new c(h,s));var l=e.normalize(o.topLeft);var a=e.normalize(o.bottomRight);var u=new f(new c(l.row,l.col),new c(i-2,a.col));this._copyRange(u,new c(l.row+1,l.col));new g(o,this).clear({clearAll:true,keepBorders:true})}this._adjustReferences("row",h,1,n)},{recalc:true,layout:true,insertRow:{index:h},ref:new f(new c(h,0),new c(Infinity,Infinity))});if(!e)this.trigger("afterInsertRow",{index:h});return this},isEnabledRow:function(e){var t=new f(new c(e,0),new c(e,this._grid.columnCount));return new g(t,this).enable()},deleteRow:function(h,e){if(!this.isEnabledRow(h))return this;if(this.trigger("deleteRow",{index:h}))return;this.batch(function(){var e=this._grid;var t=e.columnCount;var i=this.frozenRows();if(h<i)this.frozenRows(i-1);var r=this._mergedCells.slice();for(var n=0;n<t;n++){var s=new f(new c(h,n),new c(h,n));new g(s,this).clear({clearAll:true,keepBorders:true});var o=e.normalize(s.topLeft);var l=e.normalize(s.bottomRight);var a=new f(new c(o.row+1,o.col),new c(Infinity,l.col));this._copyRange(a,o);var u=e.normalize(a.bottomRight);new g(new f(u,u),this).clear()}this._adjustReferences("row",h,-1,r);this._resizeDeleteRow()},{recalc:true,layout:true,deleteRow:{index:h},ref:new f(new c(h,0),new c(Infinity,Infinity))});if(!e)this.trigger("afterDeleteRow",{index:h});return this},insertColumn:function(u){if(this.trigger("insertColumn",{index:u}))return;this.batch(function(){this._resizeAddColumn();var e=this._grid;var t=e.columnCount;if(u+1==t)return;var i=this.frozenColumns();if(u<i)this.frozenColumns(i+1);var r=this._mergedCells.slice();for(var n=t;n>=u;n--){var s=new f(new c(0,n),new c(Infinity,n));new g(s,this).clear({clearAll:true,keepBorders:true});if(n==u)break;var o=e.normalize(s.topLeft);var l=e.normalize(s.bottomRight);var a=new f(new c(o.row,o.col-1),new c(l.row,l.col-1));this._copyRange(a,o)}this._adjustReferences("col",u,1,r)},{recalc:true,layout:true,insertColumn:{index:u},ref:new f(new c(0,u),new c(Infinity,Infinity))});return this},isEnabledColumn:function(e){var t=new f(new c(0,e),new c(Infinity,e));return new g(t,this).enable()},deleteColumn:function(u){if(!this.isEnabledColumn(u))return this;if(this.trigger("deleteColumn",{index:u}))return;this.batch(function(){var e=this._grid;var t=e.columnCount;var i=this.frozenColumns();if(u<i)this.frozenColumns(i-1);var r=this._mergedCells.slice();for(var n=u;n<t;n++){var s=new f(new c(0,n),new c(Infinity,n));new g(s,this).clear({clearAll:true,keepBorders:true});if(n==t-1)break;var o=e.normalize(s.topLeft);var l=e.normalize(s.bottomRight);var a=new f(new c(o.row,o.col+1),new c(l.row,l.col+1));this._copyRange(a,o)}this._adjustReferences("col",u,-1,r);this._resizeDeleteColumn()},{recalc:true,layout:true,deleteColumn:{index:u},ref:new f(new c(0,u),new c(Infinity,Infinity))});return this},_filterRow:function(e){this._rows.hide(e);this._filteredRows.value(e,e,true);this.triggerChange({layout:true})},hideRow:function(e){if(this.trigger("hideRow",{index:e}))return;return this._property(this._rows.hide.bind(this._rows),e,{layout:true})},unhideRow:function(e){if(this.trigger("unhideRow",{index:e}))return;return this._property(this._rows.unhide.bind(this._rows),e,{layout:true})},isHiddenRow:function(e){return this._grid._rows.hidden(e)},isFilteredRow:function(e){return this._filteredRows.value(e)},columnWidth:function(e,t){return this._property(this._columns.value.bind(this._columns,e,e),t,{layout:true})},rowHeight:function(e,t){return this._property(this._rows.value.bind(this._rows,e,e),t,{layout:true})},frozenRows:function(e){return this._field("_frozenRows",e,{layout:true})},frozenColumns:function(e){return this._field("_frozenColumns",e,{layout:true})},showGridLines:function(e){return this._field("_showGridLines",e,{layout:true})},gridLinesColor:function(e){return this._field("_gridLinesColor",e,{layout:true})},_ref:function(e,t,i,r){var n=null;if(e instanceof d.spreadsheet.Ref)return e;if(e instanceof d.spreadsheet.Range)return e._ref.toRangeRef();if(typeof e==="string")n=d.spreadsheet.calc.parseReference(e);else{if(!i)i=1;if(!r)r=1;n=new f(new c(e,t),new c(e+i-1,t+r-1))}return n},range:function(e,t,i,r){return new g(this._ref(e,t,i,r),this)},_getMergedCells:function(r){var e=this._grid;var n={};var s={};var o=false;this.forEachMergedCell(r,function(t){var i=t.topLeft;e.forEach(t,function(e){if(i.eq(e)){n[e.print()]=t;o=true}else if(r.contains(e)){s[e.print()]=i;o=true}})});return{primary:n,secondary:s,hasMerged:o}},forEachMergedCell:function(t,i){var r=false;if(typeof i==="undefined"){i=t;r=true}this._mergedCells.forEach(function(e){if(r||e.intersects(t))i(e)})},forEachFilterHeader:function(t,e){var i=false;if(typeof e==="undefined"){e=t;i=true}if(this._filter){var r=[];this._filter.ref.forEachColumn(function(e){if(i||e.intersects(t))r.push(e.topLeft)});this._mergedCells.forEach(function(t){r=r.map(function(e){if(t.intersects(e))return t;return e})});r.reduce(function e(t,i){if(t.indexOf(i)<0)t.push(i);return t},[]).forEach(e)}},forEach:function(e,a){var u=this;function t(e){if(!(e instanceof f))e=e.toRangeRef();var t=u._grid.normalize(e.topLeft);var i=u._grid.normalize(e.bottomRight);var r,n;function s(e){a(n++,r,e)}for(r=t.col;r<=i.col;r++){n=t.row;var o=u._grid.index(n,r);var l=u._grid.index(i.row,r);u._properties.forEach(o,l,s)}}if(!(e instanceof f))e=u._ref(e);if(e instanceof i)e.forEach(t);else t(e)},startResizing:function(e){this._initialPosition=e;this._resizeInProgress=true},startAutoFill:function(){this._autoFillInProgress=true;var e=this.select();this._autoFillOrigin=e;this._autoFillDest=e;this.triggerChange({selection:true})},updateAutoFill:function(e,t,i,r){this._autoFillDest=e;this._autoFillPunch=t;this._autoFillHint=i;this._autoFillDirection=r;this.triggerChange({selection:true})},autoFillRef:function(){return this._autoFillDest},autoFillPunch:function(){return this._autoFillPunch},autoFillInProgress:function(){return this._autoFillInProgress},resizingInProgress:function(){return this._resizeInProgress},draggingInProgress:function(){return this._draggingInProgress},completeResizing:function(){if(this._resizeInProgress){this._resizeInProgress=false;var e=this.resizeHintPosition();if(this._initialPosition&&e){var t=this.resizeHandlePosition();if(t.col!==-Infinity)this.trigger("commandRequest",{command:"ColumnWidthCommand",options:{target:t.col,value:this.columnWidth(t.col)-(this._initialPosition.x-e.x)}});else this.trigger("commandRequest",{command:"RowHeightCommand",options:{target:t.row,value:this.rowHeight(t.row)-(this._initialPosition.y-e.y)}})}else this.trigger("change",{resize:true})}},_visualRange:function(e){var t=this._mergedCells;for(var i=t.length;--i>=0;)if(t[i].intersects(e))return this.range(t[i]);return this.range(e)},_renderComment:function(e){var t=null;if(e){var i=this._visualRange(e);t=i.comment();e=i._ref.toRangeRef().topLeft}if(t){if(!this._commentRef||!e.eq(this._commentRef)){this._commentRef=e;this.trigger("change",{comment:true})}}else if(this._commentRef){this._commentRef=null;this.trigger("change",{comment:true})}},resizeHandlePosition:function(){return this._resizeHandlePosition},resizeHintPosition:function(e){if(e!==undefined){this._resizeHintPosition=e;this.trigger("change",{resize:true})}return this._resizeHintPosition},removeResizeHandle:function(){if(this._resizeHandlePosition){this._resizeHintPosition=undefined;this._resizeHandlePosition=undefined;this._initialPosition=undefined;this.trigger("change",{resize:true})}},positionResizeHandle:function(e){this._resizeHandlePosition=e;this.trigger("change",{resize:true})},startDragging:function(e){this._draggingInProgress=e},completeDragging:function(){var e=this._draggingInProgress;if(e){this._draggingInProgress=null;var t=e.drawing;if(t.eq(e.copy))return;if(t.topLeftCell){var i=this.drawingBoundingBox(t);var r=this._rows.indexVisible(i.top);var n=this._columns.indexVisible(i.left);var s=new c(r,n);var o=this.refBoundingBox(s);t.offsetX=i.left-o.left;t.offsetY=i.top-o.top;t.topLeftCell=s;this.triggerChange({dragging:true})}this.trigger("commandRequest",{command:"DrawingUpdateCommand",options:{sheet:this,drawing:t,previous:e.copy}})}},startSelection:function(e){if(this.frozenRows()||this.frozenColumns())this._currentView=null;else if(e&&e._sheet===this)this._currentView=e;this._selectionInProgress=true},completeSelection:function(){if(this._selectionInProgress){this._selectionInProgress=false;this._resizeHintPosition=undefined;this.trigger("change",{selection:true})}if(this._autoFillInProgress){this._autoFillInProgress=false;var e=this._autoFillDest;var t=this._autoFillOrigin;if(this._autoFillPunch)this.trigger("commandRequest",{command:"ClearContentCommand",options:{operatingRange:this.range(this._autoFillPunch)}});else if(!e.eq(t))this.trigger("commandRequest",{command:"AutoFillCommand",options:{operatingRange:this.range(e),origin:this.range(t)}});else this.triggerChange({selection:true});this._autoFillDest=null;this._autoFillPunch=null;this._autoFillOrigin=null;this.select(e)}},selectionInProgress:function(){return this._selectionInProgress},select:function(e,t){var i=this._selectionState();var r;if(e){e=this._ref(e);e=this._grid.normalize(e);r=this._grid.isAxis(e)?e:this.unionWithMerged(e)}return i.select(e,r,t,this._currentView)},originalSelect:function(){return this._selectionState().originalSelection},currentSelectionRange:function(){return this._selectionState().currentSelectionRange()},currentOriginalSelectionRange:function(){return this._selectionState().currentOriginalNavigationRange()},currentNavigationRange:function(){return this._selectionState().currentNavigationRange()},nextNavigationRange:function(){return this._selectionState().nextNavigationRange()},previousNavigationRange:function(){return this._selectionState().previousNavigationRange()},selectionRangeIndex:function(){return this._selectionState().selectionRangeIndex},activeCell:function(e){return this._selectionState().activeCell(e)},originalActiveCell:function(){return this._selectionState().originalActiveCell},singleCellSelection:function(){return this._selectionState().singleCellSelection()},unionWithMerged:function(e){var t=this._mergedCells;return e.map(function(e){return e.toRangeRef().union(t)})},trim:function(t){var i=[];var r=this._grid;this._properties.forEachProperty(function(e){i.push(r.trim(t,e.list))});return this.unionWithMerged(t.topLeft.toRangeRef().union(i))},focus:function(e){if(e)this._focus=e.toRangeRef();else{var t=this._focus;this._focus=null;return t}},activeCellSelection:function(){return new g(this._grid.normalize(this.activeCell()),this)},selection:function(){return new g(this._grid.normalize(this._selectionState().selection),this)},selectedHeaders:function(){var e=this.select();var a={};var u={};var h=false;var f=false;var c=this._grid.rowCount-1;var d=this._grid.columnCount-1;e.forEach(function(e){var t;var i="partial";var r="partial";e=e.toRangeRef();var n=e.bottomRight;var s=e.topLeft;var o=s.col<=0&&n.col>=d;var l=s.row<=0&&n.row>=c;if(l){f=true;r="full"}if(o){h=true;i="full"}if(!l)for(t=s.row;t<=n.row;t++)if(a[t]!=="full")a[t]=i;if(!o)for(t=s.col;t<=n.col;t++)if(u[t]!=="full")u[t]=r});return{rows:a,cols:u,allRows:f,allCols:h,all:f&&h}},isInEditMode:function(e){if(e===undefined)return this._inEdit;this._inEdit=e;if(e){this._editSelection.selection=this._viewSelection.selection.clone();this._editSelection.originalSelection=this._viewSelection.originalSelection.clone();this._editSelection._activeCell=this._viewSelection._activeCell.clone();this._editSelection.originalActiveCell=this._viewSelection.originalActiveCell.clone()}},_setFormulaSelections:function(e){this._formulaSelections=(e||[]).slice();this.triggerChange({selection:true})},_viewActiveCell:function(){return this._viewSelection._activeCell.toRangeRef()},toJSON:function(){var n={};var s=this._rows.toJSON("height",n);var e=this._columns.toJSON("width",{});var t=this._viewSelection;var o=[];var i=this._defaultCellStyle||{};function l(t){Object.keys(i).forEach(function(e){if(t[e]===i[e])delete t[e]})}this.forEach(d.spreadsheet.SHEETREF,function(e,t,i){l(i);if(Object.keys(i).length===0)return;if(i.link)o.push({ref:d.spreadsheet.Ref.display(null,e,t),target:i.link});var r=n[e];if(r===undefined){r=s.length;s.push({index:e});n[e]=r}e=s[r];i.index=t;if(e.cells===undefined)e.cells=[];if(i.formula)if(i.formula.arrayFormulaRange)i.formula={src:i.formula.toString(),ref:i.formula.arrayFormulaRange.toString()};else i.formula=i.formula.toString();if(i.validation)i.validation=i.validation.toJSON();if(i.color)i.color=d.parseColor(i.color).toCss();if(i.background)i.background=d.parseColor(i.background).toCss();if(i.borderTop&&i.borderTop.color)i.borderTop.color=d.parseColor(i.borderTop.color).toCss();if(i.borderBottom&&i.borderBottom.color)i.borderBottom.color=d.parseColor(i.borderBottom.color).toCss();if(i.borderRight&&i.borderRight.color)i.borderRight.color=d.parseColor(i.borderRight.color).toCss();if(i.borderLeft&&i.borderLeft.color)i.borderLeft.color=d.parseColor(i.borderLeft.color).toCss();e.cells.push(i)});var r={name:this._name(),rows:s,columns:e,selection:t.selection.toString(),activeCell:t.activeCell().toString(),frozenRows:this.frozenRows(),frozenColumns:this.frozenColumns(),showGridLines:this.showGridLines(),gridLinesColor:this.gridLinesColor(),mergedCells:this._mergedCells.map(function(e){return e.toString()}),hyperlinks:o,defaultCellStyle:i,drawings:this._drawings.map(function(e){return e.toJSON()})};if(this._sort)r.sort={ref:this._sort.ref.toString(),columns:this._sort.columns.map(function(e){return{index:e.index,ascending:e.ascending}})};if(this._filter)r.filter={ref:this._filter.ref.toString(),columns:this._filter.columns.map(function(e){var t=e.filter.toJSON();t.index=e.index;return t})};return r},fromJSON:function(c){this.batch(function(){if(c.name!==undefined)this._name(c.name);if(c.frozenColumns!==undefined)this.frozenColumns(c.frozenColumns);if(c.frozenRows!==undefined)this.frozenRows(c.frozenRows);if(c.columns!==undefined)this._columns.fromJSON("width",c.columns);if(c.rows!==undefined){this._resizeForJSON(c.rows);this._rows.fromJSON("height",c.rows);for(var e=0;e<c.rows.length;e++){var t=c.rows[e];var i=t.index;if(i===undefined)i=e;if(t.cells)for(var r=0;r<t.cells.length;r++){var n=t.cells[r];var s=n.index;if(s===undefined)s=r;if(n.formula){var o=typeof n.formula!="string";var h=o?n.formula.src:n.formula;var l=this._compileFormula(i,s,h);if(o)l.setArrayFormulaRange(d.spreadsheet.calc.parseReference(n.formula.ref));n.formula=l}if(n.validation)n.validation=this._compileValidation(i,s,n.validation);this._properties.fromJSON(this._grid.index(i,s),n)}}}if(c.drawings)this._drawings=c.drawings.map(_.fromJSON);if(c.selection)this._viewSelection.selection=this._viewSelection.originalSelection=this._ref(c.selection);if(c.activeCell){var a=this._ref(c.activeCell);this._viewSelection._activeCell=a.toRangeRef();this._viewSelection.originalActiveCell=a.first()}if(c.mergedCells)c.mergedCells.forEach(function(e){this.range(e).merge()},this);if(c.sort)this._sort={ref:this._ref(c.sort.ref),columns:c.sort.columns.slice(0)};if(c.filter){var u=c.filter.ref;var f=c.filter.columns===undefined?[]:c.filter.columns;if(!u)d.logToConsole("Dropping filter for sheet '"+c.name+"' due to missing ref");else{this._filter={ref:this._ref(u),columns:f.map(function(e){return{index:e.index,filter:d.spreadsheet.Filter.create(e)}})};this._refreshFilter()}}if(c.showGridLines!==undefined)this._showGridLines=c.showGridLines;this._gridLinesColor=c.gridLinesColor});this._rows._refresh();this._columns._refresh()},formula:function(e){return this._properties.get("formula",this._grid.cellRefIndex(e))},validation:function(e){return this._properties.get("validation",this._grid.cellRefIndex(e))},resetFormulas:function(){this._forFormulas(function(e){e.reset()})},resetValidations:function(){this._forValidations(function(e){e.reset()})},recalc:function(e,t){var i=this._properties.get("formula").values();var r=i.length,n=0,s=0;if(!r&&t)return t();function o(){n--;if(s==r&&!n)t()}while(s<r){n++;i[s++].value.exec(e,t?o:null)}},revalidate:function(r){var n=this;this._forValidations(function(e){var t=new c(e.row,e.col);var i=new f(t,t);e.exec(r,n._get(i,"value"),n._get(i,"format"))})},_value:function(e,t,i){var r=this._grid.index(e,t);if(i!==undefined)this._properties.set("value",r,r,i);else return this._properties.get("value",r)},_validation:function(e,t){var i=this._grid.index(e,t);return this._properties.get("validation",i)},_compileValidation:function(e,t,i){if(i instanceof d.spreadsheet.validation.Validation)return i.clone(this._name(),e,t);if(i.from!=null)i.from=(i.from+"").replace(/^=/,"");if(i.to!=null)i.to=(i.to+"").replace(/^=/,"");return d.spreadsheet.validation.compile(this._name(),e,t,i)},_compileFormula:function(e,t,i){i=i.replace(/^=/,"");i=d.spreadsheet.calc.parseFormula(this._name(),e,t,i);return d.spreadsheet.calc.compile(i)},_copyValuesInRange:function(e,t,i,r){var n,s,o;for(n=e.col;n<=t.col;n++){s=this._grid.index(e.row,n);o=this._grid.index(t.row,n);for(var l=s,a=e.row;l<=o;++l,++a){i=i.clone(this._name(),a,n);this._properties.set(r,l,l,i)}}return i},_set:function(e,t,i){var r=this._grid.normalize(e.topLeft);var n=this._grid.normalize(e.bottomRight);var s,o,l;if(typeof i=="number")i=d.spreadsheet.calc.runtime.limitPrecision(i);if(i&&t=="formula"){if(typeof i=="string")i=this._compileFormula(r.row,r.col,i);i=this._copyValuesInRange(r,n,i,"formula")}else if(i&&t=="validation"){i=this._compileValidation(r.row,r.col,i);i=this._copyValuesInRange(r,n,i,"validation")}else for(s=r.col;s<=n.col;s++){o=this._grid.index(r.row,s);l=this._grid.index(n.row,s);this._properties.set(t,o,l,i);if(t=="formula")this._properties.set("value",o,l,null)}},_get:function(e,t){var i=this._grid.normalize(e.topLeft);var r=this._grid.index(i.row,i.col);return this._properties.get(t,r)},batch:function(e,t){var i=this.suspendChanges();this.suspendChanges(true);this._valueChanged=false;e.call(this);if(!t)t={recalc:true};if(this._valueChanged)t.isValue=true;return this.suspendChanges(i).triggerChange(t)},_sortBy:function(t,e){var i=null;e.forEach(function(e){i=this._sorter.sortBy(t,e.index,this._properties.get("value"),e.ascending,i)},this);this._sort={ref:t,columns:e};this._refreshFilter();this.forEach(t,function(e,t,i){var r=i.formula;if(r){var n=e-r.row;if(n!==0){var s=n>0?r.row:r.row+n;r.adjust(this.name(),"row",s,n)}}}.bind(this));this.triggerChange({recalc:true})},_refreshFilter:function(){if(this._filter)this._filterBy(this._filter.ref,this._filter.columns)},_filterBy:function(o,t){this.batch(function(){for(var e=o.topLeft.row;e<=o.bottomRight.row;e++)if(this.isFilteredRow(e)){this._filteredRows.value(e,e,false);this._rows.unhide(e)}t.forEach(function(e){var t=o.resize({top:1}).toColumn(e.index);var r=[];if(t===d.spreadsheet.NULLREF)return;this.forEach(t,function(e,t,i){i.row=e;r.push(i)});e.filter.prepare(r);for(var i=0;i<r.length;i++){var n=r[i];var s=e.filter.value(n);if(e.filter.matches(s)===false)this._filterRow(n.row)}},this);this._filter={ref:o,columns:t}},{recalc:true,layout:true,filter:true})},filterColumn:function(e){var t=this.filter().ref;return e.toRangeRef().topLeft.col-t.topLeft.col},filter:function(){return this._filter},clearFilter:function(e){this._clearFilter(e instanceof Array?e:[e])},_clearFilter:function(t){if(this._filter)this.batch(function(){this._filter.columns=this._filter.columns.filter(function(e){return t.indexOf(e.index)<0});this._refreshFilter()},{recalc:true,layout:true,filter:true})},getAxisState:function(){return{rows:this._rows.getState(),columns:this._columns.getState()}},setAxisState:function(e){this._rows.setState(e.rows);this._columns.setState(e.columns);this.triggerChange({layout:true})},getState:function(){return{rows:this._rows.getState(),columns:this._columns.getState(),mergedCells:this._mergedCells.map(function(e){return e.clone()}),properties:this._properties.getState()}},setState:function(e){this._rows.setState(e.rows);this._columns.setState(e.columns);this._mergedCells=e.mergedCells;this._properties.setState(e.properties);this.triggerChange(d.spreadsheet.ALL_REASONS)},_merge:function(t){var a=this._mergedCells;var u=this;var i;this.batch(function(){i=t.map(function(e){if(e instanceof d.spreadsheet.CellRef)return e;var t=e.toRangeRef().union(a,function(e){a.splice(a.indexOf(e),1)});var i=new g(t,u);var r=i._get("formula");var n=i.value();var s=i.format();var o=i.background();i.value(null);i.format(null);i.background(null);var l=new g(t.collapse(),u);if(r)l._set("formula",r);else l.value(n);l.format(s);l.background(o);a.push(t);return t});var e=u._viewSelection;e.selection=u.unionWithMerged(e.originalSelection);e._activeCell=u.unionWithMerged(e.originalActiveCell)},{activeCell:true,selection:true});return i},_useCultureDecimals:function(){return this._workbook&&this._workbook.options.useCultureDecimals},withCultureDecimals:function(e){var t=".";if(this._useCultureDecimals())t=d.culture().numberFormat["."];return d.spreadsheet.calc.withDecimalSeparator(t,e)},drawingBoundingBox:function(e){var t=e.offsetX;var i=e.offsetY;if(e.topLeftCell){t+=this._columns.sum(0,e.topLeftCell.col-1);i+=this._rows.sum(0,e.topLeftCell.row-1)}return new d.spreadsheet.Rectangle(t,i,e.width,e.height)},refBoundingBox:function(e){return this._grid.rectangle(e.toRangeRef())},addDrawing:function(e,t){if(!(e instanceof _))e=new _(e);this._drawings.push(e);if(t)this._activeDrawing=e;this.triggerChange({layout:true});return e},removeDrawing:function(e){var t=this._drawings.indexOf(e);if(t>=0){this._drawings.splice(t,1);this.triggerChange({layout:true})}},usesImage:function(e){for(var t=this._drawings.length;--t>=0;)if(this._drawings[t].image===e)return true;return false},isMerged:function(e){var t=this._mergedCells;for(var i=t.length;--i>=0;)if(t[i].eq(e))return true;return false}}),_=d.Class.extend({init:function e(t){this.reset(t)},toJSON:function(){return{topLeftCell:this.topLeftCell.toString(),offsetX:this.offsetX,offsetY:this.offsetY,width:this.width,height:this.height,image:this.image,opacity:this.opacity}},clone:function(){return new _(this)},reset:function(e){var t=e.topLeftCell;if(typeof t=="string")t=d.spreadsheet.calc.parseReference(t);this.topLeftCell=t;this.offsetX=e.offsetX||0;this.offsetY=e.offsetY||0;this.width=e.width;this.height=e.height;this.image=e.image;this.opacity=e.opacity!=null?e.opacity:1},eq:function(e){return(!this.topLeftCell&&!e.topLeftCell||this.topLeftCell&&e.topLeftCell&&this.topLeftCell.eq(e.topLeftCell))&&this.offsetX===e.offsetX&&this.offsetY===e.offsetY&&this.width===e.width&&this.height===e.height&&this.image===e.image&&this.opacity===e.opacity}});_.fromJSON=function(e){return new _(e)},d.spreadsheet.Sheet=e,d.spreadsheet.Drawing=_})?r.apply(t,i):r)||(e.exports=t)},97757:function(e){"use strict";e.exports=require("../kendo.color")},54752:function(e){"use strict";e.exports=require("../kendo.core")},81200:function(e){"use strict";e.exports=require("./references")},22360:function(e){"use strict";e.exports=require("./runtime")},26232:function(e){"use strict";e.exports=require("./validation")}},r={};function n(e){var t=r[e];return void 0!==t||(t=r[e]={exports:{}},i[e](t,t.exports,n)),t.exports}n.amdD=function(){throw Error("define cannot be used indirect")},e=n(26929),module.exports=e}();
!function(){var t,e={76575:function(t,i,e){var n;e=[e(14560),e(46043)],void 0===(i="function"==typeof(n=function(){var u=window.kendo.jQuery,p=void 0,s=Math,t=window.kendo,i=t.Class,e=t.template,n=t.dataviz,c=t.deepExtend,f,o=t.geometry.Point,r=n.map.layers.Layer,l=t.util,a=l.renderSize,h=t.drawing.util,d=h.round,m=h.limitValue,v=r.extend({init:function(t,i){r.fn.init.call(this,t,i);if(typeof this.options.subdomains==="string")this.options.subdomains=this.options.subdomains.split("");var e=this._viewType();this._view=new e(this.element,this.options)},destroy:function(){r.fn.destroy.call(this);this._view.destroy();this._view=null},_beforeReset:function(){var t=this.map;var i=t.locationToLayer(t.extent().nw).round();this._view.viewOrigin(i)},_reset:function(t){var i;if(t)i=t.tileTitle;else i="";r.fn._reset.call(this);this._updateView();this._view.reset(i)},_viewType:function(){return _},_activate:function(){r.fn._activate.call(this);if(!t.support.mobileOS){if(!this._pan)this._pan=t.throttle(this._render.bind(this),100);this.map.bind("pan",this._pan)}},_deactivate:function(){r.fn._deactivate.call(this);if(this._pan)this.map.unbind("pan",this._pan)},_updateView:function(){var t=this._view,i=this.map,e=i.extent(),n={nw:i.locationToLayer(e.nw).round(),se:i.locationToLayer(e.se).round()};t.center(i.locationToLayer(i.center()));t.extent(n);t.zoom(i.zoom())},_resize:function(){this._render()},_panEnd:function(t){r.fn._panEnd.call(this,t);this._render()},_render:function(){this._updateView();this._view.render()}}),_=i.extend({init:function(t,i){this.element=t;this._initOptions(i);this.pool=new y},options:{tileSize:256,subdomains:["a","b","c"],urlTemplate:""},center:function(t){this._center=t},extent:function(t){this._extent=t},viewOrigin:function(t){this._viewOrigin=t},zoom:function(t){this._zoom=t},pointToTileIndex:function(t){return new o(s.floor(t.x/this.options.tileSize),s.floor(t.y/this.options.tileSize))},tileCount:function(){var t=this.size(),i=this.pointToTileIndex(this._extent.nw),e=this._extent.nw,n=this.indexToPoint(i).translate(-e.x,-e.y);return{x:s.ceil((s.abs(n.x)+t.width)/this.options.tileSize),y:s.ceil((s.abs(n.y)+t.height)/this.options.tileSize)}},size:function(){var t=this._extent.nw,i=this._extent.se,e=i.clone().translate(-t.x,-t.y);return{width:e.x,height:e.y}},indexToPoint:function(t){var i=t.x,e=t.y;return new o(i*this.options.tileSize,e*this.options.tileSize)},subdomainText:function(){var t=this.options.subdomains;return t[this.subdomainIndex++%t.length]},destroy:function(){this.element.empty();this.pool.empty()},reset:function(t){this._tileTitle=t;this.pool.reset();this.subdomainIndex=0;this.render()},render:function(){var t=this.tileCount(),i=this.pointToTileIndex(this._extent.nw),e,n,s;for(n=0;n<t.x;n++)for(s=0;s<t.y;s++){e=this.createTile({x:i.x+n,y:i.y+s});if(!e.visible)e.show()}},createTile:function(t){var i=this.tileOptions(t);var e=this.pool.get(this._center,i);if(e.element.parent().length===0)this.element.append(e.element);return e},tileOptions:function(t){var i=this.wrapIndex(t),e=this.indexToPoint(t),n=this._viewOrigin,s=e.clone().translate(-n.x,-n.y);return{index:i,currentIndex:t,point:e,offset:w(s),zoom:this._zoom,size:this.options.tileSize,subdomain:this.subdomainText(),urlTemplate:this.options.urlTemplate,errorUrlTemplate:this.options.errorUrlTemplate,tileTitle:this._tileTitle}},wrapIndex:function(t){var i=s.pow(2,this._zoom);return{x:this.wrapValue(t.x,i),y:m(t.y,0,i-1)}},wrapValue:function(t,i){var e=s.abs(t)%i;if(t>=0)t=e;else t=i-(e===0?i:e);return t}}),x=i.extend({init:function(t,i){this.id=t;this.visible=true;this._initOptions(i);this.createElement();this.show()},options:{urlTemplate:"",errorUrlTemplate:""},createElement:function(){this.element=u("<img style='position: absolute; display: block;' alt='"+this.options.tileTitle+"' />").css({width:this.options.size,height:this.options.size}).on("error",function(t){if(this.errorUrl())t.target.setAttribute("src",this.errorUrl());else t.target.removeAttribute("src")}.bind(this))},show:function(){var t=this.element[0];t.style.top=a(this.options.offset.y);t.style.left=a(this.options.offset.x);var i=this.url();if(i)t.setAttribute("src",i);t.style.visibility="visible";this.visible=true},hide:function(){this.element[0].style.visibility="hidden";this.visible=false},url:function(){var t=e(this.options.urlTemplate);return t(this.urlOptions())},errorUrl:function(){var t=e(this.options.errorUrlTemplate);return t(this.urlOptions())},urlOptions:function(){var t=this.options;return{zoom:t.zoom,subdomain:t.subdomain,z:t.zoom,x:t.index.x,y:t.index.y,s:t.subdomain,quadkey:t.quadkey,q:t.quadkey,culture:t.culture,c:t.culture}},destroy:function(){if(this.element){this.element.remove();this.element=null}}}),y=i.extend({init:function(){this._items=[]},options:{maxSize:100},get:function(t,i){if(this._items.length>=this.options.maxSize)this._remove(t);return this._create(i)},empty:function(){var t=this._items;for(var i=0;i<t.length;i++)t[i].destroy();this._items=[]},reset:function(){var t=this._items;for(var i=0;i<t.length;i++)t[i].hide()},_create:function(t){var i=this._items;var e;var n=l.hashKey(t.point.toString()+t.offset.toString()+t.zoom+t.urlTemplate);for(var s=0;s<i.length;s++)if(i[s].id===n){e=i[s];break}if(e)e.show();else{e=new x(n,t);this._items.push(e)}return e},_remove:function(t){var i=this._items;var e=-1;var n=-1;for(var s=0;s<i.length;s++){var o=i[s].options.point.distanceTo(t);if(o>e&&!i[s].visible){n=s;e=o}}if(n!==-1){i[n].destroy();i.splice(n,1)}}});function w(t){return new o(d(t.x),d(t.y))}c(n,{map:{layers:{tile:v,TileLayer:v,ImageTile:x,TilePool:y,TileView:_}}})})?n.apply(i,e):n)||(t.exports=i)},46043:function(t){"use strict";t.exports=require("../location")},14560:function(t){"use strict";t.exports=require("./base")}},n={};function s(t){var i=n[t];return void 0!==i||(i=n[t]={exports:{}},e[t](i,i.exports,s)),i.exports}s.amdD=function(){throw Error("define cannot be used indirect")},t=s(76575),module.exports=t}();